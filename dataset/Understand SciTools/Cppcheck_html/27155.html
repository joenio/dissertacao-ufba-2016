<html><head><title>checkbufferoverrun.cpp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link rel="stylesheet" type="text/css" href="sourcestyles.css" />
</head><body link="blue" vlink="blue">
<h3>File: /home/joenio/src/dissertacao-ufba-2016/dataset/NIST/cppcheck/cppcheck-1.72/lib/checkbufferoverrun.cpp</h3>
<SCRIPT>
defaultStatus = "File: /home/joenio/src/dissertacao-ufba-2016/dataset/NIST/cppcheck/cppcheck-1.72/lib/checkbufferoverrun.cpp";
top.document.title  = "checkbufferoverrun.cpp";
</SCRIPT>
<pre><span class="default"></span><a name="1"><font size=-1>1     </font></a><span class="default"></span><span class="comment">/*</span>
<a name="2"><font size=-1>2     </font></a><span class="comment"> * Cppcheck - A tool for static C/C++ code analysis</span>
<a name="3"><font size=-1>3     </font></a><span class="comment"> * Copyright (C) 2007-2016 Cppcheck team.</span>
<a name="4"><font size=-1>4     </font></a><span class="comment"> *</span>
<a name="5"><font size=-1>5     </font></a><span class="comment"> * This program is free software: you can redistribute it and/or modify</span>
<a name="6"><font size=-1>6     </font></a><span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="7"><font size=-1>7     </font></a><span class="comment"> * the Free Software Foundation, either version 3 of the License, or</span>
<a name="8"><font size=-1>8     </font></a><span class="comment"> * (at your option) any later version.</span>
<a name="9"><font size=-1>9     </font></a><span class="comment"> *</span>
<a name="10"><font size=-1>10     </font></a><span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="11"><font size=-1>11     </font></a><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="12"><font size=-1>12     </font></a><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="13"><font size=-1>13     </font></a><span class="comment"> * GNU General Public License for more details.</span>
<a name="14"><font size=-1>14     </font></a><span class="comment"> *</span>
<a name="15"><font size=-1>15     </font></a><span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="16"><font size=-1>16     </font></a><span class="comment"> * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="17"><font size=-1>17     </font></a><span class="comment"> */</span>
<a name="18"><font size=-1>18     </font></a><span class="comment"></span>
<a name="19"><font size=-1>19     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="20"><font size=-1>20     </font></a><span class="comment">// Buffer overrun..</span>
<a name="21"><font size=-1>21     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="22"><font size=-1>22     </font></a><span class="comment"></span>
<a name="23"><font size=-1>23     </font></a><span class="comment"></span><span class="preproc">#include </span><span class="string">&quot;checkbufferoverrun.h&quot;</span>
<a name="24"><font size=-1>24     </font></a><span class="string"></span>
<a name="25"><font size=-1>25     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&quot;tokenize.h&quot;</span>
<a name="26"><font size=-1>26     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&quot;mathlib.h&quot;</span>
<a name="27"><font size=-1>27     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&quot;symboldatabase.h&quot;</span>
<a name="28"><font size=-1>28     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&quot;astutils.h&quot;</span>
<a name="29"><font size=-1>29     </font></a><span class="string"></span>
<a name="30"><font size=-1>30     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;algorithm&gt;</span>
<a name="31"><font size=-1>31     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;sstream&gt;</span>
<a name="32"><font size=-1>32     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;list&gt;</span>
<a name="33"><font size=-1>33     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;cassert&gt;     </span><span class="comment">// &lt;- assert</span>
<a name="34"><font size=-1>34     </font></a><span class="comment"></span><span class="preproc">#include </span><span class="string">&lt;cstdlib&gt;</span>
<a name="35"><font size=-1>35     </font></a><span class="string"></span><span class="preproc">#include </span><span class="string">&lt;stack&gt;</span>
<a name="36"><font size=-1>36     </font></a><span class="string"></span>
<a name="37"><font size=-1>37     </font></a><span class="string"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="38"><font size=-1>38     </font></a><span class="comment"></span>
<a name="39"><font size=-1>39     </font></a><span class="comment">// Register this check class (by creating a static instance of it)</span>
<a name="40"><font size=-1>40     </font></a><span class="comment"></span><span class="keyword">namespace </span><span class="default">{</span>
<a name="41"><font size=-1>41     </font></a><span class="default">    <a href="dictionary_C.html#1776">CheckBufferOverrun</a> <a href="dictionary_I.html#27156">instance</a>;</span>
<a name="42"><font size=-1>42     </font></a><span class="default">}</span>
<a name="43"><font size=-1>43     </font></a><span class="default"></span>
<a name="44"><font size=-1>44     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="45"><font size=-1>45     </font></a><span class="comment"></span>
<a name="46"><font size=-1>46     </font></a><span class="comment"></span><span class="keyword">static void <a href="dictionary_M.html#27157">makeArrayIndexOutOfBoundsError</a></span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#101">ostream</a>&amp; <a href="dictionary_O.html#27158">oss</a>, </span><span class="keyword">const <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1795">ArrayInfo</a> &amp;<a href="dictionary_A.html#27159">arrayInfo</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;MathLib::bigint&gt; &amp;<a href="dictionary_I.html#27160">index</a>)</span>
<a name="47"><font size=-1>47     </font></a><span class="default">{</span>
<a name="48"><font size=-1>48     </font></a><span class="default">    <a href="dictionary_O.html#27158">oss</a> &lt;&lt; </span><span class="string">&quot;Array '&quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27159">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>();</span>
<a name="49"><font size=-1>49     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27161">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27161">i</a> &lt; <a href="dictionary_A.html#27159">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27161">i</a>)</span>
<a name="50"><font size=-1>50     </font></a><span class="default">        <a href="dictionary_O.html#27158">oss</a> &lt;&lt; </span><span class="string">&quot;[&quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27159">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_I.html#27161">i</a>) &lt;&lt; </span><span class="string">&quot;]&quot;</span><span class="default">;</span>
<a name="51"><font size=-1>51     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27160">index</a>.<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1</span><span class="default">)</span>
<a name="52"><font size=-1>52     </font></a><span class="default">        <a href="dictionary_O.html#27158">oss</a> &lt;&lt; </span><span class="string">&quot;' accessed at index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27160">index</a>[</span><span class="number">0</span><span class="default">] &lt;&lt; </span><span class="string">&quot;, which is&quot;</span><span class="default">;</span>
<a name="53"><font size=-1>53     </font></a><span class="default">    </span><span class="keyword">else </span><span class="default">{</span>
<a name="54"><font size=-1>54     </font></a><span class="default">        <a href="dictionary_O.html#27158">oss</a> &lt;&lt; </span><span class="string">&quot;' index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27159">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>();</span>
<a name="55"><font size=-1>55     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27162">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27162">i</a> &lt; <a href="dictionary_I.html#27160">index</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27162">i</a>)</span>
<a name="56"><font size=-1>56     </font></a><span class="default">            <a href="dictionary_O.html#27158">oss</a> &lt;&lt; </span><span class="string">&quot;[&quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27160">index</a>[<a href="dictionary_I.html#27162">i</a>] &lt;&lt; </span><span class="string">&quot;]&quot;</span><span class="default">;</span>
<a name="57"><font size=-1>57     </font></a><span class="default">    }</span>
<a name="58"><font size=-1>58     </font></a><span class="default">    <a href="dictionary_O.html#27158">oss</a> &lt;&lt; </span><span class="string">&quot; out of bounds.&quot;</span><span class="default">;</span>
<a name="59"><font size=-1>59     </font></a><span class="default">}</span>
<a name="60"><font size=-1>60     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#18357">arrayIndexOutOfBoundsError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27163">tok</a>, </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> </span><span class="default">&amp;<a href="dictionary_A.html#27164">arrayInfo</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;MathLib::bigint&gt; &amp;<a href="dictionary_I.html#27165">index</a>)</span>
<a name="61"><font size=-1>61     </font></a><span class="default">{</span>
<a name="62"><font size=-1>62     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#142">ostringstream</a> <a href="dictionary_O.html#1991">oss</a>;</span>
<a name="63"><font size=-1>63     </font></a><span class="default">    <a href="dictionary_M.html#27157">makeArrayIndexOutOfBoundsError</a>(<a href="dictionary_O.html#1991">oss</a>, <a href="dictionary_A.html#27164">arrayInfo</a>, <a href="dictionary_I.html#27165">index</a>);</span>
<a name="64"><font size=-1>64     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27163">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;arrayIndexOutOfBounds&quot;</span><span class="default">, <a href="dictionary_O.html#1991">oss</a>.<a href="dictionary_S.html#148">str</a>());</span>
<a name="65"><font size=-1>65     </font></a><span class="default">}</span>
<a name="66"><font size=-1>66     </font></a><span class="default"></span>
<a name="67"><font size=-1>67     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#21049">arrayIndexOutOfBoundsError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27167">tok</a>, </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> </span><span class="default">&amp;<a href="dictionary_A.html#27168">arrayInfo</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;ValueFlow::Value&gt; &amp;<a href="dictionary_I.html#27169">index</a>)</span>
<a name="68"><font size=-1>68     </font></a><span class="default">{</span>
<a name="69"><font size=-1>69     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_C.html#27170">condition</a> = <a href="dictionary_N.html#1132">nullptr</a>;</span>
<a name="70"><font size=-1>70     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27171">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27171">i</a> &lt; <a href="dictionary_I.html#27169">index</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27171">i</a>) {</span>
<a name="71"><font size=-1>71     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27170">condition</a> == <a href="dictionary_N.html#1132">nullptr</a>)</span>
<a name="72"><font size=-1>72     </font></a><span class="default">            <a href="dictionary_C.html#27170">condition</a> = <a href="dictionary_I.html#27169">index</a>[<a href="dictionary_I.html#27171">i</a>].<a href="dictionary_C.html#17916">condition</a>;</span>
<a name="73"><font size=-1>73     </font></a><span class="default">    }</span>
<a name="74"><font size=-1>74     </font></a><span class="default"></span>
<a name="75"><font size=-1>75     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27170">condition</a> != <a href="dictionary_N.html#1132">nullptr</a>) {</span>
<a name="76"><font size=-1>76     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1876">isEnabled</a>(</span><span class="string">&quot;warning&quot;</span><span class="default">))</span>
<a name="77"><font size=-1>77     </font></a><span class="default">            </span><span class="keyword">return</span><span class="default">;</span>
<a name="78"><font size=-1>78     </font></a><span class="default"></span>
<a name="79"><font size=-1>79     </font></a><span class="default">        <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#142">ostringstream</a> <a href="dictionary_E.html#1916">errmsg</a>;</span>
<a name="80"><font size=-1>80     </font></a><span class="default">        <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; ValueFlow::<a href="dictionary_V.html#5830">eitherTheConditionIsRedundant</a>(<a href="dictionary_C.html#27170">condition</a>) &lt;&lt; </span><span class="string">&quot; or the array '&quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27168">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>();</span>
<a name="81"><font size=-1>81     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27172">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27172">i</a> &lt; <a href="dictionary_A.html#27168">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27172">i</a>)</span>
<a name="82"><font size=-1>82     </font></a><span class="default">            <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;[&quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27168">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_I.html#27172">i</a>) &lt;&lt; </span><span class="string">&quot;]&quot;</span><span class="default">;</span>
<a name="83"><font size=-1>83     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27169">index</a>.<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1</span><span class="default">)</span>
<a name="84"><font size=-1>84     </font></a><span class="default">            <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;' is accessed at index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27169">index</a>[</span><span class="number">0</span><span class="default">].<a href="dictionary_I.html#6658">intvalue</a> &lt;&lt; </span><span class="string">&quot;, which is out of bounds.&quot;</span><span class="default">;</span>
<a name="85"><font size=-1>85     </font></a><span class="default">        </span><span class="keyword">else </span><span class="default">{</span>
<a name="86"><font size=-1>86     </font></a><span class="default">            <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;' index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27168">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>();</span>
<a name="87"><font size=-1>87     </font></a><span class="default">            </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27173">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27173">i</a> &lt; <a href="dictionary_I.html#27169">index</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27173">i</a>)</span>
<a name="88"><font size=-1>88     </font></a><span class="default">                <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;[&quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27169">index</a>[<a href="dictionary_I.html#27173">i</a>].<a href="dictionary_I.html#6658">intvalue</a> &lt;&lt; </span><span class="string">&quot;]&quot;</span><span class="default">;</span>
<a name="89"><font size=-1>89     </font></a><span class="default">            <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot; is out of bounds.&quot;</span><span class="default">;</span>
<a name="90"><font size=-1>90     </font></a><span class="default">        }</span>
<a name="91"><font size=-1>91     </font></a><span class="default"></span>
<a name="92"><font size=-1>92     </font></a><span class="default">        <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; <a href="dictionary_C.html#27174">callstack</a>;</span>
<a name="93"><font size=-1>93     </font></a><span class="default">        <a href="dictionary_C.html#27174">callstack</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_T.html#27167">tok</a>);</span>
<a name="94"><font size=-1>94     </font></a><span class="default">        <a href="dictionary_C.html#27174">callstack</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_C.html#27170">condition</a>);</span>
<a name="95"><font size=-1>95     </font></a><span class="default">        <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_C.html#27174">callstack</a>, <a href="dictionary_S.html#1381">Severity</a>::warning, </span><span class="string">&quot;arrayIndexOutOfBoundsCond&quot;</span><span class="default">, <a href="dictionary_E.html#1916">errmsg</a>.<a href="dictionary_S.html#148">str</a>(), </span><span class="number">0U</span><span class="default">, </span><span class="keyword">false</span><span class="default">);</span>
<a name="96"><font size=-1>96     </font></a><span class="default">    } </span><span class="keyword">else </span><span class="default">{</span>
<a name="97"><font size=-1>97     </font></a><span class="default">        <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#142">ostringstream</a> <a href="dictionary_E.html#1916">errmsg</a>;</span>
<a name="98"><font size=-1>98     </font></a><span class="default">        <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;Array '&quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27168">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>();</span>
<a name="99"><font size=-1>99     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27175">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27175">i</a> &lt; <a href="dictionary_A.html#27168">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27175">i</a>)</span>
<a name="100"><font size=-1>100     </font></a><span class="default">            <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;[&quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27168">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_I.html#27175">i</a>) &lt;&lt; </span><span class="string">&quot;]&quot;</span><span class="default">;</span>
<a name="101"><font size=-1>101     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27169">index</a>.<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1</span><span class="default">)</span>
<a name="102"><font size=-1>102     </font></a><span class="default">            <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;' accessed at index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27169">index</a>[</span><span class="number">0</span><span class="default">].<a href="dictionary_I.html#6658">intvalue</a> &lt;&lt; </span><span class="string">&quot;, which is out of bounds.&quot;</span><span class="default">;</span>
<a name="103"><font size=-1>103     </font></a><span class="default">        </span><span class="keyword">else </span><span class="default">{</span>
<a name="104"><font size=-1>104     </font></a><span class="default">            <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;' index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27168">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>();</span>
<a name="105"><font size=-1>105     </font></a><span class="default">            </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27176">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27176">i</a> &lt; <a href="dictionary_I.html#27169">index</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27176">i</a>)</span>
<a name="106"><font size=-1>106     </font></a><span class="default">                <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot;[&quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27169">index</a>[<a href="dictionary_I.html#27176">i</a>].<a href="dictionary_I.html#6658">intvalue</a> &lt;&lt; </span><span class="string">&quot;]&quot;</span><span class="default">;</span>
<a name="107"><font size=-1>107     </font></a><span class="default">            <a href="dictionary_E.html#1916">errmsg</a> &lt;&lt; </span><span class="string">&quot; out of bounds.&quot;</span><span class="default">;</span>
<a name="108"><font size=-1>108     </font></a><span class="default">        }</span>
<a name="109"><font size=-1>109     </font></a><span class="default"></span>
<a name="110"><font size=-1>110     </font></a><span class="default">        <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27167">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;arrayIndexOutOfBounds&quot;</span><span class="default">, <a href="dictionary_E.html#1916">errmsg</a>.<a href="dictionary_S.html#148">str</a>());</span>
<a name="111"><font size=-1>111     </font></a><span class="default">    }</span>
<a name="112"><font size=-1>112     </font></a><span class="default">}</span>
<a name="113"><font size=-1>113     </font></a><span class="default"></span>
<a name="114"><font size=-1>114     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1837">arrayIndexOutOfBoundsError</a>(</span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; &amp;<a href="dictionary_C.html#27177">callstack</a>, </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> </span><span class="default">&amp;<a href="dictionary_A.html#27178">arrayInfo</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;MathLib::bigint&gt; &amp;<a href="dictionary_I.html#27179">index</a>)</span>
<a name="115"><font size=-1>115     </font></a><span class="default">{</span>
<a name="116"><font size=-1>116     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#142">ostringstream</a> <a href="dictionary_O.html#1991">oss</a>;</span>
<a name="117"><font size=-1>117     </font></a><span class="default">    <a href="dictionary_M.html#27157">makeArrayIndexOutOfBoundsError</a>(<a href="dictionary_O.html#1991">oss</a>, <a href="dictionary_A.html#27178">arrayInfo</a>, <a href="dictionary_I.html#27179">index</a>);</span>
<a name="118"><font size=-1>118     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_C.html#27177">callstack</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;arrayIndexOutOfBounds&quot;</span><span class="default">, <a href="dictionary_O.html#1991">oss</a>.<a href="dictionary_S.html#148">str</a>(), </span><span class="number">0U</span><span class="default">, </span><span class="keyword">false</span><span class="default">);</span>
<a name="119"><font size=-1>119     </font></a><span class="default">}</span>
<a name="120"><font size=-1>120     </font></a><span class="default"></span>
<a name="121"><font size=-1>121     </font></a><span class="default"></span><span class="keyword">static <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> <a href="dictionary_B.html#27180">bufferOverrunMessage</a>(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#44">string</a> <a href="dictionary_V.html#27181">varnames</a>)</span>
<a name="122"><font size=-1>122     </font></a><span class="default">{</span>
<a name="123"><font size=-1>123     </font></a><span class="default">    <a href="dictionary_V.html#27181">varnames</a>.<a href="dictionary_S.html#76">erase</a>(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#2006">remove</a>(<a href="dictionary_V.html#27181">varnames</a>.<a href="dictionary_S.html#135">begin</a>(), <a href="dictionary_V.html#27181">varnames</a>.<a href="dictionary_S.html#136">end</a>(), </span><span class="string">' '</span><span class="default">), <a href="dictionary_V.html#27181">varnames</a>.<a href="dictionary_S.html#136">end</a>());</span>
<a name="124"><font size=-1>124     </font></a><span class="default"></span>
<a name="125"><font size=-1>125     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#44">string</a> <a href="dictionary_E.html#27182">errmsg</a>(</span><span class="string">&quot;Buffer is accessed out of bounds&quot;</span><span class="default">);</span>
<a name="126"><font size=-1>126     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_V.html#27181">varnames</a>.<a href="dictionary_S.html#288">empty</a>())</span>
<a name="127"><font size=-1>127     </font></a><span class="default">        <a href="dictionary_E.html#27182">errmsg</a> += </span><span class="string">&quot;: &quot; </span><span class="default">+ <a href="dictionary_V.html#27181">varnames</a>;</span>
<a name="128"><font size=-1>128     </font></a><span class="default">    </span><span class="keyword">else</span>
<a name="129"><font size=-1>129     </font></a><span class="keyword">        <a href="dictionary_E.html#27182">errmsg</a> </span><span class="default">+= </span><span class="string">&quot;.&quot;</span><span class="default">;</span>
<a name="130"><font size=-1>130     </font></a><span class="default"></span>
<a name="131"><font size=-1>131     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_E.html#27182">errmsg</a></span><span class="default">;</span>
<a name="132"><font size=-1>132     </font></a><span class="default">}</span>
<a name="133"><font size=-1>133     </font></a><span class="default"></span>
<a name="134"><font size=-1>134     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1838">bufferOverrunError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27183">tok</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_V.html#27184">varnames</a>)</span>
<a name="135"><font size=-1>135     </font></a><span class="default">{</span>
<a name="136"><font size=-1>136     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27183">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;bufferAccessOutOfBounds&quot;</span><span class="default">, <a href="dictionary_B.html#27180">bufferOverrunMessage</a>(<a href="dictionary_V.html#27184">varnames</a>));</span>
<a name="137"><font size=-1>137     </font></a><span class="default">}</span>
<a name="138"><font size=-1>138     </font></a><span class="default"></span>
<a name="139"><font size=-1>139     </font></a><span class="default"></span>
<a name="140"><font size=-1>140     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1839">bufferOverrunError</a>(</span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; &amp;<a href="dictionary_C.html#27185">callstack</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_V.html#27186">varnames</a>)</span>
<a name="141"><font size=-1>141     </font></a><span class="default">{</span>
<a name="142"><font size=-1>142     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_C.html#27185">callstack</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;bufferAccessOutOfBounds&quot;</span><span class="default">, <a href="dictionary_B.html#27180">bufferOverrunMessage</a>(<a href="dictionary_V.html#27186">varnames</a>), </span><span class="number">0U</span><span class="default">, </span><span class="keyword">false</span><span class="default">);</span>
<a name="143"><font size=-1>143     </font></a><span class="default">}</span>
<a name="144"><font size=-1>144     </font></a><span class="default"></span>
<a name="145"><font size=-1>145     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1854">possibleBufferOverrunError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27187">tok</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_S.html#27188">src</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_D.html#27189">dst</a>, </span><span class="keyword">bool <a href="dictionary_C.html#27190">cat</a></span><span class="default">)</span>
<a name="146"><font size=-1>146     </font></a><span class="default">{</span>
<a name="147"><font size=-1>147     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27190">cat</a>)</span>
<a name="148"><font size=-1>148     </font></a><span class="default">        <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27187">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::warning, </span><span class="string">&quot;possibleBufferAccessOutOfBounds&quot;</span><span class="default">,</span>
<a name="149"><font size=-1>149     </font></a><span class="default">                    </span><span class="string">&quot;Possible buffer overflow if strlen(&quot; </span><span class="default">+ <a href="dictionary_S.html#27188">src</a> + </span><span class="string">&quot;) is larger than sizeof(&quot; </span><span class="default">+ <a href="dictionary_D.html#27189">dst</a> + </span><span class="string">&quot;)-strlen(&quot; </span><span class="default">+ <a href="dictionary_D.html#27189">dst</a> +</span><span class="string">&quot;).\n&quot;</span>
<a name="150"><font size=-1>150     </font></a><span class="string">                    &quot;Possible buffer overflow if strlen(&quot; </span><span class="default">+ <a href="dictionary_S.html#27188">src</a> + </span><span class="string">&quot;) is larger than sizeof(&quot; </span><span class="default">+ <a href="dictionary_D.html#27189">dst</a> + </span><span class="string">&quot;)-strlen(&quot; </span><span class="default">+ <a href="dictionary_D.html#27189">dst</a> +</span><span class="string">&quot;). &quot;</span>
<a name="151"><font size=-1>151     </font></a><span class="string">                    &quot;The source buffer is larger than the destination buffer so there is the potential for overflowing the destination buffer.&quot;</span><span class="default">);</span>
<a name="152"><font size=-1>152     </font></a><span class="default">    </span><span class="keyword">else</span>
<a name="153"><font size=-1>153     </font></a><span class="keyword">        <a href="dictionary_C.html#1865">reportError</a></span><span class="default">(<a href="dictionary_T.html#27187">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::warning, </span><span class="string">&quot;possibleBufferAccessOutOfBounds&quot;</span><span class="default">,</span>
<a name="154"><font size=-1>154     </font></a><span class="default">                    </span><span class="string">&quot;Possible buffer overflow if strlen(&quot; </span><span class="default">+ <a href="dictionary_S.html#27188">src</a> + </span><span class="string">&quot;) is larger than or equal to sizeof(&quot; </span><span class="default">+ <a href="dictionary_D.html#27189">dst</a> + </span><span class="string">&quot;).\n&quot;</span>
<a name="155"><font size=-1>155     </font></a><span class="string">                    &quot;Possible buffer overflow if strlen(&quot; </span><span class="default">+ <a href="dictionary_S.html#27188">src</a> + </span><span class="string">&quot;) is larger than or equal to sizeof(&quot; </span><span class="default">+ <a href="dictionary_D.html#27189">dst</a> + </span><span class="string">&quot;). &quot;</span>
<a name="156"><font size=-1>156     </font></a><span class="string">                    &quot;The source buffer is larger than the destination buffer so there is the potential for overflowing the destination buffer.&quot;</span><span class="default">);</span>
<a name="157"><font size=-1>157     </font></a><span class="default">}</span>
<a name="158"><font size=-1>158     </font></a><span class="default"></span>
<a name="159"><font size=-1>159     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1840">strncatUsageError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27191">tok</a>)</span>
<a name="160"><font size=-1>160     </font></a><span class="default">{</span>
<a name="161"><font size=-1>161     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#1875">_settings</a> &amp;&amp; !<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1876">isEnabled</a>(</span><span class="string">&quot;warning&quot;</span><span class="default">))</span>
<a name="162"><font size=-1>162     </font></a><span class="default">        </span><span class="keyword">return</span><span class="default">;</span>
<a name="163"><font size=-1>163     </font></a><span class="default"></span>
<a name="164"><font size=-1>164     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27191">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::warning, </span><span class="string">&quot;strncatUsage&quot;</span><span class="default">,</span>
<a name="165"><font size=-1>165     </font></a><span class="default">                </span><span class="string">&quot;Dangerous usage of strncat - 3rd parameter is the maximum number of characters to append.\n&quot;</span>
<a name="166"><font size=-1>166     </font></a><span class="string">                &quot;At most, strncat appends the 3rd parameter's amount of characters and adds a terminating null byte.\n&quot;</span>
<a name="167"><font size=-1>167     </font></a><span class="string">                &quot;The safe way to use strncat is to subtract one from the remaining space in the buffer and use it as 3rd parameter.&quot;</span>
<a name="168"><font size=-1>168     </font></a><span class="string">                &quot;Source: http://www.cplusplus.com/reference/cstring/strncat/\n&quot;</span>
<a name="169"><font size=-1>169     </font></a><span class="string">                &quot;Source: http://www.opensource.apple.com/source/Libc/Libc-167/gen.subproj/i386.subproj/strncat.c&quot;</span><span class="default">);</span>
<a name="170"><font size=-1>170     </font></a><span class="default">}</span>
<a name="171"><font size=-1>171     </font></a><span class="default"></span>
<a name="172"><font size=-1>172     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1843">outOfBoundsError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27192">tok</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_W.html#27193">what</a>, </span><span class="keyword">const bool <a href="dictionary_S.html#27194">show_size_info</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> &amp;<a href="dictionary_S.html#27195">supplied_size</a>, </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> &amp;<a href="dictionary_A.html#27196">actual_size</a>)</span>
<a name="173"><font size=-1>173     </font></a><span class="default">{</span>
<a name="174"><font size=-1>174     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#142">ostringstream</a> <a href="dictionary_O.html#1991">oss</a>;</span>
<a name="175"><font size=-1>175     </font></a><span class="default"></span>
<a name="176"><font size=-1>176     </font></a><span class="default">    <a href="dictionary_O.html#1991">oss</a> &lt;&lt; <a href="dictionary_W.html#27193">what</a> &lt;&lt; </span><span class="string">&quot; is out of bounds&quot;</span><span class="default">;</span>
<a name="177"><font size=-1>177     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27194">show_size_info</a>)</span>
<a name="178"><font size=-1>178     </font></a><span class="default">        <a href="dictionary_O.html#1991">oss</a> &lt;&lt; </span><span class="string">&quot;: Supplied size &quot; </span><span class="default">&lt;&lt; <a href="dictionary_S.html#27195">supplied_size</a> &lt;&lt; </span><span class="string">&quot; is larger than actual size &quot; </span><span class="default">&lt;&lt; <a href="dictionary_A.html#27196">actual_size</a>;</span>
<a name="179"><font size=-1>179     </font></a><span class="default">    <a href="dictionary_O.html#1991">oss</a> &lt;&lt; </span><span class="string">'.'</span><span class="default">;</span>
<a name="180"><font size=-1>180     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27192">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;outOfBounds&quot;</span><span class="default">, <a href="dictionary_O.html#1991">oss</a>.<a href="dictionary_S.html#148">str</a>());</span>
<a name="181"><font size=-1>181     </font></a><span class="default">}</span>
<a name="182"><font size=-1>182     </font></a><span class="default"></span>
<a name="183"><font size=-1>183     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1852">pointerOutOfBoundsError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27197">tok</a>, </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_I.html#27198">index</a>, </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_I.html#27199">indexvalue</a>)</span>
<a name="184"><font size=-1>184     </font></a><span class="default">{</span>
<a name="185"><font size=-1>185     </font></a><span class="default">    </span><span class="comment">// The severity is portability instead of error since this ub doesnt</span>
<a name="186"><font size=-1>186     </font></a><span class="comment">    // cause bad behaviour on most implementations. people create out</span>
<a name="187"><font size=-1>187     </font></a><span class="comment">    // of bounds pointers by intention.</span>
<a name="188"><font size=-1>188     </font></a><span class="comment">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> <a href="dictionary_E.html#27200">expr</a>(<a href="dictionary_T.html#27197">tok</a> ? <a href="dictionary_T.html#27197">tok</a>-&gt;<a href="dictionary_T.html#2907">expressionString</a>() : <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#147">string</a>(</span><span class="string">&quot;&quot;</span><span class="default">));</span>
<a name="189"><font size=-1>189     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#44">string</a> <a href="dictionary_E.html#27201">errmsg</a>;</span>
<a name="190"><font size=-1>190     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27198">index</a> &amp;&amp; !<a href="dictionary_I.html#27198">index</a>-&gt;<a href="dictionary_T.html#1420">isNumber</a>()) {</span>
<a name="191"><font size=-1>191     </font></a><span class="default">        <a href="dictionary_E.html#27201">errmsg</a> = </span><span class="string">&quot;Undefined behaviour, when '&quot; </span><span class="default">+</span>
<a name="192"><font size=-1>192     </font></a><span class="default">                 <a href="dictionary_I.html#27198">index</a>-&gt;<a href="dictionary_T.html#2907">expressionString</a>() +</span>
<a name="193"><font size=-1>193     </font></a><span class="default">                 </span><span class="string">&quot;' is &quot; </span><span class="default">+</span>
<a name="194"><font size=-1>194     </font></a><span class="default">                 <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#409">toString</a>(<a href="dictionary_I.html#27199">indexvalue</a>) +</span>
<a name="195"><font size=-1>195     </font></a><span class="default">                 </span><span class="string">&quot; the pointer arithmetic '&quot; </span><span class="default">+ <a href="dictionary_E.html#27200">expr</a> + </span><span class="string">&quot;' is out of bounds&quot;</span><span class="default">;</span>
<a name="196"><font size=-1>196     </font></a><span class="default">    } </span><span class="keyword">else </span><span class="default">{</span>
<a name="197"><font size=-1>197     </font></a><span class="default">        <a href="dictionary_E.html#27201">errmsg</a> = </span><span class="string">&quot;Undefined behaviour, pointer arithmetic '&quot; </span><span class="default">+ <a href="dictionary_E.html#27200">expr</a> + </span><span class="string">&quot;' is out of bounds&quot;</span><span class="default">;</span>
<a name="198"><font size=-1>198     </font></a><span class="default">    }</span>
<a name="199"><font size=-1>199     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#44">string</a> <a href="dictionary_V.html#27202">verbosemsg</a>(<a href="dictionary_E.html#27201">errmsg</a> + </span><span class="string">&quot;. From chapter 6.5.6 in the C specification:\n&quot;</span>
<a name="200"><font size=-1>200     </font></a><span class="string">                           &quot;\&quot;When an expression that has integer type is added to or subtracted from a pointer, ..\&quot; and then \&quot;If both the pointer operand and the result point to elements of the same array object, or one past the last element of the array object, the evaluation shall not produce an overflow; otherwise, the behavior is undefined.\&quot;&quot;</span><span class="default">);</span>
<a name="201"><font size=-1>201     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27197">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::portability, </span><span class="string">&quot;pointerOutOfBounds&quot;</span><span class="default">, <a href="dictionary_E.html#27201">errmsg</a> + </span><span class="string">&quot;.\n&quot; </span><span class="default">+ <a href="dictionary_V.html#27202">verbosemsg</a>);</span>
<a name="202"><font size=-1>202     </font></a><span class="default">    </span><span class="comment">/*</span>
<a name="203"><font size=-1>203     </font></a><span class="comment">         &quot;Undefined behaviour: The result of this pointer arithmetic does not point into</span>
<a name="204"><font size=-1>204     </font></a><span class="comment">         or just one element past the end of the &quot; + object + &quot;.</span>
<a name="205"><font size=-1>205     </font></a><span class="comment">         Further information:</span>
<a name="206"><font size=-1>206     </font></a><span class="comment">          https://www.securecoding.cert.org/confluence/display/seccode/ARR30-C.+Do+not+form+or+use+out+of+bounds+pointers+or+array+subscripts&quot;);</span>
<a name="207"><font size=-1>207     </font></a><span class="comment">    */</span>
<a name="208"><font size=-1>208     </font></a><span class="comment"></span><span class="default">}</span>
<a name="209"><font size=-1>209     </font></a><span class="default"></span>
<a name="210"><font size=-1>210     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1844">sizeArgumentAsCharError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27203">tok</a>)</span>
<a name="211"><font size=-1>211     </font></a><span class="default">{</span>
<a name="212"><font size=-1>212     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#1875">_settings</a> &amp;&amp; !<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1876">isEnabled</a>(</span><span class="string">&quot;warning&quot;</span><span class="default">))</span>
<a name="213"><font size=-1>213     </font></a><span class="default">        </span><span class="keyword">return</span><span class="default">;</span>
<a name="214"><font size=-1>214     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27203">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::warning, </span><span class="string">&quot;sizeArgumentAsChar&quot;</span><span class="default">, </span><span class="string">&quot;The size argument is given as a char constant.&quot;</span><span class="default">);</span>
<a name="215"><font size=-1>215     </font></a><span class="default">}</span>
<a name="216"><font size=-1>216     </font></a><span class="default"></span>
<a name="217"><font size=-1>217     </font></a><span class="default"></span>
<a name="218"><font size=-1>218     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1845">terminateStrncpyError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27204">tok</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_V.html#27205">varname</a>)</span>
<a name="219"><font size=-1>219     </font></a><span class="default">{</span>
<a name="220"><font size=-1>220     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27204">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::warning, </span><span class="string">&quot;terminateStrncpy&quot;</span><span class="default">,</span>
<a name="221"><font size=-1>221     </font></a><span class="default">                </span><span class="string">&quot;The buffer '&quot; </span><span class="default">+ <a href="dictionary_V.html#27205">varname</a> + </span><span class="string">&quot;' may not be null-terminated after the call to strncpy().\n&quot;</span>
<a name="222"><font size=-1>222     </font></a><span class="string">                &quot;If the source string's size fits or exceeds the given size, strncpy() does not add a &quot;</span>
<a name="223"><font size=-1>223     </font></a><span class="string">                &quot;zero at the end of the buffer. This causes bugs later in the code if the code &quot;</span>
<a name="224"><font size=-1>224     </font></a><span class="string">                &quot;assumes buffer is null-terminated.&quot;</span><span class="default">, </span><span class="number">0U</span><span class="default">, </span><span class="keyword">true</span><span class="default">);</span>
<a name="225"><font size=-1>225     </font></a><span class="default">}</span>
<a name="226"><font size=-1>226     </font></a><span class="default"></span>
<a name="227"><font size=-1>227     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1851">cmdLineArgsError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27206">tok</a>)</span>
<a name="228"><font size=-1>228     </font></a><span class="default">{</span>
<a name="229"><font size=-1>229     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27206">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;insecureCmdLineArgs&quot;</span><span class="default">, </span><span class="string">&quot;Buffer overrun possible for long command line arguments.&quot;</span><span class="default">);</span>
<a name="230"><font size=-1>230     </font></a><span class="default">}</span>
<a name="231"><font size=-1>231     </font></a><span class="default"></span>
<a name="232"><font size=-1>232     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1846">bufferNotZeroTerminatedError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27207">tok</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_V.html#27208">varname</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_F.html#27209">function</a>)</span>
<a name="233"><font size=-1>233     </font></a><span class="default">{</span>
<a name="234"><font size=-1>234     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> <a href="dictionary_E.html#27210">errmsg</a> = </span><span class="string">&quot;The buffer '&quot; </span><span class="default">+ <a href="dictionary_V.html#27208">varname</a> + </span><span class="string">&quot;' is not null-terminated after the call to &quot; </span><span class="default">+ <a href="dictionary_F.html#27209">function</a> + </span><span class="string">&quot;().\n&quot;</span>
<a name="235"><font size=-1>235     </font></a><span class="string">                               &quot;The buffer '&quot; </span><span class="default">+ <a href="dictionary_V.html#27208">varname</a> + </span><span class="string">&quot;' is not null-terminated after the call to &quot; </span><span class="default">+ <a href="dictionary_F.html#27209">function</a> + </span><span class="string">&quot;(). &quot;</span>
<a name="236"><font size=-1>236     </font></a><span class="string">                               &quot;This will cause bugs later in the code if the code assumes the buffer is null-terminated.&quot;</span><span class="default">;</span>
<a name="237"><font size=-1>237     </font></a><span class="default"></span>
<a name="238"><font size=-1>238     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27207">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::warning, </span><span class="string">&quot;bufferNotZeroTerminated&quot;</span><span class="default">, <a href="dictionary_E.html#27210">errmsg</a>, </span><span class="number">0U</span><span class="default">, </span><span class="keyword">true</span><span class="default">);</span>
<a name="239"><font size=-1>239     </font></a><span class="default">}</span>
<a name="240"><font size=-1>240     </font></a><span class="default"></span>
<a name="241"><font size=-1>241     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1855">argumentSizeError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27211">tok</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_F.html#27212">functionName</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_V.html#27213">varname</a>)</span>
<a name="242"><font size=-1>242     </font></a><span class="default">{</span>
<a name="243"><font size=-1>243     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27211">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::warning, </span><span class="string">&quot;argumentSize&quot;</span><span class="default">, </span><span class="string">&quot;The array '&quot; </span><span class="default">+ <a href="dictionary_V.html#27213">varname</a> + </span><span class="string">&quot;' is too small, the function '&quot; </span><span class="default">+ <a href="dictionary_F.html#27212">functionName</a> + </span><span class="string">&quot;' expects a bigger one.&quot;</span><span class="default">);</span>
<a name="244"><font size=-1>244     </font></a><span class="default">}</span>
<a name="245"><font size=-1>245     </font></a><span class="default"></span>
<a name="246"><font size=-1>246     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1841">negativeMemoryAllocationSizeError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27214">tok</a>)</span>
<a name="247"><font size=-1>247     </font></a><span class="default">{</span>
<a name="248"><font size=-1>248     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27214">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;negativeMemoryAllocationSize&quot;</span><span class="default">,</span>
<a name="249"><font size=-1>249     </font></a><span class="default">                </span><span class="string">&quot;Memory allocation size is negative.\n&quot;</span>
<a name="250"><font size=-1>250     </font></a><span class="string">                &quot;Memory allocation size is negative.&quot;</span>
<a name="251"><font size=-1>251     </font></a><span class="string">                &quot;Negative allocation size has no specified behaviour.&quot;</span><span class="default">);</span>
<a name="252"><font size=-1>252     </font></a><span class="default">}</span>
<a name="253"><font size=-1>253     </font></a><span class="default"></span>
<a name="254"><font size=-1>254     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="255"><font size=-1>255     </font></a><span class="comment"></span>
<a name="256"><font size=-1>256     </font></a><span class="comment"></span>
<a name="257"><font size=-1>257     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="258"><font size=-1>258     </font></a><span class="comment">// Check array usage..</span>
<a name="259"><font size=-1>259     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="260"><font size=-1>260     </font></a><span class="comment"></span>
<a name="261"><font size=-1>261     </font></a><span class="comment"></span>
<a name="262"><font size=-1>262     </font></a><span class="comment"></span><span class="keyword">static bool <a href="dictionary_I.html#27215">isAddressOf</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27216">tok</a>)</span>
<a name="263"><font size=-1>263     </font></a><span class="default">{</span>
<a name="264"><font size=-1>264     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27217">tok2</a> = <a href="dictionary_T.html#27216">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>();</span>
<a name="265"><font size=-1>265     </font></a><span class="default">    </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27217">tok2</a>, </span><span class="string">&quot;%name%|.|::|[&quot;</span><span class="default">))</span>
<a name="266"><font size=-1>266     </font></a><span class="default">        <a href="dictionary_T.html#27217">tok2</a> = <a href="dictionary_T.html#27217">tok2</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>();</span>
<a name="267"><font size=-1>267     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_T.html#27217">tok2</a> </span><span class="default">&amp;&amp; <a href="dictionary_T.html#27217">tok2</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;&amp;&quot; </span><span class="default">&amp;&amp; !(<a href="dictionary_T.html#27217">tok2</a>-&gt;<a href="dictionary_T.html#1428">astOperand1</a>() &amp;&amp; <a href="dictionary_T.html#27217">tok2</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>());</span>
<a name="268"><font size=-1>268     </font></a><span class="default">}</span>
<a name="269"><font size=-1>269     </font></a><span class="default"></span>
<a name="270"><font size=-1>270     </font></a><span class="default"></span><span class="comment">/**</span>
<a name="271"><font size=-1>271     </font></a><span class="comment"> * bailout if variable is used inside if/else/switch block or if there is &quot;break&quot;</span>
<a name="272"><font size=-1>272     </font></a><span class="comment"> * @param tok token for &quot;if&quot; or &quot;switch&quot;</span>
<a name="273"><font size=-1>273     </font></a><span class="comment"> * @param varid variable id</span>
<a name="274"><font size=-1>274     </font></a><span class="comment"> * @return is bailout recommended?</span>
<a name="275"><font size=-1>275     </font></a><span class="comment"> */</span>
<a name="276"><font size=-1>276     </font></a><span class="comment"></span><span class="keyword">static bool <a href="dictionary_B.html#27218">bailoutIfSwitch</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27219">tok</a>, </span><span class="keyword">const unsigned int <a href="dictionary_V.html#27220">varid</a></span><span class="default">)</span>
<a name="277"><font size=-1>277     </font></a><span class="default">{</span>
<a name="278"><font size=-1>278     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* <a href="dictionary_E.html#27221">end</a> = <a href="dictionary_T.html#27219">tok</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">)-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">);</span>
<a name="279"><font size=-1>279     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_E.html#27221">end</a>, </span><span class="string">&quot;} else {&quot;</span><span class="default">)) </span><span class="comment">// scan the else-block</span>
<a name="280"><font size=-1>280     </font></a><span class="comment">        <a href="dictionary_E.html#27221">end</a> </span><span class="default">= <a href="dictionary_E.html#27221">end</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="281"><font size=-1>281     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_E.html#27221">end</a>, </span><span class="string">&quot;{&quot;</span><span class="default">)) </span><span class="comment">// Ticket #5203: Invalid code, bailout</span>
<a name="282"><font size=-1>282     </font></a><span class="comment">        </span><span class="keyword">return true</span><span class="default">;</span>
<a name="283"><font size=-1>283     </font></a><span class="default"></span>
<a name="284"><font size=-1>284     </font></a><span class="default">    </span><span class="comment">// Used later to check if the body belongs to a &quot;if&quot;</span>
<a name="285"><font size=-1>285     </font></a><span class="comment">    </span><span class="keyword">const bool <a href="dictionary_I.html#27222">is_if</a> </span><span class="default">= <a href="dictionary_T.html#27219">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;if&quot;</span><span class="default">;</span>
<a name="286"><font size=-1>286     </font></a><span class="default"></span>
<a name="287"><font size=-1>287     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(; <a href="dictionary_T.html#27219">tok</a> &amp;&amp; <a href="dictionary_T.html#27219">tok</a> != <a href="dictionary_E.html#27221">end</a>; <a href="dictionary_T.html#27219">tok</a> = <a href="dictionary_T.html#27219">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="288"><font size=-1>288     </font></a><span class="default">        </span><span class="comment">// If scanning a &quot;if&quot; block then bailout for &quot;break&quot;</span>
<a name="289"><font size=-1>289     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27222">is_if</a> &amp;&amp; (<a href="dictionary_T.html#27219">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;break&quot; </span><span class="default">|| <a href="dictionary_T.html#27219">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;continue&quot;</span><span class="default">))</span>
<a name="290"><font size=-1>290     </font></a><span class="default">            </span><span class="keyword">return true</span><span class="default">;</span>
<a name="291"><font size=-1>291     </font></a><span class="default"></span>
<a name="292"><font size=-1>292     </font></a><span class="default">        </span><span class="comment">// bailout for &quot;return&quot;</span>
<a name="293"><font size=-1>293     </font></a><span class="comment">        </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#27219">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;return&quot;</span><span class="default">)</span>
<a name="294"><font size=-1>294     </font></a><span class="default">            </span><span class="keyword">return true</span><span class="default">;</span>
<a name="295"><font size=-1>295     </font></a><span class="default"></span>
<a name="296"><font size=-1>296     </font></a><span class="default">        </span><span class="comment">// bailout if varid is found</span>
<a name="297"><font size=-1>297     </font></a><span class="comment">        </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#27219">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>() == <a href="dictionary_V.html#27220">varid</a>)</span>
<a name="298"><font size=-1>298     </font></a><span class="default">            </span><span class="keyword">return true</span><span class="default">;</span>
<a name="299"><font size=-1>299     </font></a><span class="default">    }</span>
<a name="300"><font size=-1>300     </font></a><span class="default"></span>
<a name="301"><font size=-1>301     </font></a><span class="default">    </span><span class="comment">// No bailout stuff found =&gt; return false</span>
<a name="302"><font size=-1>302     </font></a><span class="comment">    </span><span class="keyword">return false</span><span class="default">;</span>
<a name="303"><font size=-1>303     </font></a><span class="default">}</span>
<a name="304"><font size=-1>304     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="305"><font size=-1>305     </font></a><span class="comment"></span>
<a name="306"><font size=-1>306     </font></a><span class="comment"></span><span class="keyword">static bool <a href="dictionary_C.html#27223">checkMinSizes</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;Library::ArgumentChecks::MinSize&gt; &amp;<a href="dictionary_M.html#27224">minsizes</a>, </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_F.html#27225">ftok</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_A.html#27226">arraySize</a>, </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">**<a href="dictionary_C.html#27227">charSizeToken</a>, </span><span class="keyword">const <a href="dictionary_S.html#506">Settings</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27228">settings</a></span><span class="default">)</span>
<a name="307"><font size=-1>307     </font></a><span class="default">{</span>
<a name="308"><font size=-1>308     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27227">charSizeToken</a>)</span>
<a name="309"><font size=-1>309     </font></a><span class="default">        *<a href="dictionary_C.html#27227">charSizeToken</a> = <a href="dictionary_N.html#1132">nullptr</a>;</span>
<a name="310"><font size=-1>310     </font></a><span class="default"></span>
<a name="311"><font size=-1>311     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_M.html#27224">minsizes</a>.<a href="dictionary_S.html#4616">empty</a>())</span>
<a name="312"><font size=-1>312     </font></a><span class="default">        </span><span class="keyword">return false</span><span class="default">;</span>
<a name="313"><font size=-1>313     </font></a><span class="default"></span>
<a name="314"><font size=-1>314     </font></a><span class="default">    </span><span class="comment">// All conditions must be true</span>
<a name="315"><font size=-1>315     </font></a><span class="comment">    </span><span class="keyword">bool <a href="dictionary_E.html#27229">error</a> </span><span class="default">= </span><span class="keyword">true</span><span class="default">;</span>
<a name="316"><font size=-1>316     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;Library::ArgumentChecks::MinSize&gt;::<a href="dictionary_S.html#4610">const_iterator</a> <a href="dictionary_M.html#27230">minsize</a> = <a href="dictionary_M.html#27224">minsizes</a>.<a href="dictionary_S.html#3264">begin</a>(); <a href="dictionary_M.html#27230">minsize</a> != <a href="dictionary_M.html#27224">minsizes</a>.<a href="dictionary_S.html#3265">end</a>(); ++<a href="dictionary_M.html#27230">minsize</a>) {</span>
<a name="317"><font size=-1>317     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_E.html#27229">error</a>)</span>
<a name="318"><font size=-1>318     </font></a><span class="default">            </span><span class="keyword">return false</span><span class="default">;</span>
<a name="319"><font size=-1>319     </font></a><span class="default">        <a href="dictionary_E.html#27229">error</a> = </span><span class="keyword">false</span><span class="default">;</span>
<a name="320"><font size=-1>320     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_A.html#27231">argtok</a> = <a href="dictionary_F.html#27225">ftok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="321"><font size=-1>321     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_A.html#27232">argnum</a> </span><span class="default">= </span><span class="number">1</span><span class="default">; <a href="dictionary_A.html#27231">argtok</a> &amp;&amp; <a href="dictionary_A.html#27232">argnum</a> &lt; <a href="dictionary_M.html#27230">minsize</a>-&gt;<a href="dictionary_A.html#702">arg</a>; <a href="dictionary_A.html#27232">argnum</a>++)</span>
<a name="322"><font size=-1>322     </font></a><span class="default">            <a href="dictionary_A.html#27231">argtok</a> = <a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#1911">nextArgument</a>();</span>
<a name="323"><font size=-1>323     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_A.html#27231">argtok</a>)</span>
<a name="324"><font size=-1>324     </font></a><span class="default">            </span><span class="keyword">return false</span><span class="default">;</span>
<a name="325"><font size=-1>325     </font></a><span class="default">        </span><span class="keyword">switch </span><span class="default">(<a href="dictionary_M.html#27230">minsize</a>-&gt;<a href="dictionary_T.html#692">type</a>) {</span>
<a name="326"><font size=-1>326     </font></a><span class="default">        </span><span class="keyword">case <a href="dictionary_L.html#620">Library</a></span><span class="default">::<a href="dictionary_L.html#1353">ArgumentChecks</a>::<a href="dictionary_L.html#1354">MinSize</a>::ARGVALUE:</span>
<a name="327"><font size=-1>327     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_A.html#27231">argtok</a>, </span><span class="string">&quot;%num% ,|)&quot;</span><span class="default">)) {</span>
<a name="328"><font size=-1>328     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_S.html#27233">sz</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="329"><font size=-1>329     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27233">sz</a> &gt; <a href="dictionary_A.html#27226">arraySize</a>)</span>
<a name="330"><font size=-1>330     </font></a><span class="default">                    <a href="dictionary_E.html#27229">error</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="331"><font size=-1>331     </font></a><span class="default">            } </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#2894">tokType</a>() == <a href="dictionary_T.html#524">Token</a>::eChar &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), </span><span class="string">&quot;,|)&quot;</span><span class="default">) &amp;&amp; <a href="dictionary_C.html#27227">charSizeToken</a>)</span>
<a name="332"><font size=-1>332     </font></a><span class="default">                *<a href="dictionary_C.html#27227">charSizeToken</a> = <a href="dictionary_A.html#27231">argtok</a>; </span><span class="comment">//sizeArgumentAsCharError(argtok);</span>
<a name="333"><font size=-1>333     </font></a><span class="comment">            </span><span class="keyword">break</span><span class="default">;</span>
<a name="334"><font size=-1>334     </font></a><span class="default">        </span><span class="keyword">case <a href="dictionary_L.html#620">Library</a></span><span class="default">::<a href="dictionary_L.html#1353">ArgumentChecks</a>::<a href="dictionary_L.html#1354">MinSize</a>::MUL:</span>
<a name="335"><font size=-1>335     </font></a><span class="default">            </span><span class="comment">// TODO: handle arbitrary arg2</span>
<a name="336"><font size=-1>336     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_M.html#27230">minsize</a>-&gt;<a href="dictionary_A.html#704">arg2</a> == <a href="dictionary_M.html#27230">minsize</a>-&gt;<a href="dictionary_A.html#702">arg</a>+</span><span class="number">1 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_A.html#27231">argtok</a>, </span><span class="string">&quot;%num% , %num% ,|)&quot;</span><span class="default">)) {</span>
<a name="337"><font size=-1>337     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_S.html#27234">sz</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#1416">str</a>()) * <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">2</span><span class="default">));</span>
<a name="338"><font size=-1>338     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27234">sz</a> &gt; <a href="dictionary_A.html#27226">arraySize</a>)</span>
<a name="339"><font size=-1>339     </font></a><span class="default">                    <a href="dictionary_E.html#27229">error</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="340"><font size=-1>340     </font></a><span class="default">            }</span>
<a name="341"><font size=-1>341     </font></a><span class="default">            </span><span class="keyword">break</span><span class="default">;</span>
<a name="342"><font size=-1>342     </font></a><span class="default">        </span><span class="keyword">case <a href="dictionary_L.html#620">Library</a></span><span class="default">::<a href="dictionary_L.html#1353">ArgumentChecks</a>::<a href="dictionary_L.html#1354">MinSize</a>::STRLEN: {</span>
<a name="343"><font size=-1>343     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27228">settings</a>-&gt;<a href="dictionary_S.html#1024">library</a>.<a href="dictionary_L.html#17648">isargformatstr</a>(<a href="dictionary_F.html#27225">ftok</a>,<a href="dictionary_M.html#27230">minsize</a>-&gt;<a href="dictionary_A.html#702">arg</a>)) {</span>
<a name="344"><font size=-1>344     </font></a><span class="default">                <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; <a href="dictionary_P.html#27235">parameters</a>;</span>
<a name="345"><font size=-1>345     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_F.html#27236">formatstr</a>(<a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="346"><font size=-1>346     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_A.html#27237">argtok2</a> = <a href="dictionary_A.html#27231">argtok</a>;</span>
<a name="347"><font size=-1>347     </font></a><span class="default">                </span><span class="keyword">while </span><span class="default">((<a href="dictionary_A.html#27237">argtok2</a> = <a href="dictionary_A.html#27237">argtok2</a>-&gt;<a href="dictionary_T.html#1911">nextArgument</a>()) != <a href="dictionary_N.html#1132">nullptr</a>) {</span>
<a name="348"><font size=-1>348     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_A.html#27237">argtok2</a>, </span><span class="string">&quot;%num%|%str% [,)]&quot;</span><span class="default">))</span>
<a name="349"><font size=-1>349     </font></a><span class="default">                        <a href="dictionary_P.html#27235">parameters</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_A.html#27237">argtok2</a>);</span>
<a name="350"><font size=-1>350     </font></a><span class="default">                    </span><span class="keyword">else</span>
<a name="351"><font size=-1>351     </font></a><span class="keyword">                        <a href="dictionary_P.html#27235">parameters</a></span><span class="default">.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_N.html#1132">nullptr</a>);</span>
<a name="352"><font size=-1>352     </font></a><span class="default">                }</span>
<a name="353"><font size=-1>353     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#257">biguint</a> <a href="dictionary_L.html#27238">len</a> = <a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1789">countSprintfLength</a>(<a href="dictionary_F.html#27236">formatstr</a>, <a href="dictionary_P.html#27235">parameters</a>);</span>
<a name="354"><font size=-1>354     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_L.html#27238">len</a> &gt; <a href="dictionary_A.html#27226">arraySize</a> + </span><span class="number">2U</span><span class="default">)</span>
<a name="355"><font size=-1>355     </font></a><span class="default">                    <a href="dictionary_E.html#27229">error</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="356"><font size=-1>356     </font></a><span class="default">            } </span><span class="keyword">else </span><span class="default">{</span>
<a name="357"><font size=-1>357     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_S.html#27239">strtoken</a> = <a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#23816">getValueTokenMaxStrLength</a>();</span>
<a name="358"><font size=-1>358     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27239">strtoken</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#2940">getStrLength</a>(<a href="dictionary_S.html#27239">strtoken</a>) &gt;= <a href="dictionary_A.html#27226">arraySize</a>)</span>
<a name="359"><font size=-1>359     </font></a><span class="default">                    <a href="dictionary_E.html#27229">error</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="360"><font size=-1>360     </font></a><span class="default">            }</span>
<a name="361"><font size=-1>361     </font></a><span class="default">        }</span>
<a name="362"><font size=-1>362     </font></a><span class="default">        </span><span class="keyword">break</span><span class="default">;</span>
<a name="363"><font size=-1>363     </font></a><span class="default">        </span><span class="keyword">case <a href="dictionary_L.html#620">Library</a></span><span class="default">::<a href="dictionary_L.html#1353">ArgumentChecks</a>::<a href="dictionary_L.html#1354">MinSize</a>::SIZEOF:</span>
<a name="364"><font size=-1>364     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27231">argtok</a>-&gt;<a href="dictionary_T.html#2894">tokType</a>() == <a href="dictionary_T.html#524">Token</a>::eString &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#2940">getStrLength</a>(<a href="dictionary_A.html#27231">argtok</a>) &gt;= <a href="dictionary_A.html#27226">arraySize</a>)</span>
<a name="365"><font size=-1>365     </font></a><span class="default">                <a href="dictionary_E.html#27229">error</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="366"><font size=-1>366     </font></a><span class="default">            </span><span class="keyword">break</span><span class="default">;</span>
<a name="367"><font size=-1>367     </font></a><span class="default">        </span><span class="keyword">case <a href="dictionary_L.html#620">Library</a></span><span class="default">::<a href="dictionary_L.html#1353">ArgumentChecks</a>::<a href="dictionary_L.html#1354">MinSize</a>::NONE:</span>
<a name="368"><font size=-1>368     </font></a><span class="default">            </span><span class="keyword">return false</span><span class="default">;</span>
<a name="369"><font size=-1>369     </font></a><span class="default">        };</span>
<a name="370"><font size=-1>370     </font></a><span class="default">    }</span>
<a name="371"><font size=-1>371     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_E.html#27229">error</a></span><span class="default">;</span>
<a name="372"><font size=-1>372     </font></a><span class="default">}</span>
<a name="373"><font size=-1>373     </font></a><span class="default"></span>
<a name="374"><font size=-1>374     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1821">checkFunctionParameter</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">&amp;<a href="dictionary_F.html#27240">ftok</a>, </span><span class="keyword">unsigned int <a href="dictionary_P.html#27241">par</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> </span><span class="default">&amp;<a href="dictionary_A.html#27242">arrayInfo</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt;&amp; <a href="dictionary_C.html#27243">callstack</a>)</span>
<a name="375"><font size=-1>375     </font></a><span class="default">{</span>
<a name="376"><font size=-1>376     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;Library::ArgumentChecks::MinSize&gt; * </span><span class="keyword">const <a href="dictionary_M.html#27244">minsizes</a> </span><span class="default">= <a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1024">library</a>.<a href="dictionary_L.html#6084">argminsizes</a>(&amp;<a href="dictionary_F.html#27240">ftok</a>,<a href="dictionary_P.html#27241">par</a>);</span>
<a name="377"><font size=-1>377     </font></a><span class="default"></span>
<a name="378"><font size=-1>378     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_M.html#27244">minsizes</a> &amp;&amp; (!(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_F.html#27240">ftok</a>.<a href="dictionary_T.html#1421">previous</a>(), </span><span class="string">&quot;.&quot;</span><span class="default">) || <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_F.html#27240">ftok</a>.<a href="dictionary_T.html#1437">tokAt</a>(-</span><span class="number">2</span><span class="default">), </span><span class="string">&quot;!!std ::&quot;</span><span class="default">)))) {</span>
<a name="379"><font size=-1>379     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1810">element_size</a>() == </span><span class="number">0</span><span class="default">)</span>
<a name="380"><font size=-1>380     </font></a><span class="default">            </span><span class="keyword">return</span><span class="default">;</span>
<a name="381"><font size=-1>381     </font></a><span class="default"></span>
<a name="382"><font size=-1>382     </font></a><span class="default">        <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_A.html#27245">arraySize</a> = <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1810">element_size</a>();</span>
<a name="383"><font size=-1>383     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27246">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27246">i</a> &lt; <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27246">i</a>)</span>
<a name="384"><font size=-1>384     </font></a><span class="default">            <a href="dictionary_A.html#27245">arraySize</a> *= <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_I.html#27246">i</a>);</span>
<a name="385"><font size=-1>385     </font></a><span class="default"></span>
<a name="386"><font size=-1>386     </font></a><span class="default">        </span><span class="comment">// dimension is 0 or unknown =&gt; bailout</span>
<a name="387"><font size=-1>387     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27245">arraySize</a> == </span><span class="number">0</span><span class="default">)</span>
<a name="388"><font size=-1>388     </font></a><span class="default">            </span><span class="keyword">return</span><span class="default">;</span>
<a name="389"><font size=-1>389     </font></a><span class="default"></span>
<a name="390"><font size=-1>390     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_C.html#27247">charSizeToken</a> = <a href="dictionary_N.html#1132">nullptr</a>;</span>
<a name="391"><font size=-1>391     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27223">checkMinSizes</a>(*<a href="dictionary_M.html#27244">minsizes</a>, &amp;<a href="dictionary_F.html#27240">ftok</a>, <a href="dictionary_A.html#27245">arraySize</a>, &amp;<a href="dictionary_C.html#27247">charSizeToken</a>, <a href="dictionary_C.html#1875">_settings</a>))</span>
<a name="392"><font size=-1>392     </font></a><span class="default">            <a href="dictionary_C.html#1838">bufferOverrunError</a>(<a href="dictionary_C.html#27243">callstack</a>, <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>());</span>
<a name="393"><font size=-1>393     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27247">charSizeToken</a>)</span>
<a name="394"><font size=-1>394     </font></a><span class="default">            <a href="dictionary_C.html#1844">sizeArgumentAsCharError</a>(<a href="dictionary_C.html#27247">charSizeToken</a>);</span>
<a name="395"><font size=-1>395     </font></a><span class="default">    }</span>
<a name="396"><font size=-1>396     </font></a><span class="default"></span>
<a name="397"><font size=-1>397     </font></a><span class="default">    </span><span class="comment">// Calling a user function?</span>
<a name="398"><font size=-1>398     </font></a><span class="comment">    // only 1-dimensional arrays can be checked currently</span>
<a name="399"><font size=-1>399     </font></a><span class="comment">    </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1</span><span class="default">) {</span>
<a name="400"><font size=-1>400     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_F.html#536">Function</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_F.html#27248">func</a> </span><span class="default">= <a href="dictionary_F.html#27240">ftok</a>.<a href="dictionary_T.html#1485">function</a>();</span>
<a name="401"><font size=-1>401     </font></a><span class="default"></span>
<a name="402"><font size=-1>402     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_F.html#27248">func</a> &amp;&amp; <a href="dictionary_F.html#27248">func</a>-&gt;<a href="dictionary_F.html#7763">hasBody</a>()) {</span>
<a name="403"><font size=-1>403     </font></a><span class="default">            </span><span class="comment">// Get corresponding parameter..</span>
<a name="404"><font size=-1>404     </font></a><span class="comment">            </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_P.html#27249">parameter</a> </span><span class="default">= <a href="dictionary_F.html#27248">func</a>-&gt;<a href="dictionary_F.html#8229">getArgumentVar</a>(<a href="dictionary_P.html#27241">par</a>-</span><span class="number">1</span><span class="default">);</span>
<a name="405"><font size=-1>405     </font></a><span class="default"></span>
<a name="406"><font size=-1>406     </font></a><span class="default">            </span><span class="comment">// Ensure that it has a compatible size..</span>
<a name="407"><font size=-1>407     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_P.html#27249">parameter</a> || <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#8527">sizeOfType</a>(<a href="dictionary_P.html#27249">parameter</a>-&gt;<a href="dictionary_V.html#2918">typeStartToken</a>()) != <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1810">element_size</a>())</span>
<a name="408"><font size=-1>408     </font></a><span class="default">                </span><span class="keyword">return</span><span class="default">;</span>
<a name="409"><font size=-1>409     </font></a><span class="default"></span>
<a name="410"><font size=-1>410     </font></a><span class="default">            </span><span class="comment">// No variable id occur for instance when:</span>
<a name="411"><font size=-1>411     </font></a><span class="comment">            // - Variable function arguments: &quot;void f(...)&quot;</span>
<a name="412"><font size=-1>412     </font></a><span class="comment">            // - Unnamed parameter: &quot;void f(char *)&quot;</span>
<a name="413"><font size=-1>413     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27249">parameter</a>-&gt;<a href="dictionary_V.html#4822">declarationId</a>() == </span><span class="number">0</span><span class="default">)</span>
<a name="414"><font size=-1>414     </font></a><span class="default">                </span><span class="keyword">return</span><span class="default">;</span>
<a name="415"><font size=-1>415     </font></a><span class="default"></span>
<a name="416"><font size=-1>416     </font></a><span class="default">            </span><span class="comment">// Check the parameter usage in the function scope..</span>
<a name="417"><font size=-1>417     </font></a><span class="comment">            </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* <a href="dictionary_F.html#27250">ftok2</a> = <a href="dictionary_F.html#27248">func</a>-&gt;<a href="dictionary_F.html#7774">functionScope</a>-&gt;<a href="dictionary_S.html#1889">classStart</a>; <a href="dictionary_F.html#27250">ftok2</a> != <a href="dictionary_F.html#27248">func</a>-&gt;<a href="dictionary_F.html#7774">functionScope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>; <a href="dictionary_F.html#27250">ftok2</a> = <a href="dictionary_F.html#27250">ftok2</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="418"><font size=-1>418     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_F.html#27250">ftok2</a>, </span><span class="string">&quot;if|for|switch|while (&quot;</span><span class="default">)) {</span>
<a name="419"><font size=-1>419     </font></a><span class="default">                    </span><span class="comment">// bailout if there is buffer usage..</span>
<a name="420"><font size=-1>420     </font></a><span class="comment">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_B.html#27218">bailoutIfSwitch</a>(<a href="dictionary_F.html#27250">ftok2</a>, <a href="dictionary_P.html#27249">parameter</a>-&gt;<a href="dictionary_V.html#4822">declarationId</a>())) {</span>
<a name="421"><font size=-1>421     </font></a><span class="default">                        </span><span class="keyword">break</span><span class="default">;</span>
<a name="422"><font size=-1>422     </font></a><span class="default">                    }</span>
<a name="423"><font size=-1>423     </font></a><span class="default"></span>
<a name="424"><font size=-1>424     </font></a><span class="default">                    </span><span class="comment">// no bailout is needed. skip the if-block</span>
<a name="425"><font size=-1>425     </font></a><span class="comment">                    </span><span class="keyword">else </span><span class="default">{</span>
<a name="426"><font size=-1>426     </font></a><span class="default">                        </span><span class="comment">// goto end of if block..</span>
<a name="427"><font size=-1>427     </font></a><span class="comment">                        <a href="dictionary_F.html#27250">ftok2</a> </span><span class="default">= <a href="dictionary_F.html#27250">ftok2</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">)-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">);</span>
<a name="428"><font size=-1>428     </font></a><span class="default">                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_F.html#27250">ftok2</a>, </span><span class="string">&quot;} else {&quot;</span><span class="default">))</span>
<a name="429"><font size=-1>429     </font></a><span class="default">                            <a href="dictionary_F.html#27250">ftok2</a> = <a href="dictionary_F.html#27250">ftok2</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="430"><font size=-1>430     </font></a><span class="default">                        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_F.html#27250">ftok2</a>)</span>
<a name="431"><font size=-1>431     </font></a><span class="default">                            </span><span class="keyword">break</span><span class="default">;</span>
<a name="432"><font size=-1>432     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="433"><font size=-1>433     </font></a><span class="default">                    }</span>
<a name="434"><font size=-1>434     </font></a><span class="default">                }</span>
<a name="435"><font size=-1>435     </font></a><span class="default"></span>
<a name="436"><font size=-1>436     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_F.html#27250">ftok2</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;}&quot;</span><span class="default">)</span>
<a name="437"><font size=-1>437     </font></a><span class="default">                    </span><span class="keyword">break</span><span class="default">;</span>
<a name="438"><font size=-1>438     </font></a><span class="default"></span>
<a name="439"><font size=-1>439     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_F.html#27250">ftok2</a>-&gt;<a href="dictionary_T.html#1481">varId</a>() == <a href="dictionary_P.html#27249">parameter</a>-&gt;<a href="dictionary_V.html#4822">declarationId</a>()) {</span>
<a name="440"><font size=-1>440     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_F.html#27250">ftok2</a>-&gt;<a href="dictionary_T.html#1421">previous</a>(), </span><span class="string">&quot;-- %name%&quot;</span><span class="default">) ||</span>
<a name="441"><font size=-1>441     </font></a><span class="default">                        <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_F.html#27250">ftok2</a>, </span><span class="string">&quot;%name% --&quot;</span><span class="default">))</span>
<a name="442"><font size=-1>442     </font></a><span class="default">                        </span><span class="keyword">break</span><span class="default">;</span>
<a name="443"><font size=-1>443     </font></a><span class="default"></span>
<a name="444"><font size=-1>444     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_F.html#27250">ftok2</a>-&gt;<a href="dictionary_T.html#1421">previous</a>(), </span><span class="string">&quot;;|{|}|%op% %name% [ %num% ]&quot;</span><span class="default">)) {</span>
<a name="445"><font size=-1>445     </font></a><span class="default">                        </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_I.html#27251">index</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_F.html#27250">ftok2</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">2</span><span class="default">));</span>
<a name="446"><font size=-1>446     </font></a><span class="default">                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27251">index</a> &gt;= </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(</span><span class="number">0</span><span class="default">) &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_I.html#27251">index</a> &gt;= <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(</span><span class="number">0</span><span class="default">)) {</span>
<a name="447"><font size=-1>447     </font></a><span class="default">                            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; <a href="dictionary_C.html#27252">callstack2</a>(<a href="dictionary_C.html#27243">callstack</a>);</span>
<a name="448"><font size=-1>448     </font></a><span class="default">                            <a href="dictionary_C.html#27252">callstack2</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_F.html#27250">ftok2</a>);</span>
<a name="449"><font size=-1>449     </font></a><span class="default"></span>
<a name="450"><font size=-1>450     </font></a><span class="default">                            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1095">vector</a>&lt;MathLib::bigint&gt; <a href="dictionary_I.html#27253">indexes</a>;</span>
<a name="451"><font size=-1>451     </font></a><span class="default">                            <a href="dictionary_I.html#27253">indexes</a>.<a href="dictionary_P.html#1100">push_back</a>(<a href="dictionary_I.html#27251">index</a>);</span>
<a name="452"><font size=-1>452     </font></a><span class="default"></span>
<a name="453"><font size=-1>453     </font></a><span class="default">                            <a href="dictionary_C.html#825">arrayIndexOutOfBoundsError</a>(<a href="dictionary_C.html#27252">callstack2</a>, <a href="dictionary_A.html#27242">arrayInfo</a>, <a href="dictionary_I.html#27253">indexes</a>);</span>
<a name="454"><font size=-1>454     </font></a><span class="default">                        }</span>
<a name="455"><font size=-1>455     </font></a><span class="default">                    }</span>
<a name="456"><font size=-1>456     </font></a><span class="default">                }</span>
<a name="457"><font size=-1>457     </font></a><span class="default"></span>
<a name="458"><font size=-1>458     </font></a><span class="default">                </span><span class="comment">// Calling function..</span>
<a name="459"><font size=-1>459     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_F.html#27250">ftok2</a>, </span><span class="string">&quot;%name% (&quot;</span><span class="default">)) {</span>
<a name="460"><font size=-1>460     </font></a><span class="default">                    <a href="dictionary_C.html#1800">ArrayInfo</a> <a href="dictionary_A.html#27254">ai</a>(<a href="dictionary_A.html#27242">arrayInfo</a>);</span>
<a name="461"><font size=-1>461     </font></a><span class="default">                    <a href="dictionary_A.html#27254">ai</a>.<a href="dictionary_C.html#1811">declarationId</a>(<a href="dictionary_P.html#27249">parameter</a>-&gt;<a href="dictionary_V.html#4822">declarationId</a>());</span>
<a name="462"><font size=-1>462     </font></a><span class="default">                    <a href="dictionary_C.html#1822">checkFunctionCall</a>(<a href="dictionary_F.html#27250">ftok2</a>, <a href="dictionary_A.html#27254">ai</a>, <a href="dictionary_C.html#27243">callstack</a>);</span>
<a name="463"><font size=-1>463     </font></a><span class="default">                }</span>
<a name="464"><font size=-1>464     </font></a><span class="default">            }</span>
<a name="465"><font size=-1>465     </font></a><span class="default">        }</span>
<a name="466"><font size=-1>466     </font></a><span class="default">    }</span>
<a name="467"><font size=-1>467     </font></a><span class="default"></span>
<a name="468"><font size=-1>468     </font></a><span class="default">    </span><span class="comment">// Check 'float x[10]' arguments in declaration</span>
<a name="469"><font size=-1>469     </font></a><span class="comment">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1876">isEnabled</a>(</span><span class="string">&quot;warning&quot;</span><span class="default">)) {</span>
<a name="470"><font size=-1>470     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_F.html#536">Function</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_F.html#27255">func</a> </span><span class="default">= <a href="dictionary_F.html#27240">ftok</a>.<a href="dictionary_T.html#1485">function</a>();</span>
<a name="471"><font size=-1>471     </font></a><span class="default"></span>
<a name="472"><font size=-1>472     </font></a><span class="default">        </span><span class="comment">// If argument is '%type% a[num]' then check bounds against num</span>
<a name="473"><font size=-1>473     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_F.html#27255">func</a>) {</span>
<a name="474"><font size=-1>474     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_A.html#27256">argument</a> </span><span class="default">= <a href="dictionary_F.html#27255">func</a>-&gt;<a href="dictionary_F.html#8229">getArgumentVar</a>(<a href="dictionary_P.html#27241">par</a>-</span><span class="number">1</span><span class="default">);</span>
<a name="475"><font size=-1>475     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_N.html#27257">nameToken</a>;</span>
<a name="476"><font size=-1>476     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27256">argument</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_A.html#27256">argument</a>-&gt;<a href="dictionary_V.html#2918">typeStartToken</a>(), </span><span class="string">&quot;%type% %var% [ %num% ] [,)[]&quot;</span><span class="default">)</span>
<a name="477"><font size=-1>477     </font></a><span class="default">                &amp;&amp; (<a href="dictionary_N.html#27257">nameToken</a> = <a href="dictionary_A.html#27256">argument</a>-&gt;<a href="dictionary_V.html#2646">nameToken</a>()) != <a href="dictionary_N.html#1132">nullptr</a>) {</span>
<a name="478"><font size=-1>478     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27258">tok2</a> = <a href="dictionary_N.html#27257">nameToken</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="479"><font size=-1>479     </font></a><span class="default"></span>
<a name="480"><font size=-1>480     </font></a><span class="default">                <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_A.html#27259">argsize</a> = <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#8527">sizeOfType</a>(<a href="dictionary_A.html#27256">argument</a>-&gt;<a href="dictionary_V.html#2918">typeStartToken</a>());</span>
<a name="481"><font size=-1>481     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27259">argsize</a> == </span><span class="number">100</span><span class="default">) </span><span class="comment">// unknown size</span>
<a name="482"><font size=-1>482     </font></a><span class="comment">                    <a href="dictionary_A.html#27259">argsize</a> </span><span class="default">= </span><span class="number">0</span><span class="default">;</span>
<a name="483"><font size=-1>483     </font></a><span class="default">                </span><span class="keyword">do </span><span class="default">{</span>
<a name="484"><font size=-1>484     </font></a><span class="default">                    <a href="dictionary_A.html#27259">argsize</a> *= <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_T.html#27258">tok2</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">1</span><span class="default">));</span>
<a name="485"><font size=-1>485     </font></a><span class="default">                    <a href="dictionary_T.html#27258">tok2</a> = <a href="dictionary_T.html#27258">tok2</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">3</span><span class="default">);</span>
<a name="486"><font size=-1>486     </font></a><span class="default">                } </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27258">tok2</a>, </span><span class="string">&quot;[ %num% ] [,)[]&quot;</span><span class="default">));</span>
<a name="487"><font size=-1>487     </font></a><span class="default"></span>
<a name="488"><font size=-1>488     </font></a><span class="default">                <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_A.html#27260">arraysize</a> = <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1810">element_size</a>();</span>
<a name="489"><font size=-1>489     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27260">arraysize</a> == </span><span class="number">100</span><span class="default">) </span><span class="comment">// unknown size</span>
<a name="490"><font size=-1>490     </font></a><span class="comment">                    <a href="dictionary_A.html#27260">arraysize</a> </span><span class="default">= </span><span class="number">0</span><span class="default">;</span>
<a name="491"><font size=-1>491     </font></a><span class="default">                </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27261">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27261">i</a> &lt; <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>(); <a href="dictionary_I.html#27261">i</a>++)</span>
<a name="492"><font size=-1>492     </font></a><span class="default">                    <a href="dictionary_A.html#27260">arraysize</a> *= <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_I.html#27261">i</a>);</span>
<a name="493"><font size=-1>493     </font></a><span class="default"></span>
<a name="494"><font size=-1>494     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27258">tok2</a>, </span><span class="string">&quot;[,)]&quot;</span><span class="default">) &amp;&amp; <a href="dictionary_A.html#27260">arraysize</a> &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_A.html#27259">argsize</a> &gt; <a href="dictionary_A.html#27260">arraysize</a>)</span>
<a name="495"><font size=-1>495     </font></a><span class="default">                    <a href="dictionary_C.html#1855">argumentSizeError</a>(&amp;<a href="dictionary_F.html#27240">ftok</a>, <a href="dictionary_F.html#27240">ftok</a>.<a href="dictionary_T.html#1416">str</a>(), <a href="dictionary_A.html#27242">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>());</span>
<a name="496"><font size=-1>496     </font></a><span class="default">            }</span>
<a name="497"><font size=-1>497     </font></a><span class="default">        }</span>
<a name="498"><font size=-1>498     </font></a><span class="default">    }</span>
<a name="499"><font size=-1>499     </font></a><span class="default">}</span>
<a name="500"><font size=-1>500     </font></a><span class="default"></span>
<a name="501"><font size=-1>501     </font></a><span class="default"></span>
<a name="502"><font size=-1>502     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1822">checkFunctionCall</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27262">tok</a>, </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> </span><span class="default">&amp;<a href="dictionary_A.html#27263">arrayInfo</a>, <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; <a href="dictionary_C.html#27264">callstack</a>)</span>
<a name="503"><font size=-1>503     </font></a><span class="default">{</span>
<a name="504"><font size=-1>504     </font></a><span class="default">    </span><span class="comment">// Don't go deeper than 2 levels, the checking can get very slow</span>
<a name="505"><font size=-1>505     </font></a><span class="comment">    // when there is no limit</span>
<a name="506"><font size=-1>506     </font></a><span class="comment">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27264">callstack</a>.<a href="dictionary_S.html#3014">size</a>() &gt;= </span><span class="number">2</span><span class="default">)</span>
<a name="507"><font size=-1>507     </font></a><span class="default">        </span><span class="keyword">return</span><span class="default">;</span>
<a name="508"><font size=-1>508     </font></a><span class="default"></span>
<a name="509"><font size=-1>509     </font></a><span class="default">    </span><span class="comment">// Prevent recursion</span>
<a name="510"><font size=-1>510     </font></a><span class="comment">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token*&gt;::<a href="dictionary_S.html#4610">const_iterator</a> <a href="dictionary_I.html#27265">it</a> = <a href="dictionary_C.html#27264">callstack</a>.<a href="dictionary_S.html#3264">begin</a>(); <a href="dictionary_I.html#27265">it</a> != <a href="dictionary_C.html#27264">callstack</a>.<a href="dictionary_S.html#3265">end</a>(); ++<a href="dictionary_I.html#27265">it</a>) {</span>
<a name="511"><font size=-1>511     </font></a><span class="default">        </span><span class="comment">// Same function name =&gt; bail out</span>
<a name="512"><font size=-1>512     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27262">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == (*<a href="dictionary_I.html#27265">it</a>)-&gt;<a href="dictionary_S.html#148">str</a>())</span>
<a name="513"><font size=-1>513     </font></a><span class="default">            </span><span class="keyword">return</span><span class="default">;</span>
<a name="514"><font size=-1>514     </font></a><span class="default">    }</span>
<a name="515"><font size=-1>515     </font></a><span class="default">    <a href="dictionary_C.html#27264">callstack</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_T.html#27262">tok</a>);</span>
<a name="516"><font size=-1>516     </font></a><span class="default"></span>
<a name="517"><font size=-1>517     </font></a><span class="default">    </span><span class="keyword">const unsigned int <a href="dictionary_D.html#27266">declarationId</a> </span><span class="default">= <a href="dictionary_A.html#27263">arrayInfo</a>.<a href="dictionary_C.html#1811">declarationId</a>();</span>
<a name="518"><font size=-1>518     </font></a><span class="default"></span>
<a name="519"><font size=-1>519     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_A.html#27267">argtok</a> = <a href="dictionary_T.html#27262">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="520"><font size=-1>520     </font></a><span class="default">    </span><span class="keyword">unsigned int <a href="dictionary_A.html#27268">argnr</a> </span><span class="default">= </span><span class="number">1U</span><span class="default">;</span>
<a name="521"><font size=-1>521     </font></a><span class="default">    </span><span class="keyword">while </span><span class="default">(<a href="dictionary_A.html#27267">argtok</a>) {</span>
<a name="522"><font size=-1>522     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_A.html#27267">argtok</a>, </span><span class="string">&quot;%varid% ,|)&quot;</span><span class="default">, <a href="dictionary_D.html#27266">declarationId</a>))</span>
<a name="523"><font size=-1>523     </font></a><span class="default">            <a href="dictionary_C.html#1821">checkFunctionParameter</a>(*<a href="dictionary_T.html#27262">tok</a>, <a href="dictionary_A.html#27268">argnr</a>, <a href="dictionary_A.html#27263">arrayInfo</a>, <a href="dictionary_C.html#27264">callstack</a>);</span>
<a name="524"><font size=-1>524     </font></a><span class="default">        </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_A.html#27267">argtok</a>, </span><span class="string">&quot;%varid% + %num% ,|)&quot;</span><span class="default">, <a href="dictionary_D.html#27266">declarationId</a>)) {</span>
<a name="525"><font size=-1>525     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> <a href="dictionary_A.html#27269">ai</a></span><span class="default">(<a href="dictionary_A.html#27263">arrayInfo</a>.<a href="dictionary_C.html#1803">limit</a>(<a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_A.html#27267">argtok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">2</span><span class="default">))));</span>
<a name="526"><font size=-1>526     </font></a><span class="default">            <a href="dictionary_C.html#1821">checkFunctionParameter</a>(*<a href="dictionary_T.html#27262">tok</a>, <a href="dictionary_A.html#27268">argnr</a>, <a href="dictionary_A.html#27269">ai</a>, <a href="dictionary_C.html#27264">callstack</a>);</span>
<a name="527"><font size=-1>527     </font></a><span class="default">        }</span>
<a name="528"><font size=-1>528     </font></a><span class="default">        </span><span class="comment">// goto next parameter..</span>
<a name="529"><font size=-1>529     </font></a><span class="comment">        <a href="dictionary_A.html#27267">argtok</a> </span><span class="default">= <a href="dictionary_A.html#27267">argtok</a>-&gt;<a href="dictionary_T.html#1911">nextArgument</a>();</span>
<a name="530"><font size=-1>530     </font></a><span class="default">        <a href="dictionary_A.html#27268">argnr</a>++;</span>
<a name="531"><font size=-1>531     </font></a><span class="default">    }</span>
<a name="532"><font size=-1>532     </font></a><span class="default">}</span>
<a name="533"><font size=-1>533     </font></a><span class="default"></span>
<a name="534"><font size=-1>534     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1820">checkScope</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27270">tok</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;std::string&gt; &amp;<a href="dictionary_V.html#27271">varname</a>, </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> </span><span class="default">&amp;<a href="dictionary_A.html#27272">arrayInfo</a>)</span>
<a name="535"><font size=-1>535     </font></a><span class="default">{</span>
<a name="536"><font size=-1>536     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_S.html#27273">size</a> = <a href="dictionary_A.html#27272">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(</span><span class="number">0</span><span class="default">);</span>
<a name="537"><font size=-1>537     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27273">size</a> &lt;= </span><span class="number">0</span><span class="default">)  </span><span class="comment">// unknown size</span>
<a name="538"><font size=-1>538     </font></a><span class="comment">        </span><span class="keyword">return</span><span class="default">;</span>
<a name="539"><font size=-1>539     </font></a><span class="default"></span>
<a name="540"><font size=-1>540     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;return&quot;</span><span class="default">) {</span>
<a name="541"><font size=-1>541     </font></a><span class="default">        <a href="dictionary_T.html#27270">tok</a> = <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="542"><font size=-1>542     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#27270">tok</a>)</span>
<a name="543"><font size=-1>543     </font></a><span class="default">            </span><span class="keyword">return</span><span class="default">;</span>
<a name="544"><font size=-1>544     </font></a><span class="default">    }</span>
<a name="545"><font size=-1>545     </font></a><span class="default"></span>
<a name="546"><font size=-1>546     </font></a><span class="default">    </span><span class="keyword">const bool <a href="dictionary_P.html#27274">printInconclusive</a> </span><span class="default">= <a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#836">inconclusive</a>;</span>
<a name="547"><font size=-1>547     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_T.html#27275">total_size</a> = <a href="dictionary_A.html#27272">arrayInfo</a>.<a href="dictionary_C.html#1810">element_size</a>() * <a href="dictionary_S.html#27273">size</a>;</span>
<a name="548"><font size=-1>548     </font></a><span class="default">    </span><span class="keyword">const unsigned int <a href="dictionary_D.html#27276">declarationId</a> </span><span class="default">= <a href="dictionary_A.html#27272">arrayInfo</a>.<a href="dictionary_C.html#1811">declarationId</a>();</span>
<a name="549"><font size=-1>549     </font></a><span class="default"></span>
<a name="550"><font size=-1>550     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#44">string</a> <a href="dictionary_V.html#27277">varnames</a>;</span>
<a name="551"><font size=-1>551     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27278">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27278">i</a> &lt; <a href="dictionary_V.html#27271">varname</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27278">i</a>)</span>
<a name="552"><font size=-1>552     </font></a><span class="default">        <a href="dictionary_V.html#27277">varnames</a> += (<a href="dictionary_I.html#27278">i</a> == </span><span class="number">0 </span><span class="default">? </span><span class="string">&quot;&quot; </span><span class="default">: </span><span class="string">&quot; . &quot;</span><span class="default">) + <a href="dictionary_V.html#27271">varname</a>[<a href="dictionary_I.html#27278">i</a>];</span>
<a name="553"><font size=-1>553     </font></a><span class="default"></span>
<a name="554"><font size=-1>554     </font></a><span class="default">    </span><span class="keyword">const unsigned char <a href="dictionary_V.html#27279">varcount</a> </span><span class="default">= </span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">unsigned char</span><span class="default">&gt;(<a href="dictionary_V.html#27271">varname</a>.<a href="dictionary_E.html#2016">empty</a>() ? </span><span class="number">0U </span><span class="default">: (<a href="dictionary_V.html#27271">varname</a>.<a href="dictionary_S.html#1203">size</a>() - </span><span class="number">1</span><span class="default">) * </span><span class="number">2U</span><span class="default">);</span>
<a name="555"><font size=-1>555     </font></a><span class="default"></span>
<a name="556"><font size=-1>556     </font></a><span class="default">    </span><span class="comment">// ValueFlow array index..</span>
<a name="557"><font size=-1>557     </font></a><span class="comment">    </span><span class="keyword">if </span><span class="default">((<a href="dictionary_D.html#27276">declarationId</a> &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;%varid% [&quot;</span><span class="default">, <a href="dictionary_D.html#27276">declarationId</a>)) ||</span>
<a name="558"><font size=-1>558     </font></a><span class="default">        (<a href="dictionary_D.html#27276">declarationId</a> == </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_T.html#27270">tok</a>, (<a href="dictionary_V.html#27277">varnames</a> + </span><span class="string">&quot; [&quot;</span><span class="default">).<a href="dictionary_C.html#1137">c_str</a>()))) {</span>
<a name="559"><font size=-1>559     </font></a><span class="default"></span>
<a name="560"><font size=-1>560     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27280">tok2</a> = <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="561"><font size=-1>561     </font></a><span class="default">        </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#27280">tok2</a>-&gt;<a href="dictionary_T.html#1416">str</a>() != </span><span class="string">&quot;[&quot;</span><span class="default">)</span>
<a name="562"><font size=-1>562     </font></a><span class="default">            <a href="dictionary_T.html#27280">tok2</a> = <a href="dictionary_T.html#27280">tok2</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="563"><font size=-1>563     </font></a><span class="default">        <a href="dictionary_C.html#1856">valueFlowCheckArrayIndex</a>(<a href="dictionary_T.html#27280">tok2</a>, <a href="dictionary_A.html#27272">arrayInfo</a>);</span>
<a name="564"><font size=-1>564     </font></a><span class="default">    }</span>
<a name="565"><font size=-1>565     </font></a><span class="default"></span>
<a name="566"><font size=-1>566     </font></a><span class="default">    </span><span class="comment">// If the result of pointer arithmetic means that the pointer is</span>
<a name="567"><font size=-1>567     </font></a><span class="comment">    // out of bounds then this flag will be set.</span>
<a name="568"><font size=-1>568     </font></a><span class="comment">    </span><span class="keyword">bool <a href="dictionary_P.html#27281">pointerIsOutOfBounds</a> </span><span class="default">= </span><span class="keyword">false</span><span class="default">;</span>
<a name="569"><font size=-1>569     </font></a><span class="default"></span>
<a name="570"><font size=-1>570     </font></a><span class="default">    </span><span class="keyword">const bool <a href="dictionary_P.html#27282">printPortability</a> </span><span class="default">= <a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1876">isEnabled</a>(</span><span class="string">&quot;portability&quot;</span><span class="default">);</span>
<a name="571"><font size=-1>571     </font></a><span class="default"></span>
<a name="572"><font size=-1>572     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_E.html#27283">end</a> </span><span class="default">= <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1928">scope</a>()-&gt;<a href="dictionary_T.html#1930">classEnd</a>; <a href="dictionary_T.html#27270">tok</a> &amp;&amp; <a href="dictionary_T.html#27270">tok</a> != <a href="dictionary_E.html#27283">end</a>; <a href="dictionary_T.html#27270">tok</a> = <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="573"><font size=-1>573     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#27276">declarationId</a> != </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;%varid% = new|malloc|realloc&quot;</span><span class="default">, <a href="dictionary_D.html#27276">declarationId</a>)) {</span>
<a name="574"><font size=-1>574     </font></a><span class="default">            </span><span class="comment">// Abort</span>
<a name="575"><font size=-1>575     </font></a><span class="comment">            </span><span class="keyword">break</span><span class="default">;</span>
<a name="576"><font size=-1>576     </font></a><span class="default">        }</span>
<a name="577"><font size=-1>577     </font></a><span class="default"></span>
<a name="578"><font size=-1>578     </font></a><span class="default">        </span><span class="comment">// reassign buffer</span>
<a name="579"><font size=-1>579     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#27276">declarationId</a> &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;[;{}] %varid% = %any%&quot;</span><span class="default">, <a href="dictionary_D.html#27276">declarationId</a>)) {</span>
<a name="580"><font size=-1>580     </font></a><span class="default">            </span><span class="comment">// using varid .. bailout</span>
<a name="581"><font size=-1>581     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">3</span><span class="default">)-&gt;<a href="dictionary_T.html#1481">varId</a>() != <a href="dictionary_D.html#27276">declarationId</a>)</span>
<a name="582"><font size=-1>582     </font></a><span class="default">                </span><span class="keyword">break</span><span class="default">;</span>
<a name="583"><font size=-1>583     </font></a><span class="default">            <a href="dictionary_P.html#27281">pointerIsOutOfBounds</a> = </span><span class="keyword">false</span><span class="default">;</span>
<a name="584"><font size=-1>584     </font></a><span class="default">        }</span>
<a name="585"><font size=-1>585     </font></a><span class="default"></span>
<a name="586"><font size=-1>586     </font></a><span class="default">        </span><span class="comment">// Array index..</span>
<a name="587"><font size=-1>587     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">((<a href="dictionary_D.html#27276">declarationId</a> &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; ((<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;return&quot; </span><span class="default">|| (!<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1426">isName</a>() &amp;&amp; !<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;[.&amp;]&quot;</span><span class="default">))) &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), </span><span class="string">&quot;%varid% [&quot;</span><span class="default">, <a href="dictionary_D.html#27276">declarationId</a>))) ||</span>
<a name="588"><font size=-1>588     </font></a><span class="default">            (<a href="dictionary_D.html#27276">declarationId</a> == </span><span class="number">0 </span><span class="default">&amp;&amp; ((<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;return&quot; </span><span class="default">|| (!<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1426">isName</a>() &amp;&amp; !<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;[.&amp;]&quot;</span><span class="default">))) &amp;&amp; (<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), (<a href="dictionary_V.html#27277">varnames</a> + </span><span class="string">&quot; [&quot;</span><span class="default">).<a href="dictionary_C.html#1137">c_str</a>()) || <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), (<a href="dictionary_V.html#27271">varname</a>[</span><span class="number">0</span><span class="default">] +</span><span class="string">&quot; [ %num% ] . &quot; </span><span class="default">+ <a href="dictionary_V.html#27271">varname</a>[</span><span class="number">1</span><span class="default">] + </span><span class="string">&quot; [ %num% ]&quot;</span><span class="default">).<a href="dictionary_C.html#1137">c_str</a>()))))) {</span>
<a name="589"><font size=-1>589     </font></a><span class="default">            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1095">vector</a>&lt;MathLib::bigint&gt; <a href="dictionary_I.html#27284">indexes</a>;</span>
<a name="590"><font size=-1>590     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27285">tok2</a> = <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2 </span><span class="default">+ <a href="dictionary_V.html#27279">varcount</a>);</span>
<a name="591"><font size=-1>591     </font></a><span class="default">            </span><span class="keyword">for </span><span class="default">(; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27285">tok2</a>, </span><span class="string">&quot;[ %num% ]&quot;</span><span class="default">); <a href="dictionary_T.html#27285">tok2</a> = <a href="dictionary_T.html#27285">tok2</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">3</span><span class="default">)) {</span>
<a name="592"><font size=-1>592     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_I.html#27286">index</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_T.html#27285">tok2</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">1</span><span class="default">));</span>
<a name="593"><font size=-1>593     </font></a><span class="default">                <a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_P.html#1100">push_back</a>(<a href="dictionary_I.html#27286">index</a>);</span>
<a name="594"><font size=-1>594     </font></a><span class="default">            }</span>
<a name="595"><font size=-1>595     </font></a><span class="default">            </span><span class="keyword">for </span><span class="default">(; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27285">tok2</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">3</span><span class="default">), </span><span class="string">&quot;[ %num% ]&quot;</span><span class="default">); <a href="dictionary_T.html#27285">tok2</a> = <a href="dictionary_T.html#27285">tok2</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">3</span><span class="default">)) {</span>
<a name="596"><font size=-1>596     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_I.html#27287">index</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_T.html#27285">tok2</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">4</span><span class="default">));</span>
<a name="597"><font size=-1>597     </font></a><span class="default">                <a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_P.html#1100">push_back</a>(<a href="dictionary_I.html#27287">index</a>);</span>
<a name="598"><font size=-1>598     </font></a><span class="default">            }</span>
<a name="599"><font size=-1>599     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_E.html#2016">empty</a>() &amp;&amp; <a href="dictionary_A.html#27272">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1U </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_T.html#27285">tok2</a>, </span><span class="string">&quot;[&quot;</span><span class="default">) &amp;&amp; <a href="dictionary_T.html#27285">tok2</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()) {</span>
<a name="600"><font size=-1>600     </font></a><span class="default">                </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_V.html#27288">value</a> = <a href="dictionary_T.html#27285">tok2</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#22250">getMaxValue</a>(</span><span class="keyword">false</span><span class="default">);</span>
<a name="601"><font size=-1>601     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27288">value</a>) {</span>
<a name="602"><font size=-1>602     </font></a><span class="default">                    <a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_P.html#1100">push_back</a>(<a href="dictionary_V.html#27288">value</a>-&gt;<a href="dictionary_V.html#5807">intvalue</a>);</span>
<a name="603"><font size=-1>603     </font></a><span class="default">                }</span>
<a name="604"><font size=-1>604     </font></a><span class="default">            }</span>
<a name="605"><font size=-1>605     </font></a><span class="default"></span>
<a name="606"><font size=-1>606     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_S.html#1203">size</a>() == <a href="dictionary_A.html#27272">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>()) {</span>
<a name="607"><font size=-1>607     </font></a><span class="default">                </span><span class="comment">// Check if the indexes point outside the whole array..</span>
<a name="608"><font size=-1>608     </font></a><span class="comment">                // char a[10][10];</span>
<a name="609"><font size=-1>609     </font></a><span class="comment">                // a[0][20]  &lt;-- ok.</span>
<a name="610"><font size=-1>610     </font></a><span class="comment">                // a[9][20]  &lt;-- error.</span>
<a name="611"><font size=-1>611     </font></a><span class="comment"></span>
<a name="612"><font size=-1>612     </font></a><span class="comment">                // total number of elements of array..</span>
<a name="613"><font size=-1>613     </font></a><span class="comment">                <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_T.html#27289">totalElements</a> = </span><span class="number">1</span><span class="default">;</span>
<a name="614"><font size=-1>614     </font></a><span class="default"></span>
<a name="615"><font size=-1>615     </font></a><span class="default">                </span><span class="comment">// total index..</span>
<a name="616"><font size=-1>616     </font></a><span class="comment">                <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_T.html#27290">totalIndex</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="617"><font size=-1>617     </font></a><span class="default"></span>
<a name="618"><font size=-1>618     </font></a><span class="default">                </span><span class="comment">// calculate the totalElements and totalIndex..</span>
<a name="619"><font size=-1>619     </font></a><span class="comment">                </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27291">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27291">i</a> &lt; <a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27291">i</a>) {</span>
<a name="620"><font size=-1>620     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_R.html#27292">ri</a> = <a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_S.html#1203">size</a>() - </span><span class="number">1 </span><span class="default">- <a href="dictionary_I.html#27291">i</a>;</span>
<a name="621"><font size=-1>621     </font></a><span class="default">                    <a href="dictionary_T.html#27290">totalIndex</a> += <a href="dictionary_I.html#27284">indexes</a>[<a href="dictionary_R.html#27292">ri</a>] * <a href="dictionary_T.html#27289">totalElements</a>;</span>
<a name="622"><font size=-1>622     </font></a><span class="default">                    <a href="dictionary_T.html#27289">totalElements</a> *= <a href="dictionary_A.html#27272">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_R.html#27292">ri</a>);</span>
<a name="623"><font size=-1>623     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27272">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_R.html#27292">ri</a>) == -</span><span class="number">1</span><span class="default">) {</span>
<a name="624"><font size=-1>624     </font></a><span class="default">                        </span><span class="comment">// unknown size</span>
<a name="625"><font size=-1>625     </font></a><span class="comment">                        <a href="dictionary_T.html#27289">totalElements</a> </span><span class="default">= </span><span class="number">0</span><span class="default">;</span>
<a name="626"><font size=-1>626     </font></a><span class="default">                        </span><span class="keyword">break</span><span class="default">;</span>
<a name="627"><font size=-1>627     </font></a><span class="default">                    }</span>
<a name="628"><font size=-1>628     </font></a><span class="default">                }</span>
<a name="629"><font size=-1>629     </font></a><span class="default"></span>
<a name="630"><font size=-1>630     </font></a><span class="default">                </span><span class="comment">// totalElements == 0 =&gt; Unknown size</span>
<a name="631"><font size=-1>631     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27289">totalElements</a> == </span><span class="number">0</span><span class="default">)</span>
<a name="632"><font size=-1>632     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="633"><font size=-1>633     </font></a><span class="default"></span>
<a name="634"><font size=-1>634     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27293">tok3</a> = <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1421">previous</a>();</span>
<a name="635"><font size=-1>635     </font></a><span class="default">                </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#27293">tok3</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27293">tok3</a>-&gt;<a href="dictionary_T.html#1421">previous</a>(), </span><span class="string">&quot;%name% .&quot;</span><span class="default">))</span>
<a name="636"><font size=-1>636     </font></a><span class="default">                    <a href="dictionary_T.html#27293">tok3</a> = <a href="dictionary_T.html#27293">tok3</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(-</span><span class="number">2</span><span class="default">);</span>
<a name="637"><font size=-1>637     </font></a><span class="default"></span>
<a name="638"><font size=-1>638     </font></a><span class="default">                </span><span class="comment">// taking address of 1 past end?</span>
<a name="639"><font size=-1>639     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27290">totalIndex</a> == <a href="dictionary_T.html#27289">totalElements</a>) {</span>
<a name="640"><font size=-1>640     </font></a><span class="default">                    </span><span class="keyword">const bool <a href="dictionary_A.html#27294">addr</a> </span><span class="default">= (<a href="dictionary_T.html#27293">tok3</a> &amp;&amp; (<a href="dictionary_T.html#27293">tok3</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;&amp;&quot; </span><span class="default">||</span>
<a name="641"><font size=-1>641     </font></a><span class="default">                                                <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_T.html#27293">tok3</a>-&gt;<a href="dictionary_T.html#1421">previous</a>(), </span><span class="string">&quot;&amp; (&quot;</span><span class="default">)));</span>
<a name="642"><font size=-1>642     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27294">addr</a>)</span>
<a name="643"><font size=-1>643     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="644"><font size=-1>644     </font></a><span class="default">                }</span>
<a name="645"><font size=-1>645     </font></a><span class="default"></span>
<a name="646"><font size=-1>646     </font></a><span class="default">                </span><span class="comment">// Is totalIndex in bounds?</span>
<a name="647"><font size=-1>647     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27290">totalIndex</a> &gt; <a href="dictionary_T.html#27289">totalElements</a> || <a href="dictionary_T.html#27290">totalIndex</a> &lt; </span><span class="number">0</span><span class="default">) {</span>
<a name="648"><font size=-1>648     </font></a><span class="default">                    <a href="dictionary_C.html#825">arrayIndexOutOfBoundsError</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">1 </span><span class="default">+ <a href="dictionary_V.html#27279">varcount</a>), <a href="dictionary_A.html#27272">arrayInfo</a>, <a href="dictionary_I.html#27284">indexes</a>);</span>
<a name="649"><font size=-1>649     </font></a><span class="default">                }</span>
<a name="650"><font size=-1>650     </font></a><span class="default">                </span><span class="comment">// Is any array index out of bounds?</span>
<a name="651"><font size=-1>651     </font></a><span class="comment">                </span><span class="keyword">else </span><span class="default">{</span>
<a name="652"><font size=-1>652     </font></a><span class="default">                    </span><span class="comment">// check each index for overflow</span>
<a name="653"><font size=-1>653     </font></a><span class="comment">                    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27295">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27295">i</a> &lt; <a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27295">i</a>) {</span>
<a name="654"><font size=-1>654     </font></a><span class="default">                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27284">indexes</a>[<a href="dictionary_I.html#27295">i</a>] &gt;= <a href="dictionary_A.html#27272">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_I.html#27295">i</a>)) {</span>
<a name="655"><font size=-1>655     </font></a><span class="default">                            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27284">indexes</a>.<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1U</span><span class="default">) {</span>
<a name="656"><font size=-1>656     </font></a><span class="default">                                <a href="dictionary_C.html#825">arrayIndexOutOfBoundsError</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">1 </span><span class="default">+ <a href="dictionary_V.html#27279">varcount</a>), <a href="dictionary_A.html#27272">arrayInfo</a>, <a href="dictionary_I.html#27284">indexes</a>);</span>
<a name="657"><font size=-1>657     </font></a><span class="default">                                </span><span class="keyword">break</span><span class="default">; </span><span class="comment">// only warn about the first one</span>
<a name="658"><font size=-1>658     </font></a><span class="comment">                            </span><span class="default">}</span>
<a name="659"><font size=-1>659     </font></a><span class="default"></span>
<a name="660"><font size=-1>660     </font></a><span class="default">                            </span><span class="comment">// The access is still within the memory range for the array</span>
<a name="661"><font size=-1>661     </font></a><span class="comment">                            // so it may be intentional.</span>
<a name="662"><font size=-1>662     </font></a><span class="comment">                            </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_P.html#27274">printInconclusive</a>) {</span>
<a name="663"><font size=-1>663     </font></a><span class="default">                                <a href="dictionary_C.html#825">arrayIndexOutOfBoundsError</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">1 </span><span class="default">+ <a href="dictionary_V.html#27279">varcount</a>), <a href="dictionary_A.html#27272">arrayInfo</a>, <a href="dictionary_I.html#27284">indexes</a>);</span>
<a name="664"><font size=-1>664     </font></a><span class="default">                                </span><span class="keyword">break</span><span class="default">; </span><span class="comment">// only warn about the first one</span>
<a name="665"><font size=-1>665     </font></a><span class="comment">                            </span><span class="default">}</span>
<a name="666"><font size=-1>666     </font></a><span class="default">                        }</span>
<a name="667"><font size=-1>667     </font></a><span class="default">                    }</span>
<a name="668"><font size=-1>668     </font></a><span class="default">                }</span>
<a name="669"><font size=-1>669     </font></a><span class="default">            }</span>
<a name="670"><font size=-1>670     </font></a><span class="default">            <a href="dictionary_T.html#27270">tok</a> = <a href="dictionary_T.html#27285">tok2</a>;</span>
<a name="671"><font size=-1>671     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="672"><font size=-1>672     </font></a><span class="default">        }</span>
<a name="673"><font size=-1>673     </font></a><span class="default"></span>
<a name="674"><font size=-1>674     </font></a><span class="default">        </span><span class="comment">// memset, memcmp, memcpy, strncpy, fgets..</span>
<a name="675"><font size=-1>675     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#27276">declarationId</a> == </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_S.html#27273">size</a> &gt; </span><span class="number">0</span><span class="default">) {</span>
<a name="676"><font size=-1>676     </font></a><span class="default">            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; <a href="dictionary_C.html#27296">callstack</a>;</span>
<a name="677"><font size=-1>677     </font></a><span class="default">            <a href="dictionary_C.html#27296">callstack</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_T.html#27270">tok</a>);</span>
<a name="678"><font size=-1>678     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, (</span><span class="string">&quot;%name% ( &quot; </span><span class="default">+ <a href="dictionary_V.html#27277">varnames</a> + </span><span class="string">&quot; ,&quot;</span><span class="default">).<a href="dictionary_C.html#1137">c_str</a>()))</span>
<a name="679"><font size=-1>679     </font></a><span class="default">                <a href="dictionary_C.html#1821">checkFunctionParameter</a>(*<a href="dictionary_T.html#27270">tok</a>, </span><span class="number">1</span><span class="default">, <a href="dictionary_A.html#27272">arrayInfo</a>, <a href="dictionary_C.html#27296">callstack</a>);</span>
<a name="680"><font size=-1>680     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, (</span><span class="string">&quot;%name% ( %name% , &quot; </span><span class="default">+ <a href="dictionary_V.html#27277">varnames</a> + </span><span class="string">&quot; ,&quot;</span><span class="default">).<a href="dictionary_C.html#1137">c_str</a>()))</span>
<a name="681"><font size=-1>681     </font></a><span class="default">                <a href="dictionary_C.html#1821">checkFunctionParameter</a>(*<a href="dictionary_T.html#27270">tok</a>, </span><span class="number">2</span><span class="default">, <a href="dictionary_A.html#27272">arrayInfo</a>, <a href="dictionary_C.html#27296">callstack</a>);</span>
<a name="682"><font size=-1>682     </font></a><span class="default">        }</span>
<a name="683"><font size=-1>683     </font></a><span class="default"></span>
<a name="684"><font size=-1>684     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27275">total_size</a> &gt; </span><span class="number">0</span><span class="default">) {</span>
<a name="685"><font size=-1>685     </font></a><span class="default">            </span><span class="comment">// Writing data into array..</span>
<a name="686"><font size=-1>686     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">((<a href="dictionary_D.html#27276">declarationId</a> &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;strcpy|strcat ( %varid% , %str%|%var% )&quot;</span><span class="default">, <a href="dictionary_D.html#27276">declarationId</a>)) ||</span>
<a name="687"><font size=-1>687     </font></a><span class="default">                (<a href="dictionary_D.html#27276">declarationId</a> == </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, (</span><span class="string">&quot;strcpy|strcat ( &quot; </span><span class="default">+ <a href="dictionary_V.html#27277">varnames</a> + </span><span class="string">&quot; , %str%|%var% )&quot;</span><span class="default">).<a href="dictionary_C.html#1137">c_str</a>()))) {</span>
<a name="688"><font size=-1>688     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* <a href="dictionary_L.html#27297">lastParamTok</a> = <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(<a href="dictionary_V.html#27279">varcount</a> + </span><span class="number">4</span><span class="default">);</span>
<a name="689"><font size=-1>689     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_L.html#27297">lastParamTok</a>-&gt;<a href="dictionary_T.html#2894">tokType</a>() == <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1644">Type</a>::<a href="dictionary_T.html#27298">eString</a>) {</span>
<a name="690"><font size=-1>690     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_L.html#27299">len</a> = <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#2940">getStrLength</a>(<a href="dictionary_L.html#27297">lastParamTok</a>);</span>
<a name="691"><font size=-1>691     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_L.html#27299">len</a> &gt;= <a href="dictionary_T.html#27275">total_size</a>) {</span>
<a name="692"><font size=-1>692     </font></a><span class="default">                        <a href="dictionary_C.html#1838">bufferOverrunError</a>(<a href="dictionary_T.html#27270">tok</a>, <a href="dictionary_D.html#27276">declarationId</a> &gt; </span><span class="number">0 </span><span class="default">? <a href="dictionary_E.html#1529">emptyString</a> : <a href="dictionary_V.html#27277">varnames</a>);</span>
<a name="693"><font size=-1>693     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="694"><font size=-1>694     </font></a><span class="default">                    }</span>
<a name="695"><font size=-1>695     </font></a><span class="default">                } </span><span class="keyword">else </span><span class="default">{</span>
<a name="696"><font size=-1>696     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">*<a href="dictionary_V.html#27300">var</a> = <a href="dictionary_L.html#27297">lastParamTok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>();</span>
<a name="697"><font size=-1>697     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27300">var</a> &amp;&amp; <a href="dictionary_V.html#27300">var</a>-&gt;<a href="dictionary_V.html#2645">isArray</a>() &amp;&amp; <a href="dictionary_V.html#27300">var</a>-&gt;<a href="dictionary_V.html#8129">dimensions</a>().<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1</span><span class="default">) {</span>
<a name="698"><font size=-1>698     </font></a><span class="default">                        </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_L.html#27301">len</a> = <a href="dictionary_V.html#27300">var</a>-&gt;<a href="dictionary_V.html#8130">dimension</a>(</span><span class="number">0</span><span class="default">);</span>
<a name="699"><font size=-1>699     </font></a><span class="default">                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_L.html#27301">len</a> &gt; <a href="dictionary_T.html#27275">total_size</a>) {</span>
<a name="700"><font size=-1>700     </font></a><span class="default">                            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27274">printInconclusive</a>)</span>
<a name="701"><font size=-1>701     </font></a><span class="default">                                <a href="dictionary_C.html#1854">possibleBufferOverrunError</a>(<a href="dictionary_T.html#27270">tok</a>, <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">4</span><span class="default">), <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">2</span><span class="default">), <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;strcat&quot;</span><span class="default">);</span>
<a name="702"><font size=-1>702     </font></a><span class="default">                            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="703"><font size=-1>703     </font></a><span class="default">                        }</span>
<a name="704"><font size=-1>704     </font></a><span class="default">                    }</span>
<a name="705"><font size=-1>705     </font></a><span class="default">                }</span>
<a name="706"><font size=-1>706     </font></a><span class="default">            }</span>
<a name="707"><font size=-1>707     </font></a><span class="default"></span>
<a name="708"><font size=-1>708     </font></a><span class="default">            </span><span class="comment">// Detect few strcat() calls</span>
<a name="709"><font size=-1>709     </font></a><span class="comment">            </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> <a href="dictionary_S.html#27302">strcatPattern</a> = <a href="dictionary_D.html#27276">declarationId</a> &gt; </span><span class="number">0 </span><span class="default">? <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#147">string</a>(</span><span class="string">&quot;strcat ( %varid% , %str% ) ;&quot;</span><span class="default">) : (</span><span class="string">&quot;strcat ( &quot; </span><span class="default">+ <a href="dictionary_V.html#27277">varnames</a> + </span><span class="string">&quot; , %str% ) ;&quot;</span><span class="default">);</span>
<a name="710"><font size=-1>710     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, <a href="dictionary_S.html#27302">strcatPattern</a>.<a href="dictionary_S.html#87">c_str</a>(), <a href="dictionary_D.html#27276">declarationId</a>)) {</span>
<a name="711"><font size=-1>711     </font></a><span class="default">                <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_C.html#27303">charactersAppend</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="712"><font size=-1>712     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27304">tok2</a> = <a href="dictionary_T.html#27270">tok</a>;</span>
<a name="713"><font size=-1>713     </font></a><span class="default"></span>
<a name="714"><font size=-1>714     </font></a><span class="default">                </span><span class="keyword">do </span><span class="default">{</span>
<a name="715"><font size=-1>715     </font></a><span class="default">                    <a href="dictionary_C.html#27303">charactersAppend</a> += <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#2940">getStrLength</a>(<a href="dictionary_T.html#27304">tok2</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">4 </span><span class="default">+ <a href="dictionary_V.html#27279">varcount</a>));</span>
<a name="716"><font size=-1>716     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27303">charactersAppend</a> &gt;= </span><span class="keyword">static_cast</span><span class="default">&lt;<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a>&gt;(<a href="dictionary_T.html#27275">total_size</a>)) {</span>
<a name="717"><font size=-1>717     </font></a><span class="default">                        <a href="dictionary_C.html#1838">bufferOverrunError</a>(<a href="dictionary_T.html#27304">tok2</a>);</span>
<a name="718"><font size=-1>718     </font></a><span class="default">                        </span><span class="keyword">break</span><span class="default">;</span>
<a name="719"><font size=-1>719     </font></a><span class="default">                    }</span>
<a name="720"><font size=-1>720     </font></a><span class="default">                    <a href="dictionary_T.html#27304">tok2</a> = <a href="dictionary_T.html#27304">tok2</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">7 </span><span class="default">+ <a href="dictionary_V.html#27279">varcount</a>);</span>
<a name="721"><font size=-1>721     </font></a><span class="default">                } </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27304">tok2</a>, <a href="dictionary_S.html#27302">strcatPattern</a>.<a href="dictionary_S.html#87">c_str</a>(), <a href="dictionary_D.html#27276">declarationId</a>));</span>
<a name="722"><font size=-1>722     </font></a><span class="default">            }</span>
<a name="723"><font size=-1>723     </font></a><span class="default"></span>
<a name="724"><font size=-1>724     </font></a><span class="default">            </span><span class="comment">// Check function call..</span>
<a name="725"><font size=-1>725     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;%name% (&quot;</span><span class="default">)) {</span>
<a name="726"><font size=-1>726     </font></a><span class="default">                </span><span class="comment">// No varid =&gt; function calls are not handled</span>
<a name="727"><font size=-1>727     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#27276">declarationId</a> == </span><span class="number">0</span><span class="default">)</span>
<a name="728"><font size=-1>728     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="729"><font size=-1>729     </font></a><span class="default"></span>
<a name="730"><font size=-1>730     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> <a href="dictionary_A.html#27305">arrayInfo1</a></span><span class="default">(<a href="dictionary_D.html#27276">declarationId</a>, <a href="dictionary_V.html#27277">varnames</a>, <a href="dictionary_T.html#27275">total_size</a> / <a href="dictionary_S.html#27273">size</a>, <a href="dictionary_S.html#27273">size</a>);</span>
<a name="731"><font size=-1>731     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; <a href="dictionary_C.html#27306">callstack</a>;</span>
<a name="732"><font size=-1>732     </font></a><span class="default">                <a href="dictionary_C.html#1822">checkFunctionCall</a>(<a href="dictionary_T.html#27270">tok</a>, <a href="dictionary_A.html#27305">arrayInfo1</a>, <a href="dictionary_C.html#27306">callstack</a>);</span>
<a name="733"><font size=-1>733     </font></a><span class="default">            }</span>
<a name="734"><font size=-1>734     </font></a><span class="default">        }</span>
<a name="735"><font size=-1>735     </font></a><span class="default"></span>
<a name="736"><font size=-1>736     </font></a><span class="default">        </span><span class="comment">// undefined behaviour: result of pointer arithmetic is out of bounds</span>
<a name="737"><font size=-1>737     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#27276">declarationId</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;= %varid% + %num% ;&quot;</span><span class="default">, <a href="dictionary_D.html#27276">declarationId</a>)) {</span>
<a name="738"><font size=-1>738     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_I.html#27307">index</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">3</span><span class="default">));</span>
<a name="739"><font size=-1>739     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27282">printPortability</a> &amp;&amp; <a href="dictionary_I.html#27307">index</a> &gt; <a href="dictionary_S.html#27273">size</a>)</span>
<a name="740"><font size=-1>740     </font></a><span class="default">                <a href="dictionary_C.html#1852">pointerOutOfBoundsError</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">));</span>
<a name="741"><font size=-1>741     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27307">index</a> &gt;= <a href="dictionary_S.html#27273">size</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(-</span><span class="number">2</span><span class="default">), </span><span class="string">&quot;[;{}] %varid% =&quot;</span><span class="default">, <a href="dictionary_D.html#27276">declarationId</a>))</span>
<a name="742"><font size=-1>742     </font></a><span class="default">                <a href="dictionary_P.html#27281">pointerIsOutOfBounds</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="743"><font size=-1>743     </font></a><span class="default">        }</span>
<a name="744"><font size=-1>744     </font></a><span class="default"></span>
<a name="745"><font size=-1>745     </font></a><span class="default">        </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_P.html#27281">pointerIsOutOfBounds</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27270">tok</a>, </span><span class="string">&quot;[;{}=] * %varid% [;=]&quot;</span><span class="default">, <a href="dictionary_D.html#27276">declarationId</a>)) {</span>
<a name="746"><font size=-1>746     </font></a><span class="default">            <a href="dictionary_C.html#1843">outOfBoundsError</a>(<a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">), <a href="dictionary_T.html#27270">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">2</span><span class="default">), </span><span class="keyword">false</span><span class="default">, </span><span class="number">0</span><span class="default">, </span><span class="number">0</span><span class="default">);</span>
<a name="747"><font size=-1>747     </font></a><span class="default">        }</span>
<a name="748"><font size=-1>748     </font></a><span class="default">    }</span>
<a name="749"><font size=-1>749     </font></a><span class="default">}</span>
<a name="750"><font size=-1>750     </font></a><span class="default"></span>
<a name="751"><font size=-1>751     </font></a><span class="default"></span><span class="keyword">static <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;ValueFlow::Value&gt; <a href="dictionary_V.html#27308">valueFlowGetArrayIndexes</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_T.html#27309">tok</a></span><span class="default">, </span><span class="keyword">bool <a href="dictionary_C.html#27310">conditional</a></span><span class="default">, <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_D.html#27311">dimensions</a>)</span>
<a name="752"><font size=-1>752     </font></a><span class="default">{</span>
<a name="753"><font size=-1>753     </font></a><span class="default">    </span><span class="keyword">unsigned int <a href="dictionary_I.html#27312">indexvarid</a> </span><span class="default">= </span><span class="number">0</span><span class="default">;</span>
<a name="754"><font size=-1>754     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;ValueFlow::Value&gt; <a href="dictionary_E.html#27313">empty</a>;</span>
<a name="755"><font size=-1>755     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1095">vector</a>&lt;ValueFlow::Value&gt; <a href="dictionary_I.html#27314">indexes</a>;</span>
<a name="756"><font size=-1>756     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27315">tok2</a> = <a href="dictionary_T.html#27309">tok</a>; <a href="dictionary_I.html#27314">indexes</a>.<a href="dictionary_S.html#1203">size</a>() &lt; <a href="dictionary_D.html#27311">dimensions</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27315">tok2</a>, </span><span class="string">&quot;[&quot;</span><span class="default">); <a href="dictionary_T.html#27315">tok2</a> = <a href="dictionary_T.html#27315">tok2</a>-&gt;<a href="dictionary_T.html#1482">link</a>()-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="757"><font size=-1>757     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#27315">tok2</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>())</span>
<a name="758"><font size=-1>758     </font></a><span class="default">            </span><span class="keyword">return <a href="dictionary_E.html#27313">empty</a></span><span class="default">;</span>
<a name="759"><font size=-1>759     </font></a><span class="default"></span>
<a name="760"><font size=-1>760     </font></a><span class="default">        </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_I.html#27316">index</a> = <a href="dictionary_T.html#27315">tok2</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#22250">getMaxValue</a>(<a href="dictionary_C.html#27310">conditional</a>);</span>
<a name="761"><font size=-1>761     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_I.html#27316">index</a>)</span>
<a name="762"><font size=-1>762     </font></a><span class="default">            </span><span class="keyword">return <a href="dictionary_E.html#27313">empty</a></span><span class="default">;</span>
<a name="763"><font size=-1>763     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27312">indexvarid</a> == </span><span class="number">0U</span><span class="default">)</span>
<a name="764"><font size=-1>764     </font></a><span class="default">            <a href="dictionary_I.html#27312">indexvarid</a> = <a href="dictionary_I.html#27316">index</a>-&gt;<a href="dictionary_V.html#5811">varId</a>;</span>
<a name="765"><font size=-1>765     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27316">index</a>-&gt;<a href="dictionary_V.html#5811">varId</a> &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_I.html#27312">indexvarid</a> != <a href="dictionary_I.html#27316">index</a>-&gt;<a href="dictionary_V.html#5811">varId</a>)</span>
<a name="766"><font size=-1>766     </font></a><span class="default">            </span><span class="keyword">return <a href="dictionary_E.html#27313">empty</a></span><span class="default">;</span>
<a name="767"><font size=-1>767     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27316">index</a>-&gt;<a href="dictionary_V.html#5807">intvalue</a> &lt; </span><span class="number">0</span><span class="default">)</span>
<a name="768"><font size=-1>768     </font></a><span class="default">            </span><span class="keyword">return <a href="dictionary_E.html#27313">empty</a></span><span class="default">;</span>
<a name="769"><font size=-1>769     </font></a><span class="default">        <a href="dictionary_I.html#27314">indexes</a>.<a href="dictionary_P.html#1100">push_back</a>(*<a href="dictionary_I.html#27316">index</a>);</span>
<a name="770"><font size=-1>770     </font></a><span class="default">    }</span>
<a name="771"><font size=-1>771     </font></a><span class="default"></span>
<a name="772"><font size=-1>772     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_I.html#27314">indexes</a></span><span class="default">;</span>
<a name="773"><font size=-1>773     </font></a><span class="default">}</span>
<a name="774"><font size=-1>774     </font></a><span class="default"></span>
<a name="775"><font size=-1>775     </font></a><span class="default"></span>
<a name="776"><font size=-1>776     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1856">valueFlowCheckArrayIndex</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_T.html#27317">tok</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> </span><span class="default">&amp;<a href="dictionary_A.html#27318">arrayInfo</a>)</span>
<a name="777"><font size=-1>777     </font></a><span class="default">{</span>
<a name="778"><font size=-1>778     </font></a><span class="default">    </span><span class="comment">// Declaration in global scope or namespace?</span>
<a name="779"><font size=-1>779     </font></a><span class="comment">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27317">tok</a>-&gt;<a href="dictionary_T.html#1928">scope</a>()-&gt;<a href="dictionary_T.html#1963">type</a> == <a href="dictionary_S.html#606">Scope</a>::eGlobal || <a href="dictionary_T.html#27317">tok</a>-&gt;<a href="dictionary_T.html#1928">scope</a>()-&gt;<a href="dictionary_T.html#1963">type</a> == <a href="dictionary_S.html#606">Scope</a>::eNamespace)</span>
<a name="780"><font size=-1>780     </font></a><span class="default">        </span><span class="keyword">return</span><span class="default">;</span>
<a name="781"><font size=-1>781     </font></a><span class="default">    </span><span class="comment">/*</span>
<a name="782"><font size=-1>782     </font></a><span class="comment">         {</span>
<a name="783"><font size=-1>783     </font></a><span class="comment">            const Token *parent = tok-&gt;astParent();</span>
<a name="784"><font size=-1>784     </font></a><span class="comment">            while (Token::Match(parent, &quot;%name%|::|*|&amp;&quot;))</span>
<a name="785"><font size=-1>785     </font></a><span class="comment">                parent = parent-&gt;astParent();</span>
<a name="786"><font size=-1>786     </font></a><span class="comment">            if (parent &amp;&amp; !Token::simpleMatch(parent, &quot;=&quot;))</span>
<a name="787"><font size=-1>787     </font></a><span class="comment">                return;</span>
<a name="788"><font size=-1>788     </font></a><span class="comment">        }</span>
<a name="789"><font size=-1>789     </font></a><span class="comment">    */</span>
<a name="790"><font size=-1>790     </font></a><span class="comment">    </span><span class="keyword">const bool <a href="dictionary_P.html#27319">printInconclusive</a> </span><span class="default">= <a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#836">inconclusive</a>;</span>
<a name="791"><font size=-1>791     </font></a><span class="default">    </span><span class="comment">// Taking address?</span>
<a name="792"><font size=-1>792     </font></a><span class="comment">    </span><span class="keyword">const bool <a href="dictionary_A.html#27320">addressOf</a> </span><span class="default">= <a href="dictionary_I.html#27215">isAddressOf</a>(<a href="dictionary_T.html#27317">tok</a>);</span>
<a name="793"><font size=-1>793     </font></a><span class="default"></span>
<a name="794"><font size=-1>794     </font></a><span class="default">    </span><span class="comment">// Look for errors first</span>
<a name="795"><font size=-1>795     </font></a><span class="comment">    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_W.html#27321">warn</a> </span><span class="default">= </span><span class="number">0</span><span class="default">; <a href="dictionary_W.html#27321">warn</a> == </span><span class="number">0 </span><span class="default">|| <a href="dictionary_W.html#27321">warn</a> == </span><span class="number">1</span><span class="default">; ++<a href="dictionary_W.html#27321">warn</a>) {</span>
<a name="796"><font size=-1>796     </font></a><span class="default">        </span><span class="comment">// Negative index..</span>
<a name="797"><font size=-1>797     </font></a><span class="comment">        </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27322">tok2</a> = <a href="dictionary_T.html#27317">tok</a>; <a href="dictionary_T.html#27322">tok2</a> &amp;&amp; <a href="dictionary_T.html#27322">tok2</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;[&quot;</span><span class="default">; <a href="dictionary_T.html#27322">tok2</a> = <a href="dictionary_T.html#27322">tok2</a>-&gt;<a href="dictionary_T.html#1482">link</a>()-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="798"><font size=-1>798     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_I.html#27323">index</a> = <a href="dictionary_T.html#27322">tok2</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>();</span>
<a name="799"><font size=-1>799     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_I.html#27323">index</a>)</span>
<a name="800"><font size=-1>800     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="801"><font size=-1>801     </font></a><span class="default">            </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_V.html#27324">value</a> = <a href="dictionary_I.html#27323">index</a>-&gt;<a href="dictionary_T.html#11408">getValueLE</a>(-</span><span class="number">1LL</span><span class="default">,<a href="dictionary_C.html#1875">_settings</a>);</span>
<a name="802"><font size=-1>802     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27324">value</a>)</span>
<a name="803"><font size=-1>803     </font></a><span class="default">                <a href="dictionary_C.html#1847">negativeIndexError</a>(<a href="dictionary_I.html#27323">index</a>, *<a href="dictionary_V.html#27324">value</a>);</span>
<a name="804"><font size=-1>804     </font></a><span class="default">        }</span>
<a name="805"><font size=-1>805     </font></a><span class="default"></span>
<a name="806"><font size=-1>806     </font></a><span class="default">        </span><span class="comment">// Index out of bounds..</span>
<a name="807"><font size=-1>807     </font></a><span class="comment">        </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;ValueFlow::Value&gt; <a href="dictionary_I.html#27325">indexes</a>(<a href="dictionary_V.html#27308">valueFlowGetArrayIndexes</a>(<a href="dictionary_T.html#27317">tok</a>, <a href="dictionary_W.html#27321">warn</a>==</span><span class="number">1</span><span class="default">, <a href="dictionary_A.html#27318">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>()));</span>
<a name="808"><font size=-1>808     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27325">indexes</a>.<a href="dictionary_S.html#1203">size</a>() != <a href="dictionary_A.html#27318">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>().<a href="dictionary_S.html#1203">size</a>())</span>
<a name="809"><font size=-1>809     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="810"><font size=-1>810     </font></a><span class="default"></span>
<a name="811"><font size=-1>811     </font></a><span class="default">        </span><span class="comment">// Check if the indexes point outside the whole array..</span>
<a name="812"><font size=-1>812     </font></a><span class="comment">        // char a[10][10];</span>
<a name="813"><font size=-1>813     </font></a><span class="comment">        // a[0][20]  &lt;-- ok.</span>
<a name="814"><font size=-1>814     </font></a><span class="comment">        // a[9][20]  &lt;-- error.</span>
<a name="815"><font size=-1>815     </font></a><span class="comment"></span>
<a name="816"><font size=-1>816     </font></a><span class="comment">        // total number of elements of array..</span>
<a name="817"><font size=-1>817     </font></a><span class="comment">        </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_T.html#27326">totalElements</a> = <a href="dictionary_A.html#27318">arrayInfo</a>.<a href="dictionary_C.html#1817">numberOfElements</a>();</span>
<a name="818"><font size=-1>818     </font></a><span class="default"></span>
<a name="819"><font size=-1>819     </font></a><span class="default">        </span><span class="comment">// total index..</span>
<a name="820"><font size=-1>820     </font></a><span class="comment">        </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_T.html#27327">totalIndex</a> = <a href="dictionary_A.html#27318">arrayInfo</a>.<a href="dictionary_C.html#1818">totalIndex</a>(<a href="dictionary_I.html#27325">indexes</a>);</span>
<a name="821"><font size=-1>821     </font></a><span class="default"></span>
<a name="822"><font size=-1>822     </font></a><span class="default">        </span><span class="comment">// totalElements &lt;= 0 =&gt; Unknown size</span>
<a name="823"><font size=-1>823     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27326">totalElements</a> &lt;= </span><span class="number">0</span><span class="default">)</span>
<a name="824"><font size=-1>824     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="825"><font size=-1>825     </font></a><span class="default"></span>
<a name="826"><font size=-1>826     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27320">addressOf</a> &amp;&amp; <a href="dictionary_T.html#27327">totalIndex</a> == <a href="dictionary_T.html#27326">totalElements</a>)</span>
<a name="827"><font size=-1>827     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="828"><font size=-1>828     </font></a><span class="default"></span>
<a name="829"><font size=-1>829     </font></a><span class="default">        </span><span class="comment">// Is totalIndex in bounds?</span>
<a name="830"><font size=-1>830     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27327">totalIndex</a> &gt;= <a href="dictionary_T.html#27326">totalElements</a>) {</span>
<a name="831"><font size=-1>831     </font></a><span class="default">            <a href="dictionary_C.html#825">arrayIndexOutOfBoundsError</a>(<a href="dictionary_T.html#27317">tok</a>, <a href="dictionary_A.html#27318">arrayInfo</a>, <a href="dictionary_I.html#27325">indexes</a>);</span>
<a name="832"><font size=-1>832     </font></a><span class="default">            </span><span class="keyword">break</span><span class="default">;</span>
<a name="833"><font size=-1>833     </font></a><span class="default">        }</span>
<a name="834"><font size=-1>834     </font></a><span class="default"></span>
<a name="835"><font size=-1>835     </font></a><span class="default">        </span><span class="comment">// Is any array index out of bounds?</span>
<a name="836"><font size=-1>836     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27319">printInconclusive</a>) {</span>
<a name="837"><font size=-1>837     </font></a><span class="default">            </span><span class="comment">// check each index for overflow</span>
<a name="838"><font size=-1>838     </font></a><span class="comment">            </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27328">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27328">i</a> &lt; <a href="dictionary_I.html#27325">indexes</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27328">i</a>) {</span>
<a name="839"><font size=-1>839     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27325">indexes</a>[<a href="dictionary_I.html#27328">i</a>].<a href="dictionary_I.html#6658">intvalue</a> &gt;= <a href="dictionary_A.html#27318">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(<a href="dictionary_I.html#27328">i</a>)) {</span>
<a name="840"><font size=-1>840     </font></a><span class="default">                    </span><span class="comment">// The access is still within the memory range for the array</span>
<a name="841"><font size=-1>841     </font></a><span class="comment">                    // so it may be intentional.</span>
<a name="842"><font size=-1>842     </font></a><span class="comment">                    <a href="dictionary_C.html#825">arrayIndexOutOfBoundsError</a></span><span class="default">(<a href="dictionary_T.html#27317">tok</a>, <a href="dictionary_A.html#27318">arrayInfo</a>, <a href="dictionary_I.html#27325">indexes</a>);</span>
<a name="843"><font size=-1>843     </font></a><span class="default">                    </span><span class="keyword">break</span><span class="default">; </span><span class="comment">// only warn about the first one</span>
<a name="844"><font size=-1>844     </font></a><span class="comment">                </span><span class="default">}</span>
<a name="845"><font size=-1>845     </font></a><span class="default">            }</span>
<a name="846"><font size=-1>846     </font></a><span class="default">        }</span>
<a name="847"><font size=-1>847     </font></a><span class="default">    }</span>
<a name="848"><font size=-1>848     </font></a><span class="default">}</span>
<a name="849"><font size=-1>849     </font></a><span class="default"></span>
<a name="850"><font size=-1>850     </font></a><span class="default"></span>
<a name="851"><font size=-1>851     </font></a><span class="default"></span>
<a name="852"><font size=-1>852     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1819">checkScope</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27329">tok</a>, </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> </span><span class="default">&amp;<a href="dictionary_A.html#27330">arrayInfo</a>)</span>
<a name="853"><font size=-1>853     </font></a><span class="default">{</span>
<a name="854"><font size=-1>854     </font></a><span class="default">    <a href="dictionary_A.html#8526">assert</a>(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1421">previous</a>() != <a href="dictionary_N.html#1132">nullptr</a>);</span>
<a name="855"><font size=-1>855     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#257">biguint</a> <a href="dictionary_T.html#27331">total_size</a> = <a href="dictionary_A.html#27330">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(</span><span class="number">0</span><span class="default">) * <a href="dictionary_A.html#27330">arrayInfo</a>.<a href="dictionary_C.html#1810">element_size</a>();</span>
<a name="856"><font size=-1>856     </font></a><span class="default"></span>
<a name="857"><font size=-1>857     </font></a><span class="default">    </span><span class="keyword">const unsigned int <a href="dictionary_D.html#27332">declarationId</a> </span><span class="default">= <a href="dictionary_A.html#27330">arrayInfo</a>.<a href="dictionary_C.html#1811">declarationId</a>();</span>
<a name="858"><font size=-1>858     </font></a><span class="default"></span>
<a name="859"><font size=-1>859     </font></a><span class="default">    </span><span class="keyword">const bool <a href="dictionary_P.html#27333">printPortability</a> </span><span class="default">= <a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1876">isEnabled</a>(</span><span class="string">&quot;portability&quot;</span><span class="default">);</span>
<a name="860"><font size=-1>860     </font></a><span class="default">    </span><span class="keyword">const bool <a href="dictionary_P.html#27334">printWarning</a> </span><span class="default">= <a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1876">isEnabled</a>(</span><span class="string">&quot;warning&quot;</span><span class="default">);</span>
<a name="861"><font size=-1>861     </font></a><span class="default">    </span><span class="keyword">const bool <a href="dictionary_P.html#27335">printInconclusive</a> </span><span class="default">= <a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#836">inconclusive</a>;</span>
<a name="862"><font size=-1>862     </font></a><span class="default"></span>
<a name="863"><font size=-1>863     </font></a><span class="default">    </span><span class="keyword">bool <a href="dictionary_R.html#27336">reassigned</a> </span><span class="default">= </span><span class="keyword">false</span><span class="default">;</span>
<a name="864"><font size=-1>864     </font></a><span class="default"></span>
<a name="865"><font size=-1>865     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_E.html#27337">end</a> </span><span class="default">= <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1928">scope</a>()-&gt;<a href="dictionary_T.html#1930">classEnd</a>; <a href="dictionary_T.html#27329">tok</a> != <a href="dictionary_E.html#27337">end</a>; <a href="dictionary_T.html#27329">tok</a> = <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="866"><font size=-1>866     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_R.html#27336">reassigned</a> &amp;&amp; <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;;&quot;</span><span class="default">)</span>
<a name="867"><font size=-1>867     </font></a><span class="default">            </span><span class="keyword">break</span><span class="default">;</span>
<a name="868"><font size=-1>868     </font></a><span class="default"></span>
<a name="869"><font size=-1>869     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>() == <a href="dictionary_D.html#27332">declarationId</a>) {</span>
<a name="870"><font size=-1>870     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">1</span><span class="default">) == </span><span class="string">&quot;=&quot;</span><span class="default">) {</span>
<a name="871"><font size=-1>871     </font></a><span class="default">                <a href="dictionary_R.html#27336">reassigned</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="872"><font size=-1>872     </font></a><span class="default">            }</span>
<a name="873"><font size=-1>873     </font></a><span class="default"></span>
<a name="874"><font size=-1>874     </font></a><span class="default">            </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">1</span><span class="default">) == </span><span class="string">&quot;[&quot;</span><span class="default">) {</span>
<a name="875"><font size=-1>875     </font></a><span class="default">                <a href="dictionary_C.html#1856">valueFlowCheckArrayIndex</a>(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), <a href="dictionary_A.html#27330">arrayInfo</a>);</span>
<a name="876"><font size=-1>876     </font></a><span class="default">            }</span>
<a name="877"><font size=-1>877     </font></a><span class="default"></span>
<a name="878"><font size=-1>878     </font></a><span class="default">            </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_P.html#27333">printPortability</a> &amp;&amp; !<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#9115">isCast</a>() &amp;&amp; <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>() &amp;&amp; <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>()-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;+&quot;</span><span class="default">) {</span>
<a name="879"><font size=-1>879     </font></a><span class="default">                </span><span class="comment">// undefined behaviour: result of pointer arithmetic is out of bounds</span>
<a name="880"><font size=-1>880     </font></a><span class="comment">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_I.html#27338">index</a>;</span>
<a name="881"><font size=-1>881     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27329">tok</a> == <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>()-&gt;<a href="dictionary_T.html#1428">astOperand1</a>())</span>
<a name="882"><font size=-1>882     </font></a><span class="default">                    <a href="dictionary_I.html#27338">index</a> = <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>();</span>
<a name="883"><font size=-1>883     </font></a><span class="default">                </span><span class="keyword">else</span>
<a name="884"><font size=-1>884     </font></a><span class="keyword">                    <a href="dictionary_I.html#27338">index</a> </span><span class="default">= <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>()-&gt;<a href="dictionary_T.html#1428">astOperand1</a>();</span>
<a name="885"><font size=-1>885     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27338">index</a>) {</span>
<a name="886"><font size=-1>886     </font></a><span class="default">                    </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_V.html#27339">value</a> = <a href="dictionary_I.html#27338">index</a>-&gt;<a href="dictionary_T.html#11394">getValueGE</a>(<a href="dictionary_A.html#27330">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(</span><span class="number">0</span><span class="default">) + </span><span class="number">1U</span><span class="default">, <a href="dictionary_C.html#1875">_settings</a>);</span>
<a name="887"><font size=-1>887     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_V.html#27339">value</a>)</span>
<a name="888"><font size=-1>888     </font></a><span class="default">                        <a href="dictionary_V.html#27339">value</a> = <a href="dictionary_I.html#27338">index</a>-&gt;<a href="dictionary_T.html#11408">getValueLE</a>(-</span><span class="number">1</span><span class="default">, <a href="dictionary_C.html#1875">_settings</a>);</span>
<a name="889"><font size=-1>889     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27339">value</a>)</span>
<a name="890"><font size=-1>890     </font></a><span class="default">                        <a href="dictionary_C.html#1852">pointerOutOfBoundsError</a>(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>(), <a href="dictionary_I.html#27338">index</a>, <a href="dictionary_V.html#27339">value</a>-&gt;<a href="dictionary_V.html#5807">intvalue</a>);</span>
<a name="891"><font size=-1>891     </font></a><span class="default">                }</span>
<a name="892"><font size=-1>892     </font></a><span class="default">            }</span>
<a name="893"><font size=-1>893     </font></a><span class="default"></span>
<a name="894"><font size=-1>894     </font></a><span class="default">            </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_P.html#27333">printPortability</a> &amp;&amp; <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>() &amp;&amp; <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>()-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;-&quot;</span><span class="default">) {</span>
<a name="895"><font size=-1>895     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">*<a href="dictionary_V.html#27340">var</a> = <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>()-&gt;<a href="dictionary_S.html#5047">getVariableFromVarId</a>(<a href="dictionary_D.html#27332">declarationId</a>);</span>
<a name="896"><font size=-1>896     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27340">var</a> &amp;&amp; <a href="dictionary_V.html#27340">var</a>-&gt;<a href="dictionary_V.html#2645">isArray</a>()) {</span>
<a name="897"><font size=-1>897     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_I.html#27341">index</a> = <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>();</span>
<a name="898"><font size=-1>898     </font></a><span class="default">                    </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_V.html#27342">value</a> = <a href="dictionary_I.html#27341">index</a> ? <a href="dictionary_I.html#27341">index</a>-&gt;<a href="dictionary_T.html#11394">getValueGE</a>(</span><span class="number">1</span><span class="default">,<a href="dictionary_C.html#1875">_settings</a>) : <a href="dictionary_N.html#1132">nullptr</a>;</span>
<a name="899"><font size=-1>899     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27341">index</a> &amp;&amp; !<a href="dictionary_V.html#27342">value</a>)</span>
<a name="900"><font size=-1>900     </font></a><span class="default">                        <a href="dictionary_V.html#27342">value</a> = <a href="dictionary_I.html#27341">index</a>-&gt;<a href="dictionary_T.html#11408">getValueLE</a>(-</span><span class="number">1 </span><span class="default">- <a href="dictionary_A.html#27330">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(</span><span class="number">0</span><span class="default">), <a href="dictionary_C.html#1875">_settings</a>);</span>
<a name="901"><font size=-1>901     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27342">value</a>)</span>
<a name="902"><font size=-1>902     </font></a><span class="default">                        <a href="dictionary_C.html#1852">pointerOutOfBoundsError</a>(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>(), <a href="dictionary_I.html#27341">index</a>, <a href="dictionary_V.html#27342">value</a>-&gt;<a href="dictionary_V.html#5807">intvalue</a>);</span>
<a name="903"><font size=-1>903     </font></a><span class="default">                }</span>
<a name="904"><font size=-1>904     </font></a><span class="default">            }</span>
<a name="905"><font size=-1>905     </font></a><span class="default">        }</span>
<a name="906"><font size=-1>906     </font></a><span class="default"></span>
<a name="907"><font size=-1>907     </font></a><span class="default">        </span><span class="keyword">else if </span><span class="default">(!<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1928">scope</a>()-&gt;<a href="dictionary_T.html#1929">isExecutable</a>()) </span><span class="comment">// No executable code outside of executable scope - continue to increase performance</span>
<a name="908"><font size=-1>908     </font></a><span class="comment">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="909"><font size=-1>909     </font></a><span class="default"></span>
<a name="910"><font size=-1>910     </font></a><span class="default">        </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27329">tok</a>, </span><span class="string">&quot;%name% (&quot;</span><span class="default">)) {</span>
<a name="911"><font size=-1>911     </font></a><span class="default">            </span><span class="comment">// Check function call..</span>
<a name="912"><font size=-1>912     </font></a><span class="comment">            <a href="dictionary_C.html#1822">checkFunctionCall</a></span><span class="default">(<a href="dictionary_T.html#27329">tok</a>, <a href="dictionary_A.html#27330">arrayInfo</a>, <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">*&gt;());</span>
<a name="913"><font size=-1>913     </font></a><span class="default"></span>
<a name="914"><font size=-1>914     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27334">printWarning</a> &amp;&amp; <a href="dictionary_P.html#27335">printInconclusive</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27329">tok</a>, </span><span class="string">&quot;strncpy|memcpy|memmove ( %varid% , %str% , %num% )&quot;</span><span class="default">, <a href="dictionary_D.html#27332">declarationId</a>)) {</span>
<a name="915"><font size=-1>915     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#2940">getStrLength</a>(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">4</span><span class="default">)) &gt;= <a href="dictionary_T.html#27331">total_size</a>) {</span>
<a name="916"><font size=-1>916     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#257">biguint</a> <a href="dictionary_N.html#27343">num</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#256">toULongNumber</a>(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">6</span><span class="default">));</span>
<a name="917"><font size=-1>917     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27331">total_size</a> == <a href="dictionary_N.html#27343">num</a>)</span>
<a name="918"><font size=-1>918     </font></a><span class="default">                        <a href="dictionary_C.html#1846">bufferNotZeroTerminatedError</a>(<a href="dictionary_T.html#27329">tok</a>, <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">2</span><span class="default">), <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="919"><font size=-1>919     </font></a><span class="default">                }</span>
<a name="920"><font size=-1>920     </font></a><span class="default">            }</span>
<a name="921"><font size=-1>921     </font></a><span class="default"></span>
<a name="922"><font size=-1>922     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27334">printWarning</a> &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27329">tok</a>, </span><span class="string">&quot;strncpy|strncat ( %varid% ,&quot;</span><span class="default">, <a href="dictionary_D.html#27332">declarationId</a>) &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">)-&gt;<a href="dictionary_T.html#1437">tokAt</a>(-</span><span class="number">2</span><span class="default">), </span><span class="string">&quot;, %num% )&quot;</span><span class="default">)) {</span>
<a name="923"><font size=-1>923     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* <a href="dictionary_P.html#27344">param3</a> = <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">)-&gt;<a href="dictionary_T.html#1421">previous</a>();</span>
<a name="924"><font size=-1>924     </font></a><span class="default"></span>
<a name="925"><font size=-1>925     </font></a><span class="default">                </span><span class="comment">// check for strncpy which is not terminated</span>
<a name="926"><font size=-1>926     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;strncpy&quot;</span><span class="default">) {</span>
<a name="927"><font size=-1>927     </font></a><span class="default">                    </span><span class="comment">// strncpy takes entire variable length as input size</span>
<a name="928"><font size=-1>928     </font></a><span class="comment">                    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#257">biguint</a> <a href="dictionary_N.html#27345">num</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#256">toULongNumber</a>(<a href="dictionary_P.html#27344">param3</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="929"><font size=-1>929     </font></a><span class="default"></span>
<a name="930"><font size=-1>930     </font></a><span class="default">                    </span><span class="comment">// this is currently 'inconclusive'. See TestBufferOverrun::terminateStrncpy3</span>
<a name="931"><font size=-1>931     </font></a><span class="comment">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27335">printInconclusive</a> &amp;&amp; <a href="dictionary_N.html#27345">num</a> &gt;= <a href="dictionary_T.html#27331">total_size</a>) {</span>
<a name="932"><font size=-1>932     </font></a><span class="default">                        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27346">tok2</a> = <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1482">link</a>()-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="933"><font size=-1>933     </font></a><span class="default">                        </span><span class="keyword">for </span><span class="default">(; <a href="dictionary_T.html#27346">tok2</a>; <a href="dictionary_T.html#27346">tok2</a> = <a href="dictionary_T.html#27346">tok2</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="934"><font size=-1>934     </font></a><span class="default">                            </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* <a href="dictionary_T.html#27347">tok3</a> = <a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="935"><font size=-1>935     </font></a><span class="default">                            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27346">tok2</a>-&gt;<a href="dictionary_T.html#1481">varId</a>() == <a href="dictionary_T.html#27347">tok3</a>-&gt;<a href="dictionary_T.html#1481">varId</a>()) {</span>
<a name="936"><font size=-1>936     </font></a><span class="default">                                </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27346">tok2</a>, </span><span class="string">&quot;%varid% [ %any% ] = 0 ;&quot;</span><span class="default">, <a href="dictionary_T.html#27347">tok3</a>-&gt;<a href="dictionary_T.html#1481">varId</a>())) {</span>
<a name="937"><font size=-1>937     </font></a><span class="default">                                    <a href="dictionary_C.html#1845">terminateStrncpyError</a>(<a href="dictionary_T.html#27329">tok</a>, <a href="dictionary_T.html#27347">tok3</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="938"><font size=-1>938     </font></a><span class="default">                                }</span>
<a name="939"><font size=-1>939     </font></a><span class="default"></span>
<a name="940"><font size=-1>940     </font></a><span class="default">                                </span><span class="keyword">break</span><span class="default">;</span>
<a name="941"><font size=-1>941     </font></a><span class="default">                            }</span>
<a name="942"><font size=-1>942     </font></a><span class="default">                        }</span>
<a name="943"><font size=-1>943     </font></a><span class="default">                    }</span>
<a name="944"><font size=-1>944     </font></a><span class="default">                }</span>
<a name="945"><font size=-1>945     </font></a><span class="default"></span>
<a name="946"><font size=-1>946     </font></a><span class="default">                </span><span class="comment">// Dangerous usage of strncat..</span>
<a name="947"><font size=-1>947     </font></a><span class="comment">                </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;strncat&quot;</span><span class="default">) {</span>
<a name="948"><font size=-1>948     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#257">biguint</a> <a href="dictionary_N.html#27348">n</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#256">toULongNumber</a>(<a href="dictionary_P.html#27344">param3</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="949"><font size=-1>949     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#27348">n</a> &gt;= <a href="dictionary_T.html#27331">total_size</a>)</span>
<a name="950"><font size=-1>950     </font></a><span class="default">                        <a href="dictionary_C.html#1840">strncatUsageError</a>(<a href="dictionary_T.html#27329">tok</a>);</span>
<a name="951"><font size=-1>951     </font></a><span class="default">                }</span>
<a name="952"><font size=-1>952     </font></a><span class="default"></span>
<a name="953"><font size=-1>953     </font></a><span class="default">                </span><span class="comment">// Dangerous usage of strncpy + strncat..</span>
<a name="954"><font size=-1>954     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_P.html#27344">param3</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">), </span><span class="string">&quot;; strncat ( %varid% ,&quot;</span><span class="default">, <a href="dictionary_D.html#27332">declarationId</a>) &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_P.html#27344">param3</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">4</span><span class="default">)-&gt;<a href="dictionary_T.html#1437">tokAt</a>(-</span><span class="number">2</span><span class="default">), </span><span class="string">&quot;, %num% )&quot;</span><span class="default">)) {</span>
<a name="955"><font size=-1>955     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#257">biguint</a> <a href="dictionary_N.html#27349">n</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#256">toULongNumber</a>(<a href="dictionary_P.html#27344">param3</a>-&gt;<a href="dictionary_T.html#1416">str</a>()) + <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#256">toULongNumber</a>(<a href="dictionary_P.html#27344">param3</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">4</span><span class="default">)-&gt;<a href="dictionary_T.html#1417">strAt</a>(-</span><span class="number">1</span><span class="default">));</span>
<a name="956"><font size=-1>956     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_N.html#27349">n</a> &gt; <a href="dictionary_T.html#27331">total_size</a>)</span>
<a name="957"><font size=-1>957     </font></a><span class="default">                        <a href="dictionary_C.html#1840">strncatUsageError</a>(<a href="dictionary_P.html#27344">param3</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">3</span><span class="default">));</span>
<a name="958"><font size=-1>958     </font></a><span class="default">                }</span>
<a name="959"><font size=-1>959     </font></a><span class="default">            }</span>
<a name="960"><font size=-1>960     </font></a><span class="default"></span>
<a name="961"><font size=-1>961     </font></a><span class="default">            </span><span class="comment">// Writing data into array..</span>
<a name="962"><font size=-1>962     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27331">total_size</a> &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27329">tok</a>, </span><span class="string">&quot;strcpy|strcat ( %varid% , %str% )&quot;</span><span class="default">, <a href="dictionary_D.html#27332">declarationId</a>)) {</span>
<a name="963"><font size=-1>963     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_L.html#27350">len</a> = <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#2940">getStrLength</a>(<a href="dictionary_T.html#27329">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">4</span><span class="default">));</span>
<a name="964"><font size=-1>964     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_L.html#27350">len</a> &gt;= <a href="dictionary_T.html#27331">total_size</a>) {</span>
<a name="965"><font size=-1>965     </font></a><span class="default">                    <a href="dictionary_C.html#1838">bufferOverrunError</a>(<a href="dictionary_T.html#27329">tok</a>, <a href="dictionary_A.html#27330">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>());</span>
<a name="966"><font size=-1>966     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="967"><font size=-1>967     </font></a><span class="default">                }</span>
<a name="968"><font size=-1>968     </font></a><span class="default">            }</span>
<a name="969"><font size=-1>969     </font></a><span class="default"></span>
<a name="970"><font size=-1>970     </font></a><span class="default">            </span><span class="comment">// Detect few strcat() calls</span>
<a name="971"><font size=-1>971     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27331">total_size</a> &gt; </span><span class="number">0</span><span class="default">) {</span>
<a name="972"><font size=-1>972     </font></a><span class="default">                <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#257">biguint</a> <a href="dictionary_C.html#27351">charactersAppend</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="973"><font size=-1>973     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27352">tok2</a> = <a href="dictionary_T.html#27329">tok</a>;</span>
<a name="974"><font size=-1>974     </font></a><span class="default"></span>
<a name="975"><font size=-1>975     </font></a><span class="default">                </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27352">tok2</a>, </span><span class="string">&quot;strcat ( %varid% , %str% ) ;&quot;</span><span class="default">, <a href="dictionary_D.html#27332">declarationId</a>)) {</span>
<a name="976"><font size=-1>976     </font></a><span class="default">                    <a href="dictionary_C.html#27351">charactersAppend</a> += <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#2940">getStrLength</a>(<a href="dictionary_T.html#27352">tok2</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">4</span><span class="default">));</span>
<a name="977"><font size=-1>977     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27351">charactersAppend</a> &gt;= <a href="dictionary_T.html#27331">total_size</a>) {</span>
<a name="978"><font size=-1>978     </font></a><span class="default">                        <a href="dictionary_C.html#1838">bufferOverrunError</a>(<a href="dictionary_T.html#27352">tok2</a>, <a href="dictionary_A.html#27330">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>());</span>
<a name="979"><font size=-1>979     </font></a><span class="default">                        </span><span class="keyword">break</span><span class="default">;</span>
<a name="980"><font size=-1>980     </font></a><span class="default">                    }</span>
<a name="981"><font size=-1>981     </font></a><span class="default">                    <a href="dictionary_T.html#27352">tok2</a> = <a href="dictionary_T.html#27352">tok2</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">7</span><span class="default">);</span>
<a name="982"><font size=-1>982     </font></a><span class="default">                }</span>
<a name="983"><font size=-1>983     </font></a><span class="default">            }</span>
<a name="984"><font size=-1>984     </font></a><span class="default">        }</span>
<a name="985"><font size=-1>985     </font></a><span class="default">    }</span>
<a name="986"><font size=-1>986     </font></a><span class="default">}</span>
<a name="987"><font size=-1>987     </font></a><span class="default"></span>
<a name="988"><font size=-1>988     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="989"><font size=-1>989     </font></a><span class="comment">// Negative size in array declarations</span>
<a name="990"><font size=-1>990     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="991"><font size=-1>991     </font></a><span class="comment"></span>
<a name="992"><font size=-1>992     </font></a><span class="comment"></span><span class="keyword">static bool <a href="dictionary_I.html#27353">isVLAIndex</a></span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_I.html#27354">index</a>)</span>
<a name="993"><font size=-1>993     </font></a><span class="default">{</span>
<a name="994"><font size=-1>994     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#5332">stack</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; <a href="dictionary_T.html#6858">tokens</a>;</span>
<a name="995"><font size=-1>995     </font></a><span class="default">    <a href="dictionary_T.html#6858">tokens</a>.<a href="dictionary_P.html#5334">push</a>(<a href="dictionary_I.html#27354">index</a>);</span>
<a name="996"><font size=-1>996     </font></a><span class="default">    </span><span class="keyword">while </span><span class="default">(!<a href="dictionary_T.html#6858">tokens</a>.<a href="dictionary_E.html#2016">empty</a>()) {</span>
<a name="997"><font size=-1>997     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27355">tok</a> = <a href="dictionary_T.html#6858">tokens</a>.<a href="dictionary_T.html#5360">top</a>();</span>
<a name="998"><font size=-1>998     </font></a><span class="default">        <a href="dictionary_T.html#6858">tokens</a>.<a href="dictionary_P.html#5345">pop</a>();</span>
<a name="999"><font size=-1>999     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#27355">tok</a>)</span>
<a name="1000"><font size=-1>1000     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1001"><font size=-1>1001     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27355">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>() != </span><span class="number">0U</span><span class="default">)</span>
<a name="1002"><font size=-1>1002     </font></a><span class="default">            </span><span class="keyword">return true</span><span class="default">;</span>
<a name="1003"><font size=-1>1003     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27355">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;?&quot;</span><span class="default">) {</span>
<a name="1004"><font size=-1>1004     </font></a><span class="default">            </span><span class="comment">// this is a VLA index if both expressions around the &quot;:&quot; is VLA index</span>
<a name="1005"><font size=-1>1005     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27355">tok</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>() &amp;&amp;</span>
<a name="1006"><font size=-1>1006     </font></a><span class="default">                <a href="dictionary_T.html#27355">tok</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;:&quot; </span><span class="default">&amp;&amp;</span>
<a name="1007"><font size=-1>1007     </font></a><span class="default">                <a href="dictionary_I.html#27353">isVLAIndex</a>(<a href="dictionary_T.html#27355">tok</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#1428">astOperand1</a>()) &amp;&amp;</span>
<a name="1008"><font size=-1>1008     </font></a><span class="default">                <a href="dictionary_I.html#27353">isVLAIndex</a>(<a href="dictionary_T.html#27355">tok</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()))</span>
<a name="1009"><font size=-1>1009     </font></a><span class="default">                </span><span class="keyword">return true</span><span class="default">;</span>
<a name="1010"><font size=-1>1010     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1011"><font size=-1>1011     </font></a><span class="default">        }</span>
<a name="1012"><font size=-1>1012     </font></a><span class="default">        <a href="dictionary_T.html#6858">tokens</a>.<a href="dictionary_P.html#5334">push</a>(<a href="dictionary_T.html#27355">tok</a>-&gt;<a href="dictionary_T.html#1428">astOperand1</a>());</span>
<a name="1013"><font size=-1>1013     </font></a><span class="default">        <a href="dictionary_T.html#6858">tokens</a>.<a href="dictionary_P.html#5334">push</a>(<a href="dictionary_T.html#27355">tok</a>-&gt;<a href="dictionary_T.html#1427">astOperand2</a>());</span>
<a name="1014"><font size=-1>1014     </font></a><span class="default">    }</span>
<a name="1015"><font size=-1>1015     </font></a><span class="default">    </span><span class="keyword">return false</span><span class="default">;</span>
<a name="1016"><font size=-1>1016     </font></a><span class="default">}</span>
<a name="1017"><font size=-1>1017     </font></a><span class="default"></span>
<a name="1018"><font size=-1>1018     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1788">negativeArraySize</a>()</span>
<a name="1019"><font size=-1>1019     </font></a><span class="default">{</span>
<a name="1020"><font size=-1>1020     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#1883">SymbolDatabase</a></span><span class="default">* <a href="dictionary_S.html#27356">symbolDatabase</a> = <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>();</span>
<a name="1021"><font size=-1>1021     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">unsigned int <a href="dictionary_I.html#27357">i</a> </span><span class="default">= </span><span class="number">1</span><span class="default">; <a href="dictionary_I.html#27357">i</a> &lt;= <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#7875">varIdCount</a>(); <a href="dictionary_I.html#27357">i</a>++) {</span>
<a name="1022"><font size=-1>1022     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_V.html#27358">var</a> </span><span class="default">= <a href="dictionary_S.html#27356">symbolDatabase</a>-&gt;<a href="dictionary_S.html#5047">getVariableFromVarId</a>(<a href="dictionary_I.html#27357">i</a>);</span>
<a name="1023"><font size=-1>1023     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_V.html#27358">var</a> || !<a href="dictionary_V.html#27358">var</a>-&gt;<a href="dictionary_V.html#2645">isArray</a>())</span>
<a name="1024"><font size=-1>1024     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1025"><font size=-1>1025     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_N.html#27359">nameToken</a> </span><span class="default">= <a href="dictionary_V.html#27358">var</a>-&gt;<a href="dictionary_V.html#2646">nameToken</a>();</span>
<a name="1026"><font size=-1>1026     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_N.html#27359">nameToken</a>, </span><span class="string">&quot;%var% [&quot;</span><span class="default">) || !<a href="dictionary_N.html#27359">nameToken</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>())</span>
<a name="1027"><font size=-1>1027     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1028"><font size=-1>1028     </font></a><span class="default">        </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_S.html#27360">sz</a> = <a href="dictionary_N.html#27359">nameToken</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#11408">getValueLE</a>(-</span><span class="number">1</span><span class="default">,<a href="dictionary_C.html#1875">_settings</a>);</span>
<a name="1029"><font size=-1>1029     </font></a><span class="default">        </span><span class="comment">// don't warn about constant negative index because that is a compiler error</span>
<a name="1030"><font size=-1>1030     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27360">sz</a> &amp;&amp; <a href="dictionary_I.html#27353">isVLAIndex</a>(<a href="dictionary_N.html#27359">nameToken</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()))</span>
<a name="1031"><font size=-1>1031     </font></a><span class="default">            <a href="dictionary_C.html#1842">negativeArraySizeError</a>(<a href="dictionary_N.html#27359">nameToken</a>);</span>
<a name="1032"><font size=-1>1032     </font></a><span class="default">    }</span>
<a name="1033"><font size=-1>1033     </font></a><span class="default">}</span>
<a name="1034"><font size=-1>1034     </font></a><span class="default"></span>
<a name="1035"><font size=-1>1035     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1842">negativeArraySizeError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27361">tok</a>)</span>
<a name="1036"><font size=-1>1036     </font></a><span class="default">{</span>
<a name="1037"><font size=-1>1037     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27361">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;negativeArraySize&quot;</span><span class="default">,</span>
<a name="1038"><font size=-1>1038     </font></a><span class="default">                </span><span class="string">&quot;Declaration of array '&quot; </span><span class="default">+ (<a href="dictionary_T.html#27361">tok</a> ? <a href="dictionary_T.html#27361">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() : <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#147">string</a>()) + </span><span class="string">&quot;' with negative size is undefined behaviour&quot;</span><span class="default">);</span>
<a name="1039"><font size=-1>1039     </font></a><span class="default">}</span>
<a name="1040"><font size=-1>1040     </font></a><span class="default"></span>
<a name="1041"><font size=-1>1041     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1042"><font size=-1>1042     </font></a><span class="comment">// Checking member variables of structs.</span>
<a name="1043"><font size=-1>1043     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1044"><font size=-1>1044     </font></a><span class="comment"></span><span class="keyword">bool <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1836">isArrayOfStruct</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* <a href="dictionary_T.html#27362">tok</a>, </span><span class="keyword">int </span><span class="default">&amp;<a href="dictionary_P.html#27363">position</a>)</span>
<a name="1045"><font size=-1>1045     </font></a><span class="default">{</span>
<a name="1046"><font size=-1>1046     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27362">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), </span><span class="string">&quot;%name% [ %num% ]&quot;</span><span class="default">)) {</span>
<a name="1047"><font size=-1>1047     </font></a><span class="default">        <a href="dictionary_T.html#27362">tok</a> = <a href="dictionary_T.html#27362">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">4</span><span class="default">);</span>
<a name="1048"><font size=-1>1048     </font></a><span class="default">        </span><span class="keyword">int <a href="dictionary_I.html#27364">i</a> </span><span class="default">= </span><span class="number">1</span><span class="default">;</span>
<a name="1049"><font size=-1>1049     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(;;) {</span>
<a name="1050"><font size=-1>1050     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27362">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), </span><span class="string">&quot;[ %num% ]&quot;</span><span class="default">)) {</span>
<a name="1051"><font size=-1>1051     </font></a><span class="default">                <a href="dictionary_I.html#27364">i</a>++;</span>
<a name="1052"><font size=-1>1052     </font></a><span class="default">                <a href="dictionary_T.html#27362">tok</a> = <a href="dictionary_T.html#27362">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">4</span><span class="default">);</span>
<a name="1053"><font size=-1>1053     </font></a><span class="default">            } </span><span class="keyword">else</span>
<a name="1054"><font size=-1>1054     </font></a><span class="keyword">                break</span><span class="default">;</span>
<a name="1055"><font size=-1>1055     </font></a><span class="default">        }</span>
<a name="1056"><font size=-1>1056     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_T.html#27362">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(),</span><span class="string">&quot;;&quot;</span><span class="default">)) {</span>
<a name="1057"><font size=-1>1057     </font></a><span class="default">            <a href="dictionary_P.html#27363">position</a> = <a href="dictionary_I.html#27364">i</a>;</span>
<a name="1058"><font size=-1>1058     </font></a><span class="default">            </span><span class="keyword">return true</span><span class="default">;</span>
<a name="1059"><font size=-1>1059     </font></a><span class="default">        }</span>
<a name="1060"><font size=-1>1060     </font></a><span class="default">    }</span>
<a name="1061"><font size=-1>1061     </font></a><span class="default">    </span><span class="keyword">return false</span><span class="default">;</span>
<a name="1062"><font size=-1>1062     </font></a><span class="default">}</span>
<a name="1063"><font size=-1>1063     </font></a><span class="default"></span>
<a name="1064"><font size=-1>1064     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1065"><font size=-1>1065     </font></a><span class="comment">// Checking local variables in a scope</span>
<a name="1066"><font size=-1>1066     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1067"><font size=-1>1067     </font></a><span class="comment"></span>
<a name="1068"><font size=-1>1068     </font></a><span class="comment"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1791">checkGlobalAndLocalVariable</a>()</span>
<a name="1069"><font size=-1>1069     </font></a><span class="default">{</span>
<a name="1070"><font size=-1>1070     </font></a><span class="default">    </span><span class="comment">// check string literals</span>
<a name="1071"><font size=-1>1071     </font></a><span class="comment">    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27365">tok</a> = <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1962">tokens</a>(); <a href="dictionary_T.html#27365">tok</a>; <a href="dictionary_T.html#27365">tok</a> = <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1072"><font size=-1>1072     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27365">tok</a>, </span><span class="string">&quot;%str% [&quot;</span><span class="default">) &amp;&amp; <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()) {</span>
<a name="1073"><font size=-1>1073     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_S.html#27366">size</a> = <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#8751">getStrSize</a>(<a href="dictionary_T.html#27365">tok</a>);</span>
<a name="1074"><font size=-1>1074     </font></a><span class="default">            </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_V.html#27367">value</a> = <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#22250">getMaxValue</a>(</span><span class="keyword">false</span><span class="default">);</span>
<a name="1075"><font size=-1>1075     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27367">value</a> &amp;&amp; <a href="dictionary_V.html#27367">value</a>-&gt;<a href="dictionary_V.html#5807">intvalue</a> &gt;= (<a href="dictionary_I.html#27215">isAddressOf</a>(<a href="dictionary_T.html#27365">tok</a>) ? <a href="dictionary_S.html#27366">size</a> + </span><span class="number">1U </span><span class="default">: <a href="dictionary_S.html#27366">size</a>))</span>
<a name="1076"><font size=-1>1076     </font></a><span class="default">                <a href="dictionary_C.html#1838">bufferOverrunError</a>(<a href="dictionary_T.html#27365">tok</a>, <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="1077"><font size=-1>1077     </font></a><span class="default">        }</span>
<a name="1078"><font size=-1>1078     </font></a><span class="default"></span>
<a name="1079"><font size=-1>1079     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27365">tok</a>, </span><span class="string">&quot;%var% [&quot;</span><span class="default">) &amp;&amp; <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>() &amp;&amp; <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>() &amp;&amp; <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>()-&gt;<a href="dictionary_T.html#2855">isPointer</a>()) {</span>
<a name="1080"><font size=-1>1080     </font></a><span class="default">            </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_V.html#27368">value</a> = <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#22250">getMaxValue</a>(</span><span class="keyword">false</span><span class="default">);</span>
<a name="1081"><font size=-1>1081     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_V.html#27368">value</a>)</span>
<a name="1082"><font size=-1>1082     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1083"><font size=-1>1083     </font></a><span class="default"></span>
<a name="1084"><font size=-1>1084     </font></a><span class="default">            </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;ValueFlow::Value&gt;::<a href="dictionary_S.html#4610">const_iterator</a> <a href="dictionary_I.html#27369">it</a> = <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#6657">values</a>.<a href="dictionary_S.html#3264">begin</a>(); <a href="dictionary_I.html#27369">it</a> != <a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#6657">values</a>.<a href="dictionary_S.html#3265">end</a>(); ++<a href="dictionary_I.html#27369">it</a>) {</span>
<a name="1085"><font size=-1>1085     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_I.html#27369">it</a>-&gt;<a href="dictionary_T.html#17900">tokvalue</a>)</span>
<a name="1086"><font size=-1>1086     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1087"><font size=-1>1087     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">*<a href="dictionary_V.html#27370">var</a> = <a href="dictionary_I.html#27369">it</a>-&gt;<a href="dictionary_T.html#17900">tokvalue</a>-&gt;<a href="dictionary_V.html#9884">variable</a>();</span>
<a name="1088"><font size=-1>1088     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27370">var</a> &amp;&amp; <a href="dictionary_V.html#27370">var</a>-&gt;<a href="dictionary_V.html#2645">isArray</a>()) {</span>
<a name="1089"><font size=-1>1089     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#1430">astCanonicalType</a>(<a href="dictionary_T.html#27365">tok</a>) != <a href="dictionary_A.html#1430">astCanonicalType</a>(<a href="dictionary_I.html#27369">it</a>-&gt;<a href="dictionary_T.html#17900">tokvalue</a>))</span>
<a name="1090"><font size=-1>1090     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1091"><font size=-1>1091     </font></a><span class="default"></span>
<a name="1092"><font size=-1>1092     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> <a href="dictionary_A.html#27371">arrayInfo</a></span><span class="default">(<a href="dictionary_V.html#27370">var</a>, <a href="dictionary_C.html#1879">_tokenizer</a>, &amp;<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1024">library</a>);</span>
<a name="1093"><font size=-1>1093     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_E.html#27372">elements</a> = <a href="dictionary_A.html#27371">arrayInfo</a>.<a href="dictionary_C.html#1817">numberOfElements</a>();</span>
<a name="1094"><font size=-1>1094     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_E.html#27372">elements</a> &lt;= </span><span class="number">0</span><span class="default">) </span><span class="comment">// unknown size</span>
<a name="1095"><font size=-1>1095     </font></a><span class="comment">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1096"><font size=-1>1096     </font></a><span class="default"></span>
<a name="1097"><font size=-1>1097     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;ValueFlow::Value&gt; <a href="dictionary_I.html#27373">indexes</a>(<a href="dictionary_V.html#27308">valueFlowGetArrayIndexes</a>(<a href="dictionary_T.html#27365">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), </span><span class="keyword">false</span><span class="default">, <a href="dictionary_V.html#27370">var</a>-&gt;<a href="dictionary_V.html#8129">dimensions</a>().<a href="dictionary_S.html#1203">size</a>()));</span>
<a name="1098"><font size=-1>1098     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27373">indexes</a>.<a href="dictionary_S.html#1203">size</a>() != <a href="dictionary_V.html#27370">var</a>-&gt;<a href="dictionary_V.html#8129">dimensions</a>().<a href="dictionary_S.html#1203">size</a>())</span>
<a name="1099"><font size=-1>1099     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1100"><font size=-1>1100     </font></a><span class="default"></span>
<a name="1101"><font size=-1>1101     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_I.html#27374">index</a> = <a href="dictionary_A.html#27371">arrayInfo</a>.<a href="dictionary_C.html#1818">totalIndex</a>(<a href="dictionary_I.html#27373">indexes</a>);</span>
<a name="1102"><font size=-1>1102     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27374">index</a> &lt; (<a href="dictionary_I.html#27215">isAddressOf</a>(<a href="dictionary_T.html#27365">tok</a>) ? <a href="dictionary_E.html#27372">elements</a> + </span><span class="number">1U </span><span class="default">: <a href="dictionary_E.html#27372">elements</a>))</span>
<a name="1103"><font size=-1>1103     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1104"><font size=-1>1104     </font></a><span class="default"></span>
<a name="1105"><font size=-1>1105     </font></a><span class="default">                    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token *&gt; <a href="dictionary_C.html#27375">callstack</a>;</span>
<a name="1106"><font size=-1>1106     </font></a><span class="default">                    <a href="dictionary_C.html#27375">callstack</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_I.html#27369">it</a>-&gt;<a href="dictionary_T.html#17900">tokvalue</a>);</span>
<a name="1107"><font size=-1>1107     </font></a><span class="default">                    <a href="dictionary_C.html#27375">callstack</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_T.html#27365">tok</a>);</span>
<a name="1108"><font size=-1>1108     </font></a><span class="default"></span>
<a name="1109"><font size=-1>1109     </font></a><span class="default">                    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1095">vector</a>&lt;MathLib::bigint&gt; <a href="dictionary_I.html#27376">indexes2</a>;</span>
<a name="1110"><font size=-1>1110     </font></a><span class="default">                    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">unsigned int <a href="dictionary_I.html#27377">i</a> </span><span class="default">= </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27377">i</a> &lt; <a href="dictionary_I.html#27373">indexes</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27377">i</a>)</span>
<a name="1111"><font size=-1>1111     </font></a><span class="default">                        <a href="dictionary_I.html#27376">indexes2</a>.<a href="dictionary_P.html#1100">push_back</a>(<a href="dictionary_I.html#27373">indexes</a>[<a href="dictionary_I.html#27377">i</a>].<a href="dictionary_I.html#6658">intvalue</a>);</span>
<a name="1112"><font size=-1>1112     </font></a><span class="default"></span>
<a name="1113"><font size=-1>1113     </font></a><span class="default">                    <a href="dictionary_C.html#825">arrayIndexOutOfBoundsError</a>(<a href="dictionary_C.html#27375">callstack</a>, <a href="dictionary_A.html#27371">arrayInfo</a>, <a href="dictionary_I.html#27376">indexes2</a>);</span>
<a name="1114"><font size=-1>1114     </font></a><span class="default">                }</span>
<a name="1115"><font size=-1>1115     </font></a><span class="default">            }</span>
<a name="1116"><font size=-1>1116     </font></a><span class="default">        }</span>
<a name="1117"><font size=-1>1117     </font></a><span class="default">    }</span>
<a name="1118"><font size=-1>1118     </font></a><span class="default"></span>
<a name="1119"><font size=-1>1119     </font></a><span class="default">    </span><span class="comment">// check all known fixed size arrays first by just looking them up</span>
<a name="1120"><font size=-1>1120     </font></a><span class="comment">    </span><span class="keyword">const <a href="dictionary_S.html#1883">SymbolDatabase</a></span><span class="default">* <a href="dictionary_S.html#27378">symbolDatabase</a> = <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>();</span>
<a name="1121"><font size=-1>1121     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">unsigned int <a href="dictionary_I.html#27379">i</a> </span><span class="default">= </span><span class="number">1</span><span class="default">; <a href="dictionary_I.html#27379">i</a> &lt;= <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#7875">varIdCount</a>(); <a href="dictionary_I.html#27379">i</a>++) {</span>
<a name="1122"><font size=-1>1122     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_V.html#27380">var</a> </span><span class="default">= <a href="dictionary_S.html#27378">symbolDatabase</a>-&gt;<a href="dictionary_S.html#5047">getVariableFromVarId</a>(<a href="dictionary_I.html#27379">i</a>);</span>
<a name="1123"><font size=-1>1123     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27380">var</a> &amp;&amp; <a href="dictionary_V.html#27380">var</a>-&gt;<a href="dictionary_V.html#2645">isArray</a>() &amp;&amp; <a href="dictionary_V.html#27380">var</a>-&gt;<a href="dictionary_V.html#8130">dimension</a>(</span><span class="number">0</span><span class="default">) &gt; </span><span class="number">0</span><span class="default">) {</span>
<a name="1124"><font size=-1>1124     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27381">tok</a> = <a href="dictionary_V.html#27380">var</a>-&gt;<a href="dictionary_V.html#2646">nameToken</a>();</span>
<a name="1125"><font size=-1>1125     </font></a><span class="default">            </span><span class="keyword">do </span><span class="default">{</span>
<a name="1126"><font size=-1>1126     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27381">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;{&quot;</span><span class="default">) {</span>
<a name="1127"><font size=-1>1127     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_T.html#27381">tok</a>-&gt;<a href="dictionary_T.html#1421">previous</a>(), </span><span class="string">&quot;= {&quot;</span><span class="default">))</span>
<a name="1128"><font size=-1>1128     </font></a><span class="default">                        <a href="dictionary_T.html#27381">tok</a> = <a href="dictionary_T.html#27381">tok</a>-&gt;<a href="dictionary_T.html#1482">link</a>();</span>
<a name="1129"><font size=-1>1129     </font></a><span class="default">                    </span><span class="keyword">else</span>
<a name="1130"><font size=-1>1130     </font></a><span class="keyword">                        break</span><span class="default">;</span>
<a name="1131"><font size=-1>1131     </font></a><span class="default">                }</span>
<a name="1132"><font size=-1>1132     </font></a><span class="default">                <a href="dictionary_T.html#27381">tok</a> = <a href="dictionary_T.html#27381">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="1133"><font size=-1>1133     </font></a><span class="default">            } </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#27381">tok</a> &amp;&amp; <a href="dictionary_T.html#27381">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() != </span><span class="string">&quot;;&quot;</span><span class="default">);</span>
<a name="1134"><font size=-1>1134     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#27381">tok</a>)</span>
<a name="1135"><font size=-1>1135     </font></a><span class="default">                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1136"><font size=-1>1136     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27381">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;{&quot;</span><span class="default">)</span>
<a name="1137"><font size=-1>1137     </font></a><span class="default">                <a href="dictionary_T.html#27381">tok</a> = <a href="dictionary_T.html#27381">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="1138"><font size=-1>1138     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_C.html#1795">ArrayInfo</a> <a href="dictionary_A.html#27382">arrayInfo</a></span><span class="default">(<a href="dictionary_V.html#27380">var</a>, <a href="dictionary_C.html#1879">_tokenizer</a>, &amp;<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1024">library</a>, <a href="dictionary_I.html#27379">i</a>);</span>
<a name="1139"><font size=-1>1139     </font></a><span class="default">            <a href="dictionary_C.html#1819">checkScope</a>(<a href="dictionary_T.html#27381">tok</a>, <a href="dictionary_A.html#27382">arrayInfo</a>);</span>
<a name="1140"><font size=-1>1140     </font></a><span class="default">        }</span>
<a name="1141"><font size=-1>1141     </font></a><span class="default">    }</span>
<a name="1142"><font size=-1>1142     </font></a><span class="default"></span>
<a name="1143"><font size=-1>1143     </font></a><span class="default">    </span><span class="comment">// find all dynamically allocated arrays next</span>
<a name="1144"><font size=-1>1144     </font></a><span class="comment">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_F.html#27383">functions</a> = <a href="dictionary_S.html#27378">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>.<a href="dictionary_S.html#1203">size</a>();</span>
<a name="1145"><font size=-1>1145     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27384">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27384">i</a> &lt; <a href="dictionary_F.html#27383">functions</a>; ++<a href="dictionary_I.html#27384">i</a>) {</span>
<a name="1146"><font size=-1>1146     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_S.html#606">Scope</a> </span><span class="default">* <a href="dictionary_S.html#27385">scope</a> = <a href="dictionary_S.html#27378">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>[<a href="dictionary_I.html#27384">i</a>];</span>
<a name="1147"><font size=-1>1147     </font></a><span class="default"></span>
<a name="1148"><font size=-1>1148     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27386">tok</a> = <a href="dictionary_S.html#27385">scope</a>-&gt;<a href="dictionary_S.html#1889">classStart</a>; <a href="dictionary_T.html#27386">tok</a> != <a href="dictionary_S.html#27385">scope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>; <a href="dictionary_T.html#27386">tok</a> = <a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1149"><font size=-1>1149     </font></a><span class="default">            </span><span class="comment">// if the previous token exists, it must be either a variable name or &quot;[;{}]&quot;</span>
<a name="1150"><font size=-1>1150     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1421">previous</a>() &amp;&amp; !<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1421">previous</a>()-&gt;<a href="dictionary_T.html#1426">isName</a>() &amp;&amp; !<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1421">previous</a>(), </span><span class="string">&quot;[;{}]&quot;</span><span class="default">))</span>
<a name="1151"><font size=-1>1151     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1152"><font size=-1>1152     </font></a><span class="default"></span>
<a name="1153"><font size=-1>1153     </font></a><span class="default">            </span><span class="comment">// size : Max array index</span>
<a name="1154"><font size=-1>1154     </font></a><span class="comment">            <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_S.html#27387">size</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="1155"><font size=-1>1155     </font></a><span class="default"></span>
<a name="1156"><font size=-1>1156     </font></a><span class="default">            </span><span class="comment">// type : The type of a array element</span>
<a name="1157"><font size=-1>1157     </font></a><span class="comment">            <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> <a href="dictionary_T.html#27388">type</a>;</span>
<a name="1158"><font size=-1>1158     </font></a><span class="default"></span>
<a name="1159"><font size=-1>1159     </font></a><span class="default">            </span><span class="comment">// varid : The variable id for the array</span>
<a name="1160"><font size=-1>1160     </font></a><span class="comment">            </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">*<a href="dictionary_V.html#27389">var</a> = <a href="dictionary_N.html#1132">nullptr</a>;</span>
<a name="1161"><font size=-1>1161     </font></a><span class="default"></span>
<a name="1162"><font size=-1>1162     </font></a><span class="default">            </span><span class="comment">// nextTok : number of tokens used in variable declaration - used to skip to next statement.</span>
<a name="1163"><font size=-1>1163     </font></a><span class="comment">            </span><span class="keyword">int <a href="dictionary_N.html#27390">nextTok</a> </span><span class="default">= </span><span class="number">0</span><span class="default">;</span>
<a name="1164"><font size=-1>1164     </font></a><span class="default"></span>
<a name="1165"><font size=-1>1165     </font></a><span class="default">            <a href="dictionary_C.html#3528">_errorLogger</a>-&gt;<a href="dictionary_E.html#3478">reportProgress</a>(<a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#3885">list</a>.<a href="dictionary_T.html#1697">getSourceFilePath</a>(),</span>
<a name="1166"><font size=-1>1166     </font></a><span class="default">                                         </span><span class="string">&quot;Check (BufferOverrun::checkGlobalAndLocalVariable)&quot;</span><span class="default">,</span>
<a name="1167"><font size=-1>1167     </font></a><span class="default">                                         <a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#7691">progressValue</a>());</span>
<a name="1168"><font size=-1>1168     </font></a><span class="default"></span>
<a name="1169"><font size=-1>1169     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#653">isCPP</a>() &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27386">tok</a>, </span><span class="string">&quot;[*;{}] %var% = new %type% [ %num% ]&quot;</span><span class="default">)) {</span>
<a name="1170"><font size=-1>1170     </font></a><span class="default">                <a href="dictionary_S.html#27387">size</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">6</span><span class="default">));</span>
<a name="1171"><font size=-1>1171     </font></a><span class="default">                <a href="dictionary_T.html#27388">type</a> = <a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">4</span><span class="default">);</span>
<a name="1172"><font size=-1>1172     </font></a><span class="default">                <a href="dictionary_V.html#27389">var</a> = <a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1907">variable</a>();</span>
<a name="1173"><font size=-1>1173     </font></a><span class="default">                <a href="dictionary_N.html#27390">nextTok</a> = </span><span class="number">8</span><span class="default">;</span>
<a name="1174"><font size=-1>1174     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27387">size</a> &lt; </span><span class="number">0</span><span class="default">) {</span>
<a name="1175"><font size=-1>1175     </font></a><span class="default">                    <a href="dictionary_C.html#1841">negativeMemoryAllocationSizeError</a>(<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1414">next</a>());</span>
<a name="1176"><font size=-1>1176     </font></a><span class="default">                }</span>
<a name="1177"><font size=-1>1177     </font></a><span class="default">            } </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#653">isCPP</a>() &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27386">tok</a>, </span><span class="string">&quot;[*;{}] %var% = new %type% ( %num%|%name% )&quot;</span><span class="default">)) {</span>
<a name="1178"><font size=-1>1178     </font></a><span class="default">                <a href="dictionary_S.html#27387">size</a> = </span><span class="number">1</span><span class="default">;</span>
<a name="1179"><font size=-1>1179     </font></a><span class="default">                <a href="dictionary_T.html#27388">type</a> = <a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">4</span><span class="default">);</span>
<a name="1180"><font size=-1>1180     </font></a><span class="default">                <a href="dictionary_V.html#27389">var</a> = <a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1907">variable</a>();</span>
<a name="1181"><font size=-1>1181     </font></a><span class="default">                <a href="dictionary_N.html#27390">nextTok</a> = </span><span class="number">8</span><span class="default">;</span>
<a name="1182"><font size=-1>1182     </font></a><span class="default">            } </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27386">tok</a>, </span><span class="string">&quot;[*;{}] %var% = malloc|alloca ( %num% ) ;&quot;</span><span class="default">)) {</span>
<a name="1183"><font size=-1>1183     </font></a><span class="default">                <a href="dictionary_S.html#27387">size</a> = <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">5</span><span class="default">));</span>
<a name="1184"><font size=-1>1184     </font></a><span class="default">                <a href="dictionary_T.html#27388">type</a> = </span><span class="string">&quot;char&quot;</span><span class="default">;   </span><span class="comment">// minimum type, typesize=1</span>
<a name="1185"><font size=-1>1185     </font></a><span class="comment">                <a href="dictionary_V.html#27389">var</a> </span><span class="default">= <a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1907">variable</a>();</span>
<a name="1186"><font size=-1>1186     </font></a><span class="default">                <a href="dictionary_N.html#27390">nextTok</a> = </span><span class="number">7</span><span class="default">;</span>
<a name="1187"><font size=-1>1187     </font></a><span class="default"></span>
<a name="1188"><font size=-1>1188     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27387">size</a> &lt; </span><span class="number">0</span><span class="default">) {</span>
<a name="1189"><font size=-1>1189     </font></a><span class="default">                    <a href="dictionary_C.html#1841">negativeMemoryAllocationSizeError</a>(<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1414">next</a>());</span>
<a name="1190"><font size=-1>1190     </font></a><span class="default">                }</span>
<a name="1191"><font size=-1>1191     </font></a><span class="default"></span>
<a name="1192"><font size=-1>1192     </font></a><span class="default">                </span><span class="comment">/** @todo false negatives: this may be too conservative */</span>
<a name="1193"><font size=-1>1193     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_V.html#27389">var</a> || !<a href="dictionary_V.html#27389">var</a>-&gt;<a href="dictionary_V.html#2644">isPointer</a>() || <a href="dictionary_V.html#27389">var</a>-&gt;<a href="dictionary_V.html#2918">typeStartToken</a>()-&gt;<a href="dictionary_T.html#1414">next</a>() != <a href="dictionary_V.html#27389">var</a>-&gt;<a href="dictionary_V.html#5008">typeEndToken</a>())</span>
<a name="1194"><font size=-1>1194     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1195"><font size=-1>1195     </font></a><span class="default"></span>
<a name="1196"><font size=-1>1196     </font></a><span class="default">                </span><span class="comment">// get type of variable</span>
<a name="1197"><font size=-1>1197     </font></a><span class="comment">                <a href="dictionary_T.html#27388">type</a> </span><span class="default">= <a href="dictionary_V.html#27389">var</a>-&gt;<a href="dictionary_V.html#2918">typeStartToken</a>()-&gt;<a href="dictionary_T.html#1416">str</a>();</span>
<a name="1198"><font size=-1>1198     </font></a><span class="default"></span>
<a name="1199"><font size=-1>1199     </font></a><span class="default">                </span><span class="comment">// malloc() gets count of bytes and not count of</span>
<a name="1200"><font size=-1>1200     </font></a><span class="comment">                // elements, so we should calculate count of elements</span>
<a name="1201"><font size=-1>1201     </font></a><span class="comment">                // manually</span>
<a name="1202"><font size=-1>1202     </font></a><span class="comment">                </span><span class="keyword">const unsigned int <a href="dictionary_S.html#27391">sizeOfType</a> </span><span class="default">= <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#8527">sizeOfType</a>(<a href="dictionary_V.html#27389">var</a>-&gt;<a href="dictionary_V.html#2918">typeStartToken</a>());</span>
<a name="1203"><font size=-1>1203     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27391">sizeOfType</a> &gt; </span><span class="number">0</span><span class="default">) {</span>
<a name="1204"><font size=-1>1204     </font></a><span class="default">                    <a href="dictionary_S.html#27387">size</a> /= </span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">int</span><span class="default">&gt;(<a href="dictionary_S.html#27391">sizeOfType</a>);</span>
<a name="1205"><font size=-1>1205     </font></a><span class="default">                }</span>
<a name="1206"><font size=-1>1206     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27387">size</a> &lt; </span><span class="number">0</span><span class="default">) {</span>
<a name="1207"><font size=-1>1207     </font></a><span class="default">                    <a href="dictionary_C.html#1841">negativeMemoryAllocationSizeError</a>(<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1414">next</a>());</span>
<a name="1208"><font size=-1>1208     </font></a><span class="default">                }</span>
<a name="1209"><font size=-1>1209     </font></a><span class="default">            } </span><span class="keyword">else </span><span class="default">{</span>
<a name="1210"><font size=-1>1210     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1211"><font size=-1>1211     </font></a><span class="default">            }</span>
<a name="1212"><font size=-1>1212     </font></a><span class="default"></span>
<a name="1213"><font size=-1>1213     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27389">var</a> == </span><span class="number">0</span><span class="default">)</span>
<a name="1214"><font size=-1>1214     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1215"><font size=-1>1215     </font></a><span class="default"></span>
<a name="1216"><font size=-1>1216     </font></a><span class="default">            <a href="dictionary_T.html#3829">Token</a> <a href="dictionary_S.html#27392">sizeTok</a>(</span><span class="number">0</span><span class="default">);</span>
<a name="1217"><font size=-1>1217     </font></a><span class="default">            <a href="dictionary_S.html#27392">sizeTok</a>.<a href="dictionary_T.html#1416">str</a>(<a href="dictionary_T.html#27388">type</a>);</span>
<a name="1218"><font size=-1>1218     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_T.html#27393">totalSize</a> = <a href="dictionary_S.html#27387">size</a> * </span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">int</span><span class="default">&gt;(<a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#8527">sizeOfType</a>(&amp;<a href="dictionary_S.html#27392">sizeTok</a>));</span>
<a name="1219"><font size=-1>1219     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27393">totalSize</a> == </span><span class="number">0</span><span class="default">)</span>
<a name="1220"><font size=-1>1220     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1221"><font size=-1>1221     </font></a><span class="default"></span>
<a name="1222"><font size=-1>1222     </font></a><span class="default">            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1095">vector</a>&lt;std::string&gt; <a href="dictionary_V.html#27394">v</a>;</span>
<a name="1223"><font size=-1>1223     </font></a><span class="default">            <a href="dictionary_C.html#1800">ArrayInfo</a> <a href="dictionary_T.html#27395">temp</a>(<a href="dictionary_V.html#27389">var</a>-&gt;<a href="dictionary_V.html#4822">declarationId</a>(), <a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1416">str</a>(), <a href="dictionary_T.html#27393">totalSize</a> / <a href="dictionary_S.html#27387">size</a>, <a href="dictionary_S.html#27387">size</a>);</span>
<a name="1224"><font size=-1>1224     </font></a><span class="default">            <a href="dictionary_C.html#1819">checkScope</a>(<a href="dictionary_T.html#27386">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(<a href="dictionary_N.html#27390">nextTok</a>), <a href="dictionary_V.html#27394">v</a>, <a href="dictionary_T.html#27395">temp</a>);</span>
<a name="1225"><font size=-1>1225     </font></a><span class="default">        }</span>
<a name="1226"><font size=-1>1226     </font></a><span class="default">    }</span>
<a name="1227"><font size=-1>1227     </font></a><span class="default">}</span>
<a name="1228"><font size=-1>1228     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1229"><font size=-1>1229     </font></a><span class="comment"></span>
<a name="1230"><font size=-1>1230     </font></a><span class="comment"></span>
<a name="1231"><font size=-1>1231     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1232"><font size=-1>1232     </font></a><span class="comment">// Checking member variables of structs.</span>
<a name="1233"><font size=-1>1233     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1234"><font size=-1>1234     </font></a><span class="comment"></span>
<a name="1235"><font size=-1>1235     </font></a><span class="comment"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1790">checkStructVariable</a>()</span>
<a name="1236"><font size=-1>1236     </font></a><span class="default">{</span>
<a name="1237"><font size=-1>1237     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#1883">SymbolDatabase</a> </span><span class="default">* <a href="dictionary_S.html#27396">symbolDatabase</a> = <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>();</span>
<a name="1238"><font size=-1>1238     </font></a><span class="default"></span>
<a name="1239"><font size=-1>1239     </font></a><span class="default">    </span><span class="comment">// find every class and struct</span>
<a name="1240"><font size=-1>1240     </font></a><span class="comment">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_C.html#27397">classes</a> = <a href="dictionary_S.html#27396">symbolDatabase</a>-&gt;<a href="dictionary_S.html#7847">classAndStructScopes</a>.<a href="dictionary_S.html#1203">size</a>();</span>
<a name="1241"><font size=-1>1241     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27398">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27398">i</a> &lt; <a href="dictionary_C.html#27397">classes</a>; ++<a href="dictionary_I.html#27398">i</a>) {</span>
<a name="1242"><font size=-1>1242     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_S.html#606">Scope</a> </span><span class="default">* <a href="dictionary_S.html#27399">scope</a> = <a href="dictionary_S.html#27396">symbolDatabase</a>-&gt;<a href="dictionary_S.html#7847">classAndStructScopes</a>[<a href="dictionary_I.html#27398">i</a>];</span>
<a name="1243"><font size=-1>1243     </font></a><span class="default"></span>
<a name="1244"><font size=-1>1244     </font></a><span class="default">        </span><span class="comment">// check all variables to see if they are arrays</span>
<a name="1245"><font size=-1>1245     </font></a><span class="comment">        <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;Variable&gt;::<a href="dictionary_S.html#4610">const_iterator</a> <a href="dictionary_V.html#27400">var</a>;</span>
<a name="1246"><font size=-1>1246     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(<a href="dictionary_V.html#27400">var</a> = <a href="dictionary_S.html#27399">scope</a>-&gt;<a href="dictionary_S.html#4961">varlist</a>.<a href="dictionary_S.html#3264">begin</a>(); <a href="dictionary_V.html#27400">var</a> != <a href="dictionary_S.html#27399">scope</a>-&gt;<a href="dictionary_S.html#4961">varlist</a>.<a href="dictionary_S.html#3265">end</a>(); ++<a href="dictionary_V.html#27400">var</a>) {</span>
<a name="1247"><font size=-1>1247     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27400">var</a>-&gt;<a href="dictionary_I.html#4965">isArray</a>()) {</span>
<a name="1248"><font size=-1>1248     </font></a><span class="default">                </span><span class="comment">// create ArrayInfo from the array variable</span>
<a name="1249"><font size=-1>1249     </font></a><span class="comment">                <a href="dictionary_C.html#1800">ArrayInfo</a> <a href="dictionary_A.html#27401">arrayInfo</a></span><span class="default">(&amp;*<a href="dictionary_V.html#27400">var</a>, <a href="dictionary_C.html#1879">_tokenizer</a>, &amp;<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1024">library</a>);</span>
<a name="1250"><font size=-1>1250     </font></a><span class="default"></span>
<a name="1251"><font size=-1>1251     </font></a><span class="default">                </span><span class="comment">// find every function</span>
<a name="1252"><font size=-1>1252     </font></a><span class="comment">                </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_F.html#27402">functions</a> = <a href="dictionary_S.html#27396">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>.<a href="dictionary_S.html#1203">size</a>();</span>
<a name="1253"><font size=-1>1253     </font></a><span class="default">                </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_J.html#27403">j</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_J.html#27403">j</a> &lt; <a href="dictionary_F.html#27402">functions</a>; ++<a href="dictionary_J.html#27403">j</a>) {</span>
<a name="1254"><font size=-1>1254     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_S.html#606">Scope</a> </span><span class="default">* <a href="dictionary_F.html#27404">func_scope</a> = <a href="dictionary_S.html#27396">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>[<a href="dictionary_J.html#27403">j</a>];</span>
<a name="1255"><font size=-1>1255     </font></a><span class="default"></span>
<a name="1256"><font size=-1>1256     </font></a><span class="default">                    </span><span class="comment">// If struct is declared in a function then check</span>
<a name="1257"><font size=-1>1257     </font></a><span class="comment">                    // if scope_func matches</span>
<a name="1258"><font size=-1>1258     </font></a><span class="comment">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27399">scope</a>-&gt;<a href="dictionary_S.html#6649">nestedIn</a>-&gt;<a href="dictionary_S.html#4942">type</a> == <a href="dictionary_S.html#606">Scope</a>::eFunction &amp;&amp;</span>
<a name="1259"><font size=-1>1259     </font></a><span class="default">                        <a href="dictionary_S.html#27399">scope</a>-&gt;<a href="dictionary_S.html#6649">nestedIn</a> != <a href="dictionary_F.html#27404">func_scope</a>) {</span>
<a name="1260"><font size=-1>1260     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1261"><font size=-1>1261     </font></a><span class="default">                    }</span>
<a name="1262"><font size=-1>1262     </font></a><span class="default"></span>
<a name="1263"><font size=-1>1263     </font></a><span class="default">                    </span><span class="comment">// check for member variables</span>
<a name="1264"><font size=-1>1264     </font></a><span class="comment">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_F.html#27404">func_scope</a>-&gt;<a href="dictionary_S.html#7773">functionOf</a> == <a href="dictionary_S.html#27399">scope</a>) {</span>
<a name="1265"><font size=-1>1265     </font></a><span class="default">                        </span><span class="comment">// only check non-empty function</span>
<a name="1266"><font size=-1>1266     </font></a><span class="comment">                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_F.html#27404">func_scope</a>-&gt;<a href="dictionary_S.html#1889">classStart</a>-&gt;<a href="dictionary_T.html#1414">next</a>() != <a href="dictionary_F.html#27404">func_scope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>) {</span>
<a name="1267"><font size=-1>1267     </font></a><span class="default">                            </span><span class="comment">// start checking after the {</span>
<a name="1268"><font size=-1>1268     </font></a><span class="comment">                            </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27405">tok</a> = <a href="dictionary_F.html#27404">func_scope</a>-&gt;<a href="dictionary_S.html#1889">classStart</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="1269"><font size=-1>1269     </font></a><span class="default">                            <a href="dictionary_C.html#1819">checkScope</a>(<a href="dictionary_T.html#27405">tok</a>, <a href="dictionary_A.html#27401">arrayInfo</a>);</span>
<a name="1270"><font size=-1>1270     </font></a><span class="default">                        }</span>
<a name="1271"><font size=-1>1271     </font></a><span class="default">                    }</span>
<a name="1272"><font size=-1>1272     </font></a><span class="default"></span>
<a name="1273"><font size=-1>1273     </font></a><span class="default">                    </span><span class="comment">// skip inner scopes..</span>
<a name="1274"><font size=-1>1274     </font></a><span class="comment">                    /** @todo false negatives: handle inner scopes someday */</span>
<a name="1275"><font size=-1>1275     </font></a><span class="comment">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27399">scope</a>-&gt;<a href="dictionary_S.html#6649">nestedIn</a>-&gt;<a href="dictionary_S.html#7695">isClassOrStruct</a>())</span>
<a name="1276"><font size=-1>1276     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1277"><font size=-1>1277     </font></a><span class="default"></span>
<a name="1278"><font size=-1>1278     </font></a><span class="default">                    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1095">vector</a>&lt;std::string&gt; <a href="dictionary_V.html#27406">varname</a>;</span>
<a name="1279"><font size=-1>1279     </font></a><span class="default">                    <a href="dictionary_V.html#27406">varname</a>.<a href="dictionary_P.html#1100">push_back</a>(</span><span class="string">&quot;&quot;</span><span class="default">);</span>
<a name="1280"><font size=-1>1280     </font></a><span class="default">                    <a href="dictionary_V.html#27406">varname</a>.<a href="dictionary_P.html#1100">push_back</a>(<a href="dictionary_A.html#27401">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>());</span>
<a name="1281"><font size=-1>1281     </font></a><span class="default"></span>
<a name="1282"><font size=-1>1282     </font></a><span class="default">                    </span><span class="comment">// search the function and it's parameters</span>
<a name="1283"><font size=-1>1283     </font></a><span class="comment">                    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27407">tok3</a> = <a href="dictionary_F.html#27404">func_scope</a>-&gt;<a href="dictionary_S.html#4987">classDef</a>; <a href="dictionary_T.html#27407">tok3</a> &amp;&amp; <a href="dictionary_T.html#27407">tok3</a> != <a href="dictionary_F.html#27404">func_scope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>; <a href="dictionary_T.html#27407">tok3</a> = <a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1284"><font size=-1>1284     </font></a><span class="default">                        </span><span class="comment">// search for the class/struct name</span>
<a name="1285"><font size=-1>1285     </font></a><span class="comment">                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1416">str</a>() != <a href="dictionary_S.html#27399">scope</a>-&gt;<a href="dictionary_S.html#7736">className</a>)</span>
<a name="1286"><font size=-1>1286     </font></a><span class="default">                            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1287"><font size=-1>1287     </font></a><span class="default"></span>
<a name="1288"><font size=-1>1288     </font></a><span class="default">                        </span><span class="comment">// find all array variables</span>
<a name="1289"><font size=-1>1289     </font></a><span class="comment">                        </span><span class="keyword">int <a href="dictionary_P.html#27408">posOfSemicolon</a> </span><span class="default">= -</span><span class="number">1</span><span class="default">;</span>
<a name="1290"><font size=-1>1290     </font></a><span class="default"></span>
<a name="1291"><font size=-1>1291     </font></a><span class="default">                        </span><span class="comment">// Declare variable: Fred fred1;</span>
<a name="1292"><font size=-1>1292     </font></a><span class="comment">                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), </span><span class="string">&quot;%var% ;&quot;</span><span class="default">))</span>
<a name="1293"><font size=-1>1293     </font></a><span class="default">                            <a href="dictionary_V.html#27406">varname</a>[</span><span class="number">0</span><span class="default">] = <a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">1</span><span class="default">);</span>
<a name="1294"><font size=-1>1294     </font></a><span class="default"></span>
<a name="1295"><font size=-1>1295     </font></a><span class="default">                        </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_C.html#1836">isArrayOfStruct</a>(<a href="dictionary_T.html#27407">tok3</a>,<a href="dictionary_P.html#27408">posOfSemicolon</a>)) {</span>
<a name="1296"><font size=-1>1296     </font></a><span class="default">                            <a href="dictionary_V.html#27406">varname</a>[</span><span class="number">0</span><span class="default">] = <a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">1</span><span class="default">);</span>
<a name="1297"><font size=-1>1297     </font></a><span class="default"></span>
<a name="1298"><font size=-1>1298     </font></a><span class="default">                            </span><span class="keyword">int <a href="dictionary_P.html#27409">pos</a> </span><span class="default">= </span><span class="number">2</span><span class="default">;</span>
<a name="1299"><font size=-1>1299     </font></a><span class="default">                            </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_K.html#27410">k</a> </span><span class="default">= </span><span class="number">0 </span><span class="default">; <a href="dictionary_K.html#27410">k</a> &lt; <a href="dictionary_P.html#27408">posOfSemicolon</a>; <a href="dictionary_K.html#27410">k</a>++) {</span>
<a name="1300"><font size=-1>1300     </font></a><span class="default">                                </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">int <a href="dictionary_I.html#27411">index</a> </span><span class="default">= <a href="dictionary_P.html#27409">pos</a>; <a href="dictionary_I.html#27411">index</a> &lt; (<a href="dictionary_P.html#27409">pos</a> + </span><span class="number">3</span><span class="default">); <a href="dictionary_I.html#27411">index</a>++)</span>
<a name="1301"><font size=-1>1301     </font></a><span class="default">                                    <a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(<a href="dictionary_I.html#27411">index</a>);</span>
<a name="1302"><font size=-1>1302     </font></a><span class="default">                                <a href="dictionary_P.html#27409">pos</a> += </span><span class="number">3</span><span class="default">;</span>
<a name="1303"><font size=-1>1303     </font></a><span class="default">                            }</span>
<a name="1304"><font size=-1>1304     </font></a><span class="default">                        }</span>
<a name="1305"><font size=-1>1305     </font></a><span class="default"></span>
<a name="1306"><font size=-1>1306     </font></a><span class="default">                        </span><span class="comment">// Declare pointer or reference: Fred *fred1</span>
<a name="1307"><font size=-1>1307     </font></a><span class="comment">                        </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), </span><span class="string">&quot;*|&amp; %var% [,);=]&quot;</span><span class="default">))</span>
<a name="1308"><font size=-1>1308     </font></a><span class="default">                            <a href="dictionary_V.html#27406">varname</a>[</span><span class="number">0</span><span class="default">] = <a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="1309"><font size=-1>1309     </font></a><span class="default"></span>
<a name="1310"><font size=-1>1310     </font></a><span class="default">                        </span><span class="keyword">else</span>
<a name="1311"><font size=-1>1311     </font></a><span class="keyword">                            continue</span><span class="default">;</span>
<a name="1312"><font size=-1>1312     </font></a><span class="default"></span>
<a name="1313"><font size=-1>1313     </font></a><span class="default">                        </span><span class="comment">// check for variable sized structure</span>
<a name="1314"><font size=-1>1314     </font></a><span class="comment">                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27399">scope</a>-&gt;<a href="dictionary_S.html#4942">type</a> == <a href="dictionary_S.html#606">Scope</a>::eStruct &amp;&amp; <a href="dictionary_V.html#27400">var</a>-&gt;<a href="dictionary_I.html#27412">isPublic</a>()) {</span>
<a name="1315"><font size=-1>1315     </font></a><span class="default">                            </span><span class="comment">// last member of a struct with array size of 0 or 1 could be a variable sized structure</span>
<a name="1316"><font size=-1>1316     </font></a><span class="comment">                            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27400">var</a>-&gt;<a href="dictionary_D.html#7897">dimensions</a>().<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1 </span><span class="default">&amp;&amp; <a href="dictionary_V.html#27400">var</a>-&gt;<a href="dictionary_D.html#27413">dimension</a>(</span><span class="number">0</span><span class="default">) &lt; </span><span class="number">2 </span><span class="default">&amp;&amp;</span>
<a name="1317"><font size=-1>1317     </font></a><span class="default">                                <a href="dictionary_V.html#27400">var</a>-&gt;<a href="dictionary_I.html#8232">index</a>() == (<a href="dictionary_S.html#27399">scope</a>-&gt;<a href="dictionary_S.html#4961">varlist</a>.<a href="dictionary_S.html#3014">size</a>() - </span><span class="number">1</span><span class="default">)) {</span>
<a name="1318"><font size=-1>1318     </font></a><span class="default">                                </span><span class="comment">// dynamically allocated so could be variable sized structure</span>
<a name="1319"><font size=-1>1319     </font></a><span class="comment">                                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;*&quot;</span><span class="default">) {</span>
<a name="1320"><font size=-1>1320     </font></a><span class="default">                                    </span><span class="comment">// check for allocation</span>
<a name="1321"><font size=-1>1321     </font></a><span class="comment">                                    </span><span class="keyword">if </span><span class="default">((<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">3</span><span class="default">), </span><span class="string">&quot;; %name% = malloc ( %num% ) ;&quot;</span><span class="default">) ||</span>
<a name="1322"><font size=-1>1322     </font></a><span class="default">                                         (<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">3</span><span class="default">), </span><span class="string">&quot;; %name% = (&quot;</span><span class="default">) &amp;&amp;</span>
<a name="1323"><font size=-1>1323     </font></a><span class="default">                                          <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">6</span><span class="default">), </span><span class="string">&quot;) malloc ( %num% ) ;&quot;</span><span class="default">))) &amp;&amp;</span>
<a name="1324"><font size=-1>1324     </font></a><span class="default">                                        (<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">4</span><span class="default">) == <a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">2</span><span class="default">))) {</span>
<a name="1325"><font size=-1>1325     </font></a><span class="default">                                        <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_S.html#27414">size</a>;</span>
<a name="1326"><font size=-1>1326     </font></a><span class="default"></span>
<a name="1327"><font size=-1>1327     </font></a><span class="default">                                        </span><span class="comment">// find size of allocation</span>
<a name="1328"><font size=-1>1328     </font></a><span class="comment">                                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">3</span><span class="default">) == </span><span class="string">&quot;(&quot;</span><span class="default">) </span><span class="comment">// has cast</span>
<a name="1329"><font size=-1>1329     </font></a><span class="comment">                                            <a href="dictionary_S.html#27414">size</a> </span><span class="default">= <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">6</span><span class="default">)-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">3</span><span class="default">));</span>
<a name="1330"><font size=-1>1330     </font></a><span class="default">                                        </span><span class="keyword">else</span>
<a name="1331"><font size=-1>1331     </font></a><span class="keyword">                                            <a href="dictionary_S.html#27414">size</a> </span><span class="default">= <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#222">toLongNumber</a>(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1417">strAt</a>(</span><span class="number">8</span><span class="default">));</span>
<a name="1332"><font size=-1>1332     </font></a><span class="default"></span>
<a name="1333"><font size=-1>1333     </font></a><span class="default">                                        </span><span class="comment">// We don't calculate the size of a structure even when we know</span>
<a name="1334"><font size=-1>1334     </font></a><span class="comment">                                        // the size of the members.  We just assign a length of 100 for</span>
<a name="1335"><font size=-1>1335     </font></a><span class="comment">                                        // any struct.  If the size is less than 100, we assume the</span>
<a name="1336"><font size=-1>1336     </font></a><span class="comment">                                        // programmer knew the size and specified it rather than using</span>
<a name="1337"><font size=-1>1337     </font></a><span class="comment">                                        // sizeof(struct). If the size is greater than 100, we assume</span>
<a name="1338"><font size=-1>1338     </font></a><span class="comment">                                        // the programmer specified the size as sizeof(struct) + number.</span>
<a name="1339"><font size=-1>1339     </font></a><span class="comment">                                        // Either way, this is just a guess and could be wrong.  The</span>
<a name="1340"><font size=-1>1340     </font></a><span class="comment">                                        // information to make the right decision has been simplified</span>
<a name="1341"><font size=-1>1341     </font></a><span class="comment">                                        // away by the time we get here.</span>
<a name="1342"><font size=-1>1342     </font></a><span class="comment">                                        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27414">size</a> != </span><span class="number">100</span><span class="default">) { </span><span class="comment">// magic number for size of struct</span>
<a name="1343"><font size=-1>1343     </font></a><span class="comment">                                            // check if a real size was specified and give up</span>
<a name="1344"><font size=-1>1344     </font></a><span class="comment">                                            // malloc(10) rather than malloc(sizeof(struct))</span>
<a name="1345"><font size=-1>1345     </font></a><span class="comment">                                            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27414">size</a> &lt; </span><span class="number">100 </span><span class="default">|| <a href="dictionary_A.html#27401">arrayInfo</a>.<a href="dictionary_C.html#1810">element_size</a>() == </span><span class="number">0</span><span class="default">)</span>
<a name="1346"><font size=-1>1346     </font></a><span class="default">                                                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1347"><font size=-1>1347     </font></a><span class="default"></span>
<a name="1348"><font size=-1>1348     </font></a><span class="default">                                            </span><span class="comment">// calculate real array size based on allocated size</span>
<a name="1349"><font size=-1>1349     </font></a><span class="comment">                                            <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_E.html#27415">elements</a> = (<a href="dictionary_S.html#27414">size</a> - </span><span class="number">100</span><span class="default">) / <a href="dictionary_A.html#27401">arrayInfo</a>.<a href="dictionary_C.html#1810">element_size</a>();</span>
<a name="1350"><font size=-1>1350     </font></a><span class="default">                                            <a href="dictionary_A.html#27401">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(</span><span class="number">0</span><span class="default">, <a href="dictionary_A.html#27401">arrayInfo</a>.<a href="dictionary_C.html#1804">num</a>(</span><span class="number">0</span><span class="default">) + <a href="dictionary_E.html#27415">elements</a>);</span>
<a name="1351"><font size=-1>1351     </font></a><span class="default">                                        }</span>
<a name="1352"><font size=-1>1352     </font></a><span class="default">                                    }</span>
<a name="1353"><font size=-1>1353     </font></a><span class="default"></span>
<a name="1354"><font size=-1>1354     </font></a><span class="default">                                    </span><span class="comment">// size unknown so assume it is a variable sized structure</span>
<a name="1355"><font size=-1>1355     </font></a><span class="comment">                                    </span><span class="keyword">else</span>
<a name="1356"><font size=-1>1356     </font></a><span class="keyword">                                        continue</span><span class="default">;</span>
<a name="1357"><font size=-1>1357     </font></a><span class="default">                                }</span>
<a name="1358"><font size=-1>1358     </font></a><span class="default">                            }</span>
<a name="1359"><font size=-1>1359     </font></a><span class="default">                        }</span>
<a name="1360"><font size=-1>1360     </font></a><span class="default"></span>
<a name="1361"><font size=-1>1361     </font></a><span class="default">                        </span><span class="comment">// Goto end of statement.</span>
<a name="1362"><font size=-1>1362     </font></a><span class="comment">                        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_C.html#27416">checkTok</a> = <a href="dictionary_N.html#1132">nullptr</a>;</span>
<a name="1363"><font size=-1>1363     </font></a><span class="default">                        </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#27407">tok3</a> &amp;&amp; <a href="dictionary_T.html#27407">tok3</a> != <a href="dictionary_F.html#27404">func_scope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>) {</span>
<a name="1364"><font size=-1>1364     </font></a><span class="default">                            </span><span class="comment">// End of statement.</span>
<a name="1365"><font size=-1>1365     </font></a><span class="comment">                            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;;&quot;</span><span class="default">) {</span>
<a name="1366"><font size=-1>1366     </font></a><span class="default">                                <a href="dictionary_C.html#27416">checkTok</a> = <a href="dictionary_T.html#27407">tok3</a>;</span>
<a name="1367"><font size=-1>1367     </font></a><span class="default">                                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1368"><font size=-1>1368     </font></a><span class="default">                            }</span>
<a name="1369"><font size=-1>1369     </font></a><span class="default"></span>
<a name="1370"><font size=-1>1370     </font></a><span class="default">                            </span><span class="comment">// End of function declaration..</span>
<a name="1371"><font size=-1>1371     </font></a><span class="comment">                            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_T.html#27407">tok3</a>, </span><span class="string">&quot;) ;&quot;</span><span class="default">))</span>
<a name="1372"><font size=-1>1372     </font></a><span class="default">                                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1373"><font size=-1>1373     </font></a><span class="default"></span>
<a name="1374"><font size=-1>1374     </font></a><span class="default">                            </span><span class="comment">// Function implementation..</span>
<a name="1375"><font size=-1>1375     </font></a><span class="comment">                            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_T.html#27407">tok3</a>, </span><span class="string">&quot;) {&quot;</span><span class="default">)) {</span>
<a name="1376"><font size=-1>1376     </font></a><span class="default">                                <a href="dictionary_C.html#27416">checkTok</a> = <a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="1377"><font size=-1>1377     </font></a><span class="default">                                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1378"><font size=-1>1378     </font></a><span class="default">                            }</span>
<a name="1379"><font size=-1>1379     </font></a><span class="default"></span>
<a name="1380"><font size=-1>1380     </font></a><span class="default">                            <a href="dictionary_T.html#27407">tok3</a> = <a href="dictionary_T.html#27407">tok3</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="1381"><font size=-1>1381     </font></a><span class="default">                        }</span>
<a name="1382"><font size=-1>1382     </font></a><span class="default"></span>
<a name="1383"><font size=-1>1383     </font></a><span class="default">                        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#27407">tok3</a>)</span>
<a name="1384"><font size=-1>1384     </font></a><span class="default">                            </span><span class="keyword">break</span><span class="default">;</span>
<a name="1385"><font size=-1>1385     </font></a><span class="default"></span>
<a name="1386"><font size=-1>1386     </font></a><span class="default">                        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_C.html#27416">checkTok</a>)</span>
<a name="1387"><font size=-1>1387     </font></a><span class="default">                            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1388"><font size=-1>1388     </font></a><span class="default"></span>
<a name="1389"><font size=-1>1389     </font></a><span class="default">                        </span><span class="comment">// Check variable usage..</span>
<a name="1390"><font size=-1>1390     </font></a><span class="comment">                        <a href="dictionary_C.html#1795">ArrayInfo</a> <a href="dictionary_T.html#27417">temp</a> </span><span class="default">= <a href="dictionary_A.html#27401">arrayInfo</a>;</span>
<a name="1391"><font size=-1>1391     </font></a><span class="default">                        <a href="dictionary_T.html#27417">temp</a>.<a href="dictionary_C.html#1811">declarationId</a>(</span><span class="number">0</span><span class="default">); </span><span class="comment">// do variable lookup by variable and member names rather than varid</span>
<a name="1392"><font size=-1>1392     </font></a><span class="comment">                        <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> <a href="dictionary_V.html#27418">varnames</a>; </span><span class="comment">// use class and member name for messages</span>
<a name="1393"><font size=-1>1393     </font></a><span class="comment">                        </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_K.html#27419">k</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_K.html#27419">k</a> &lt; <a href="dictionary_V.html#27406">varname</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_K.html#27419">k</a>)</span>
<a name="1394"><font size=-1>1394     </font></a><span class="default">                            <a href="dictionary_V.html#27418">varnames</a> += (<a href="dictionary_K.html#27419">k</a> == </span><span class="number">0 </span><span class="default">? </span><span class="string">&quot;&quot; </span><span class="default">: </span><span class="string">&quot;.&quot;</span><span class="default">) + <a href="dictionary_V.html#27406">varname</a>[<a href="dictionary_K.html#27419">k</a>];</span>
<a name="1395"><font size=-1>1395     </font></a><span class="default"></span>
<a name="1396"><font size=-1>1396     </font></a><span class="default">                        <a href="dictionary_T.html#27417">temp</a>.<a href="dictionary_C.html#1814">varname</a>(<a href="dictionary_V.html#27418">varnames</a>);</span>
<a name="1397"><font size=-1>1397     </font></a><span class="default">                        <a href="dictionary_C.html#1819">checkScope</a>(<a href="dictionary_C.html#27416">checkTok</a>, <a href="dictionary_V.html#27406">varname</a>, <a href="dictionary_T.html#27417">temp</a>);</span>
<a name="1398"><font size=-1>1398     </font></a><span class="default">                    }</span>
<a name="1399"><font size=-1>1399     </font></a><span class="default">                }</span>
<a name="1400"><font size=-1>1400     </font></a><span class="default">            }</span>
<a name="1401"><font size=-1>1401     </font></a><span class="default">        }</span>
<a name="1402"><font size=-1>1402     </font></a><span class="default">    }</span>
<a name="1403"><font size=-1>1403     </font></a><span class="default">}</span>
<a name="1404"><font size=-1>1404     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1405"><font size=-1>1405     </font></a><span class="comment"></span>
<a name="1406"><font size=-1>1406     </font></a><span class="comment"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1785">bufferOverrun</a>()</span>
<a name="1407"><font size=-1>1407     </font></a><span class="default">{</span>
<a name="1408"><font size=-1>1408     </font></a><span class="default">    <a href="dictionary_C.html#1791">checkGlobalAndLocalVariable</a>();</span>
<a name="1409"><font size=-1>1409     </font></a><span class="default">    <a href="dictionary_C.html#1790">checkStructVariable</a>();</span>
<a name="1410"><font size=-1>1410     </font></a><span class="default">    <a href="dictionary_C.html#1792">checkBufferAllocatedWithStrlen</a>();</span>
<a name="1411"><font size=-1>1411     </font></a><span class="default">    <a href="dictionary_C.html#1793">checkStringArgument</a>();</span>
<a name="1412"><font size=-1>1412     </font></a><span class="default">    <a href="dictionary_C.html#1794">checkInsecureCmdLineArgs</a>();</span>
<a name="1413"><font size=-1>1413     </font></a><span class="default">}</span>
<a name="1414"><font size=-1>1414     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1415"><font size=-1>1415     </font></a><span class="comment"></span>
<a name="1416"><font size=-1>1416     </font></a><span class="comment"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1786">bufferOverrun2</a>()</span>
<a name="1417"><font size=-1>1417     </font></a><span class="default">{</span>
<a name="1418"><font size=-1>1418     </font></a><span class="default">    </span><span class="comment">// singlepass checking using ast, symboldatabase and valueflow</span>
<a name="1419"><font size=-1>1419     </font></a><span class="comment">    </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27420">tok</a> = <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1962">tokens</a>(); <a href="dictionary_T.html#27420">tok</a>; <a href="dictionary_T.html#27420">tok</a> = <a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1420"><font size=-1>1420     </font></a><span class="default">        </span><span class="comment">// Array index</span>
<a name="1421"><font size=-1>1421     </font></a><span class="comment">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27420">tok</a>, </span><span class="string">&quot;%name% [&quot;</span><span class="default">))</span>
<a name="1422"><font size=-1>1422     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1423"><font size=-1>1423     </font></a><span class="default"></span>
<a name="1424"><font size=-1>1424     </font></a><span class="default">        </span><span class="comment">// TODO: what to do about negative index..</span>
<a name="1425"><font size=-1>1425     </font></a><span class="comment">        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_I.html#27421">index</a> = <a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>();</span>
<a name="1426"><font size=-1>1426     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27421">index</a> &amp;&amp; <a href="dictionary_I.html#27421">index</a>-&gt;<a href="dictionary_T.html#11408">getValueLE</a>(-</span><span class="number">1LL</span><span class="default">,<a href="dictionary_C.html#1875">_settings</a>))</span>
<a name="1427"><font size=-1>1427     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1428"><font size=-1>1428     </font></a><span class="default"></span>
<a name="1429"><font size=-1>1429     </font></a><span class="default">        </span><span class="comment">// Set full varname..</span>
<a name="1430"><font size=-1>1430     </font></a><span class="comment">        <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> <a href="dictionary_V.html#27422">varname</a>;</span>
<a name="1431"><font size=-1>1431     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>() &amp;&amp; <a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>()-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;.&quot;</span><span class="default">) {</span>
<a name="1432"><font size=-1>1432     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_P.html#27423">parent</a> = <a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>();</span>
<a name="1433"><font size=-1>1433     </font></a><span class="default">            </span><span class="keyword">while </span><span class="default">(<a href="dictionary_P.html#27423">parent</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>() &amp;&amp; <a href="dictionary_P.html#27423">parent</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>()-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;.&quot;</span><span class="default">)</span>
<a name="1434"><font size=-1>1434     </font></a><span class="default">                <a href="dictionary_P.html#27423">parent</a> = <a href="dictionary_P.html#27423">parent</a>-&gt;<a href="dictionary_T.html#1433">astParent</a>();</span>
<a name="1435"><font size=-1>1435     </font></a><span class="default">            <a href="dictionary_V.html#27422">varname</a> = <a href="dictionary_P.html#27423">parent</a>-&gt;<a href="dictionary_T.html#2907">expressionString</a>();</span>
<a name="1436"><font size=-1>1436     </font></a><span class="default">        } </span><span class="keyword">else</span>
<a name="1437"><font size=-1>1437     </font></a><span class="keyword">            <a href="dictionary_V.html#27422">varname</a> </span><span class="default">= <a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>();</span>
<a name="1438"><font size=-1>1438     </font></a><span class="default"></span>
<a name="1439"><font size=-1>1439     </font></a><span class="default"></span>
<a name="1440"><font size=-1>1440     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27424">strtoken</a> </span><span class="default">= <a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#2857">getValueTokenMinStrSize</a>();</span>
<a name="1441"><font size=-1>1441     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27424">strtoken</a>) {</span>
<a name="1442"><font size=-1>1442     </font></a><span class="default">            <a href="dictionary_C.html#1800">ArrayInfo</a> <a href="dictionary_A.html#27425">arrayInfo</a>(<a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>(), <a href="dictionary_V.html#27422">varname</a>, </span><span class="number">1U</span><span class="default">, <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#8751">getStrSize</a>(<a href="dictionary_S.html#27424">strtoken</a>));</span>
<a name="1443"><font size=-1>1443     </font></a><span class="default">            <a href="dictionary_C.html#1856">valueFlowCheckArrayIndex</a>(<a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), <a href="dictionary_A.html#27425">arrayInfo</a>);</span>
<a name="1444"><font size=-1>1444     </font></a><span class="default">        }</span>
<a name="1445"><font size=-1>1445     </font></a><span class="default"></span>
<a name="1446"><font size=-1>1446     </font></a><span class="default">        </span><span class="keyword">else </span><span class="default">{</span>
<a name="1447"><font size=-1>1447     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_V.html#27426">var</a> </span><span class="default">= <a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>();</span>
<a name="1448"><font size=-1>1448     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_V.html#27426">var</a> || <a href="dictionary_V.html#27426">var</a>-&gt;<a href="dictionary_V.html#2646">nameToken</a>() == <a href="dictionary_T.html#27420">tok</a> || !<a href="dictionary_V.html#27426">var</a>-&gt;<a href="dictionary_V.html#2645">isArray</a>())</span>
<a name="1449"><font size=-1>1449     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1450"><font size=-1>1450     </font></a><span class="default"></span>
<a name="1451"><font size=-1>1451     </font></a><span class="default">            </span><span class="comment">// TODO: last array in struct..</span>
<a name="1452"><font size=-1>1452     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27426">var</a>-&gt;<a href="dictionary_V.html#8130">dimension</a>(</span><span class="number">0</span><span class="default">) &lt;= </span><span class="number">1 </span><span class="default">&amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1436">simpleMatch</a>(<a href="dictionary_V.html#27426">var</a>-&gt;<a href="dictionary_V.html#2646">nameToken</a>()-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">),</span><span class="string">&quot;] ; }&quot;</span><span class="default">))</span>
<a name="1453"><font size=-1>1453     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1454"><font size=-1>1454     </font></a><span class="default"></span>
<a name="1455"><font size=-1>1455     </font></a><span class="default">            <a href="dictionary_C.html#1800">ArrayInfo</a> <a href="dictionary_A.html#27427">arrayInfo</a>(<a href="dictionary_V.html#27426">var</a>, <a href="dictionary_C.html#1879">_tokenizer</a>, &amp;<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1024">library</a>);</span>
<a name="1456"><font size=-1>1456     </font></a><span class="default">            <a href="dictionary_A.html#27427">arrayInfo</a>.<a href="dictionary_C.html#1814">varname</a>(<a href="dictionary_V.html#27422">varname</a>);</span>
<a name="1457"><font size=-1>1457     </font></a><span class="default"></span>
<a name="1458"><font size=-1>1458     </font></a><span class="default">            <a href="dictionary_C.html#1856">valueFlowCheckArrayIndex</a>(<a href="dictionary_T.html#27420">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>(), <a href="dictionary_A.html#27427">arrayInfo</a>);</span>
<a name="1459"><font size=-1>1459     </font></a><span class="default">        }</span>
<a name="1460"><font size=-1>1460     </font></a><span class="default">    }</span>
<a name="1461"><font size=-1>1461     </font></a><span class="default">}</span>
<a name="1462"><font size=-1>1462     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1463"><font size=-1>1463     </font></a><span class="comment"></span>
<a name="1464"><font size=-1>1464     </font></a><span class="comment"><a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#257">biguint</a> <a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1789">countSprintfLength</a>(</span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_I.html#27428">input_string</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token*&gt; &amp;<a href="dictionary_P.html#27429">parameters</a>)</span>
<a name="1465"><font size=-1>1465     </font></a><span class="default">{</span>
<a name="1466"><font size=-1>1466     </font></a><span class="default">    </span><span class="keyword">bool <a href="dictionary_P.html#27430">percentCharFound</a> </span><span class="default">= </span><span class="keyword">false</span><span class="default">;</span>
<a name="1467"><font size=-1>1467     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27431">input_string_size</a> = </span><span class="number">1</span><span class="default">;</span>
<a name="1468"><font size=-1>1468     </font></a><span class="default">    </span><span class="keyword">bool <a href="dictionary_H.html#27432">handleNextParameter</a> </span><span class="default">= </span><span class="keyword">false</span><span class="default">;</span>
<a name="1469"><font size=-1>1469     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#44">string</a> <a href="dictionary_D.html#27433">digits_string</a>;</span>
<a name="1470"><font size=-1>1470     </font></a><span class="default">    </span><span class="keyword">bool <a href="dictionary_I.html#27434">i_d_x_f_found</a> </span><span class="default">= </span><span class="keyword">false</span><span class="default">;</span>
<a name="1471"><font size=-1>1471     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;</span><span class="keyword">const </span><span class="default">Token*&gt;::<a href="dictionary_S.html#4610">const_iterator</a> <a href="dictionary_P.html#27435">paramIter</a> = <a href="dictionary_P.html#27429">parameters</a>.<a href="dictionary_S.html#3264">begin</a>();</span>
<a name="1472"><font size=-1>1472     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_P.html#27436">parameterLength</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="1473"><font size=-1>1473     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#44">string</a>::<a href="dictionary_S.html#95">size_type</a> <a href="dictionary_I.html#146">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#146">i</a> &lt; <a href="dictionary_I.html#27428">input_string</a>.<a href="dictionary_S.html#270">length</a>(); ++<a href="dictionary_I.html#146">i</a>) {</span>
<a name="1474"><font size=-1>1474     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27428">input_string</a>[<a href="dictionary_I.html#146">i</a>] == </span><span class="string">'\\'</span><span class="default">) {</span>
<a name="1475"><font size=-1>1475     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#146">i</a> &lt; <a href="dictionary_I.html#27428">input_string</a>.<a href="dictionary_S.html#270">length</a>() - </span><span class="number">1 </span><span class="default">&amp;&amp; <a href="dictionary_I.html#27428">input_string</a>[<a href="dictionary_I.html#146">i</a> + </span><span class="number">1</span><span class="default">] == </span><span class="string">'0'</span><span class="default">)</span>
<a name="1476"><font size=-1>1476     </font></a><span class="default">                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1477"><font size=-1>1477     </font></a><span class="default"></span>
<a name="1478"><font size=-1>1478     </font></a><span class="default">            ++<a href="dictionary_I.html#27431">input_string_size</a>;</span>
<a name="1479"><font size=-1>1479     </font></a><span class="default">            ++<a href="dictionary_I.html#146">i</a>;</span>
<a name="1480"><font size=-1>1480     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1481"><font size=-1>1481     </font></a><span class="default">        }</span>
<a name="1482"><font size=-1>1482     </font></a><span class="default"></span>
<a name="1483"><font size=-1>1483     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27430">percentCharFound</a>) {</span>
<a name="1484"><font size=-1>1484     </font></a><span class="default">            </span><span class="keyword">switch </span><span class="default">(<a href="dictionary_I.html#27428">input_string</a>[<a href="dictionary_I.html#146">i</a>]) {</span>
<a name="1485"><font size=-1>1485     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'f'</span><span class="default">:</span>
<a name="1486"><font size=-1>1486     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'x'</span><span class="default">:</span>
<a name="1487"><font size=-1>1487     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'X'</span><span class="default">:</span>
<a name="1488"><font size=-1>1488     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'i'</span><span class="default">:</span>
<a name="1489"><font size=-1>1489     </font></a><span class="default">                <a href="dictionary_I.html#27434">i_d_x_f_found</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="1490"><font size=-1>1490     </font></a><span class="default">                <a href="dictionary_H.html#27432">handleNextParameter</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="1491"><font size=-1>1491     </font></a><span class="default">                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1492"><font size=-1>1492     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'c'</span><span class="default">:</span>
<a name="1493"><font size=-1>1493     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'e'</span><span class="default">:</span>
<a name="1494"><font size=-1>1494     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'E'</span><span class="default">:</span>
<a name="1495"><font size=-1>1495     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'g'</span><span class="default">:</span>
<a name="1496"><font size=-1>1496     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'o'</span><span class="default">:</span>
<a name="1497"><font size=-1>1497     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'u'</span><span class="default">:</span>
<a name="1498"><font size=-1>1498     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'p'</span><span class="default">:</span>
<a name="1499"><font size=-1>1499     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'n'</span><span class="default">:</span>
<a name="1500"><font size=-1>1500     </font></a><span class="default">                <a href="dictionary_H.html#27432">handleNextParameter</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="1501"><font size=-1>1501     </font></a><span class="default">                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1502"><font size=-1>1502     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'d'</span><span class="default">:</span>
<a name="1503"><font size=-1>1503     </font></a><span class="default">                <a href="dictionary_I.html#27434">i_d_x_f_found</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="1504"><font size=-1>1504     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27435">paramIter</a> != <a href="dictionary_P.html#27429">parameters</a>.<a href="dictionary_S.html#3265">end</a>() &amp;&amp; *<a href="dictionary_P.html#27435">paramIter</a> &amp;&amp; (*<a href="dictionary_P.html#27435">paramIter</a>)-&gt;<a href="dictionary_T.html#17913">tokType</a>() != <a href="dictionary_T.html#524">Token</a>::eString)</span>
<a name="1505"><font size=-1>1505     </font></a><span class="default">                    <a href="dictionary_P.html#27436">parameterLength</a> = (*<a href="dictionary_P.html#27435">paramIter</a>)-&gt;<a href="dictionary_S.html#148">str</a>().<a href="dictionary_L.html#2018">length</a>();</span>
<a name="1506"><font size=-1>1506     </font></a><span class="default"></span>
<a name="1507"><font size=-1>1507     </font></a><span class="default">                <a href="dictionary_H.html#27432">handleNextParameter</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="1508"><font size=-1>1508     </font></a><span class="default">                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1509"><font size=-1>1509     </font></a><span class="default">            </span><span class="keyword">case </span><span class="string">'s'</span><span class="default">:</span>
<a name="1510"><font size=-1>1510     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27435">paramIter</a> != <a href="dictionary_P.html#27429">parameters</a>.<a href="dictionary_S.html#3265">end</a>() &amp;&amp; *<a href="dictionary_P.html#27435">paramIter</a> &amp;&amp; (*<a href="dictionary_P.html#27435">paramIter</a>)-&gt;<a href="dictionary_T.html#17913">tokType</a>() == <a href="dictionary_T.html#524">Token</a>::eString)</span>
<a name="1511"><font size=-1>1511     </font></a><span class="default">                    <a href="dictionary_P.html#27436">parameterLength</a> = <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#2940">getStrLength</a>(*<a href="dictionary_P.html#27435">paramIter</a>);</span>
<a name="1512"><font size=-1>1512     </font></a><span class="default"></span>
<a name="1513"><font size=-1>1513     </font></a><span class="default">                <a href="dictionary_H.html#27432">handleNextParameter</a> = </span><span class="keyword">true</span><span class="default">;</span>
<a name="1514"><font size=-1>1514     </font></a><span class="default">                </span><span class="keyword">break</span><span class="default">;</span>
<a name="1515"><font size=-1>1515     </font></a><span class="default">            }</span>
<a name="1516"><font size=-1>1516     </font></a><span class="default">        }</span>
<a name="1517"><font size=-1>1517     </font></a><span class="default"></span>
<a name="1518"><font size=-1>1518     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27428">input_string</a>[<a href="dictionary_I.html#146">i</a>] == </span><span class="string">'%'</span><span class="default">)</span>
<a name="1519"><font size=-1>1519     </font></a><span class="default">            <a href="dictionary_P.html#27430">percentCharFound</a> = !<a href="dictionary_P.html#27430">percentCharFound</a>;</span>
<a name="1520"><font size=-1>1520     </font></a><span class="default">        </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_P.html#27430">percentCharFound</a>) {</span>
<a name="1521"><font size=-1>1521     </font></a><span class="default">            <a href="dictionary_D.html#27433">digits_string</a>.<a href="dictionary_S.html#1986">append</a>(</span><span class="number">1</span><span class="default">, <a href="dictionary_I.html#27428">input_string</a>[<a href="dictionary_I.html#146">i</a>]);</span>
<a name="1522"><font size=-1>1522     </font></a><span class="default">        }</span>
<a name="1523"><font size=-1>1523     </font></a><span class="default"></span>
<a name="1524"><font size=-1>1524     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_P.html#27430">percentCharFound</a>)</span>
<a name="1525"><font size=-1>1525     </font></a><span class="default">            <a href="dictionary_I.html#27431">input_string_size</a>++;</span>
<a name="1526"><font size=-1>1526     </font></a><span class="default"></span>
<a name="1527"><font size=-1>1527     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_H.html#27432">handleNextParameter</a>) {</span>
<a name="1528"><font size=-1>1528     </font></a><span class="default">            </span><span class="keyword">unsigned int <a href="dictionary_T.html#27437">tempDigits</a> </span><span class="default">= </span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">unsigned int</span><span class="default">&gt;(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#249">abs</a>(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#10076">atoi</a>(<a href="dictionary_D.html#27433">digits_string</a>.<a href="dictionary_S.html#87">c_str</a>())));</span>
<a name="1529"><font size=-1>1529     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27434">i_d_x_f_found</a>)</span>
<a name="1530"><font size=-1>1530     </font></a><span class="default">                <a href="dictionary_T.html#27437">tempDigits</a> = <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#6751">max</a>(</span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">unsigned int</span><span class="default">&gt;(<a href="dictionary_T.html#27437">tempDigits</a>), </span><span class="number">1U</span><span class="default">);</span>
<a name="1531"><font size=-1>1531     </font></a><span class="default"></span>
<a name="1532"><font size=-1>1532     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_D.html#27433">digits_string</a>.<a href="dictionary_S.html#89">find</a>(</span><span class="string">'.'</span><span class="default">) != <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#44">string</a>::<a href="dictionary_S.html#90">npos</a>) {</span>
<a name="1533"><font size=-1>1533     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> <a href="dictionary_E.html#27438">endStr</a> = <a href="dictionary_D.html#27433">digits_string</a>.<a href="dictionary_S.html#73">substr</a>(<a href="dictionary_D.html#27433">digits_string</a>.<a href="dictionary_S.html#89">find</a>(</span><span class="string">'.'</span><span class="default">) + </span><span class="number">1</span><span class="default">);</span>
<a name="1534"><font size=-1>1534     </font></a><span class="default">                </span><span class="keyword">const unsigned int <a href="dictionary_M.html#27439">maxLen</a> </span><span class="default">= <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#6751">max</a>(</span><span class="keyword">static_cast</span><span class="default">&lt;</span><span class="keyword">unsigned int</span><span class="default">&gt;(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#249">abs</a>(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#10076">atoi</a>(<a href="dictionary_E.html#27438">endStr</a>.<a href="dictionary_S.html#87">c_str</a>()))), </span><span class="number">1U</span><span class="default">);</span>
<a name="1535"><font size=-1>1535     </font></a><span class="default"></span>
<a name="1536"><font size=-1>1536     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27428">input_string</a>[<a href="dictionary_I.html#146">i</a>] == </span><span class="string">'s'</span><span class="default">) {</span>
<a name="1537"><font size=-1>1537     </font></a><span class="default">                    </span><span class="comment">// For strings, the length after the dot &quot;%.2s&quot; will limit</span>
<a name="1538"><font size=-1>1538     </font></a><span class="comment">                    // the length of the string.</span>
<a name="1539"><font size=-1>1539     </font></a><span class="comment">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27436">parameterLength</a> &gt; <a href="dictionary_M.html#27439">maxLen</a>)</span>
<a name="1540"><font size=-1>1540     </font></a><span class="default">                        <a href="dictionary_P.html#27436">parameterLength</a> = <a href="dictionary_M.html#27439">maxLen</a>;</span>
<a name="1541"><font size=-1>1541     </font></a><span class="default">                } </span><span class="keyword">else </span><span class="default">{</span>
<a name="1542"><font size=-1>1542     </font></a><span class="default">                    </span><span class="comment">// For integers, the length after the dot &quot;%.2d&quot; can</span>
<a name="1543"><font size=-1>1543     </font></a><span class="comment">                    // increase required length</span>
<a name="1544"><font size=-1>1544     </font></a><span class="comment">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27437">tempDigits</a> &lt; <a href="dictionary_M.html#27439">maxLen</a>)</span>
<a name="1545"><font size=-1>1545     </font></a><span class="default">                        <a href="dictionary_T.html#27437">tempDigits</a> = <a href="dictionary_M.html#27439">maxLen</a>;</span>
<a name="1546"><font size=-1>1546     </font></a><span class="default">                }</span>
<a name="1547"><font size=-1>1547     </font></a><span class="default">            }</span>
<a name="1548"><font size=-1>1548     </font></a><span class="default"></span>
<a name="1549"><font size=-1>1549     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27437">tempDigits</a> &lt; <a href="dictionary_P.html#27436">parameterLength</a>)</span>
<a name="1550"><font size=-1>1550     </font></a><span class="default">                <a href="dictionary_I.html#27431">input_string_size</a> += <a href="dictionary_P.html#27436">parameterLength</a>;</span>
<a name="1551"><font size=-1>1551     </font></a><span class="default">            </span><span class="keyword">else</span>
<a name="1552"><font size=-1>1552     </font></a><span class="keyword">                <a href="dictionary_I.html#27431">input_string_size</a> </span><span class="default">+= <a href="dictionary_T.html#27437">tempDigits</a>;</span>
<a name="1553"><font size=-1>1553     </font></a><span class="default"></span>
<a name="1554"><font size=-1>1554     </font></a><span class="default">            <a href="dictionary_P.html#27436">parameterLength</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="1555"><font size=-1>1555     </font></a><span class="default">            <a href="dictionary_D.html#27433">digits_string</a> = </span><span class="string">&quot;&quot;</span><span class="default">;</span>
<a name="1556"><font size=-1>1556     </font></a><span class="default">            <a href="dictionary_I.html#27434">i_d_x_f_found</a> = </span><span class="keyword">false</span><span class="default">;</span>
<a name="1557"><font size=-1>1557     </font></a><span class="default">            <a href="dictionary_P.html#27430">percentCharFound</a> = </span><span class="keyword">false</span><span class="default">;</span>
<a name="1558"><font size=-1>1558     </font></a><span class="default">            <a href="dictionary_H.html#27432">handleNextParameter</a> = </span><span class="keyword">false</span><span class="default">;</span>
<a name="1559"><font size=-1>1559     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27435">paramIter</a> != <a href="dictionary_P.html#27429">parameters</a>.<a href="dictionary_S.html#3265">end</a>())</span>
<a name="1560"><font size=-1>1560     </font></a><span class="default">                ++<a href="dictionary_P.html#27435">paramIter</a>;</span>
<a name="1561"><font size=-1>1561     </font></a><span class="default">        }</span>
<a name="1562"><font size=-1>1562     </font></a><span class="default">    }</span>
<a name="1563"><font size=-1>1563     </font></a><span class="default"></span>
<a name="1564"><font size=-1>1564     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_I.html#27431">input_string_size</a></span><span class="default">;</span>
<a name="1565"><font size=-1>1565     </font></a><span class="default">}</span>
<a name="1566"><font size=-1>1566     </font></a><span class="default"></span>
<a name="1567"><font size=-1>1567     </font></a><span class="default"></span>
<a name="1568"><font size=-1>1568     </font></a><span class="default"></span>
<a name="1569"><font size=-1>1569     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1570"><font size=-1>1570     </font></a><span class="comment">// Checking for allocating insufficient memory for copying a string by</span>
<a name="1571"><font size=-1>1571     </font></a><span class="comment">// allocating only strlen(src) bytes instead of strlen(src) + 1 bytes (one</span>
<a name="1572"><font size=-1>1572     </font></a><span class="comment">// extra for the terminating null character).</span>
<a name="1573"><font size=-1>1573     </font></a><span class="comment">// Example:</span>
<a name="1574"><font size=-1>1574     </font></a><span class="comment">//   char *b = malloc(strlen(a));   // Should be malloc(strlen(a) + 1);</span>
<a name="1575"><font size=-1>1575     </font></a><span class="comment">//   strcpy(b, a);                  // &lt;== Buffer overrun</span>
<a name="1576"><font size=-1>1576     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1577"><font size=-1>1577     </font></a><span class="comment"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1792">checkBufferAllocatedWithStrlen</a>()</span>
<a name="1578"><font size=-1>1578     </font></a><span class="default">{</span>
<a name="1579"><font size=-1>1579     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#1883">SymbolDatabase</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27440">symbolDatabase</a> </span><span class="default">= <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>();</span>
<a name="1580"><font size=-1>1580     </font></a><span class="default"></span>
<a name="1581"><font size=-1>1581     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_F.html#27441">functions</a> = <a href="dictionary_S.html#27440">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>.<a href="dictionary_S.html#1203">size</a>();</span>
<a name="1582"><font size=-1>1582     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27442">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27442">i</a> &lt; <a href="dictionary_F.html#27441">functions</a>; ++<a href="dictionary_I.html#27442">i</a>) {</span>
<a name="1583"><font size=-1>1583     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_S.html#606">Scope</a> </span><span class="default">* <a href="dictionary_S.html#27443">scope</a> = <a href="dictionary_S.html#27440">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>[<a href="dictionary_I.html#27442">i</a>];</span>
<a name="1584"><font size=-1>1584     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27444">tok</a> = <a href="dictionary_S.html#27443">scope</a>-&gt;<a href="dictionary_S.html#1889">classStart</a>-&gt;<a href="dictionary_T.html#1414">next</a>(); <a href="dictionary_T.html#27444">tok</a> &amp;&amp; <a href="dictionary_T.html#27444">tok</a> != <a href="dictionary_S.html#27443">scope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>; <a href="dictionary_T.html#27444">tok</a> = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1585"><font size=-1>1585     </font></a><span class="default">            </span><span class="keyword">unsigned int <a href="dictionary_D.html#27445">dstVarId</a></span><span class="default">;</span>
<a name="1586"><font size=-1>1586     </font></a><span class="default">            </span><span class="keyword">unsigned int <a href="dictionary_S.html#27446">srcVarId</a></span><span class="default">;</span>
<a name="1587"><font size=-1>1587     </font></a><span class="default"></span>
<a name="1588"><font size=-1>1588     </font></a><span class="default">            </span><span class="comment">// Look for allocation of a buffer based on the size of a string</span>
<a name="1589"><font size=-1>1589     </font></a><span class="comment">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27444">tok</a>, </span><span class="string">&quot;%var% = malloc|g_malloc|g_try_malloc ( strlen ( %name% ) )&quot;</span><span class="default">)) {</span>
<a name="1590"><font size=-1>1590     </font></a><span class="default">                <a href="dictionary_D.html#27445">dstVarId</a> = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1591"><font size=-1>1591     </font></a><span class="default">                <a href="dictionary_S.html#27446">srcVarId</a> = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">6</span><span class="default">)-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1592"><font size=-1>1592     </font></a><span class="default">                <a href="dictionary_T.html#27444">tok</a>      = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">8</span><span class="default">);</span>
<a name="1593"><font size=-1>1593     </font></a><span class="default">            } </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#653">isCPP</a>() &amp;&amp; <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27444">tok</a>, </span><span class="string">&quot;%var% = new char [ strlen ( %name% ) ]&quot;</span><span class="default">)) {</span>
<a name="1594"><font size=-1>1594     </font></a><span class="default">                <a href="dictionary_D.html#27445">dstVarId</a> = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1595"><font size=-1>1595     </font></a><span class="default">                <a href="dictionary_S.html#27446">srcVarId</a> = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">7</span><span class="default">)-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1596"><font size=-1>1596     </font></a><span class="default">                <a href="dictionary_T.html#27444">tok</a>      = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">9</span><span class="default">);</span>
<a name="1597"><font size=-1>1597     </font></a><span class="default">            } </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27444">tok</a>, </span><span class="string">&quot;%var% = realloc|g_realloc|g_try_realloc ( %name% , strlen ( %name% ) )&quot;</span><span class="default">)) {</span>
<a name="1598"><font size=-1>1598     </font></a><span class="default">                <a href="dictionary_D.html#27445">dstVarId</a> = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1599"><font size=-1>1599     </font></a><span class="default">                <a href="dictionary_S.html#27446">srcVarId</a> = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">8</span><span class="default">)-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1600"><font size=-1>1600     </font></a><span class="default">                <a href="dictionary_T.html#27444">tok</a>      = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">10</span><span class="default">);</span>
<a name="1601"><font size=-1>1601     </font></a><span class="default">            } </span><span class="keyword">else</span>
<a name="1602"><font size=-1>1602     </font></a><span class="keyword">                continue</span><span class="default">;</span>
<a name="1603"><font size=-1>1603     </font></a><span class="default"></span>
<a name="1604"><font size=-1>1604     </font></a><span class="default">            </span><span class="comment">// To avoid false positives and added complexity, we will only look for</span>
<a name="1605"><font size=-1>1605     </font></a><span class="comment">            // improper usage of the buffer within the block that it was allocated</span>
<a name="1606"><font size=-1>1606     </font></a><span class="comment">            </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_E.html#27447">end</a> </span><span class="default">= <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1928">scope</a>()-&gt;<a href="dictionary_T.html#1930">classEnd</a>; <a href="dictionary_T.html#27444">tok</a> &amp;&amp; <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>() &amp;&amp; <a href="dictionary_T.html#27444">tok</a> != <a href="dictionary_E.html#27447">end</a>; <a href="dictionary_T.html#27444">tok</a> = <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1607"><font size=-1>1607     </font></a><span class="default">                </span><span class="comment">// If the buffers are modified, we can't be sure of their sizes</span>
<a name="1608"><font size=-1>1608     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>() == <a href="dictionary_S.html#27446">srcVarId</a> || <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>() == <a href="dictionary_D.html#27445">dstVarId</a>)</span>
<a name="1609"><font size=-1>1609     </font></a><span class="default">                    </span><span class="keyword">break</span><span class="default">;</span>
<a name="1610"><font size=-1>1610     </font></a><span class="default"></span>
<a name="1611"><font size=-1>1611     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27444">tok</a>, </span><span class="string">&quot;strcpy ( %varid% , %var% )&quot;</span><span class="default">, <a href="dictionary_D.html#27445">dstVarId</a>) &amp;&amp;</span>
<a name="1612"><font size=-1>1612     </font></a><span class="default">                    <a href="dictionary_T.html#27444">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">4</span><span class="default">)-&gt;<a href="dictionary_T.html#1481">varId</a>() == <a href="dictionary_S.html#27446">srcVarId</a>) {</span>
<a name="1613"><font size=-1>1613     </font></a><span class="default">                    <a href="dictionary_C.html#1838">bufferOverrunError</a>(<a href="dictionary_T.html#27444">tok</a>);</span>
<a name="1614"><font size=-1>1614     </font></a><span class="default">                }</span>
<a name="1615"><font size=-1>1615     </font></a><span class="default">            }</span>
<a name="1616"><font size=-1>1616     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#27444">tok</a>)</span>
<a name="1617"><font size=-1>1617     </font></a><span class="default">                </span><span class="keyword">return</span><span class="default">;</span>
<a name="1618"><font size=-1>1618     </font></a><span class="default">        }</span>
<a name="1619"><font size=-1>1619     </font></a><span class="default">    }</span>
<a name="1620"><font size=-1>1620     </font></a><span class="default">}</span>
<a name="1621"><font size=-1>1621     </font></a><span class="default"></span>
<a name="1622"><font size=-1>1622     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1623"><font size=-1>1623     </font></a><span class="comment">// memcpy(temp, &quot;hello world&quot;, 50);</span>
<a name="1624"><font size=-1>1624     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1625"><font size=-1>1625     </font></a><span class="comment"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1793">checkStringArgument</a>()</span>
<a name="1626"><font size=-1>1626     </font></a><span class="default">{</span>
<a name="1627"><font size=-1>1627     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#1883">SymbolDatabase</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27448">symbolDatabase</a> </span><span class="default">= <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>();</span>
<a name="1628"><font size=-1>1628     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_F.html#27449">functions</a> = <a href="dictionary_S.html#27448">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>.<a href="dictionary_S.html#1203">size</a>();</span>
<a name="1629"><font size=-1>1629     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_F.html#27450">functionIndex</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_F.html#27450">functionIndex</a> &lt; <a href="dictionary_F.html#27449">functions</a>; ++<a href="dictionary_F.html#27450">functionIndex</a>) {</span>
<a name="1630"><font size=-1>1630     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_S.html#606">Scope</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27451">scope</a> </span><span class="default">= <a href="dictionary_S.html#27448">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>[<a href="dictionary_F.html#27450">functionIndex</a>];</span>
<a name="1631"><font size=-1>1631     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27452">tok</a> = <a href="dictionary_S.html#27451">scope</a>-&gt;<a href="dictionary_S.html#1889">classStart</a>; <a href="dictionary_T.html#27452">tok</a> != <a href="dictionary_S.html#27451">scope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>; <a href="dictionary_T.html#27452">tok</a> = <a href="dictionary_T.html#27452">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1632"><font size=-1>1632     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27452">tok</a>, </span><span class="string">&quot;%name% (&quot;</span><span class="default">) || !<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1024">library</a>.<a href="dictionary_L.html#17656">hasminsize</a>(<a href="dictionary_T.html#27452">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>()))</span>
<a name="1633"><font size=-1>1633     </font></a><span class="default">                </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1634"><font size=-1>1634     </font></a><span class="default"></span>
<a name="1635"><font size=-1>1635     </font></a><span class="default">            </span><span class="keyword">unsigned int <a href="dictionary_A.html#27453">argnr</a> </span><span class="default">= </span><span class="number">1</span><span class="default">;</span>
<a name="1636"><font size=-1>1636     </font></a><span class="default">            </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_A.html#27454">argtok</a> = <a href="dictionary_T.html#27452">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">); <a href="dictionary_A.html#27454">argtok</a>; <a href="dictionary_A.html#27454">argtok</a> = <a href="dictionary_A.html#27454">argtok</a>-&gt;<a href="dictionary_T.html#1911">nextArgument</a>(), <a href="dictionary_A.html#27453">argnr</a>++) {</span>
<a name="1637"><font size=-1>1637     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_A.html#27454">argtok</a>, </span><span class="string">&quot;%name%|%str% ,|)&quot;</span><span class="default">))</span>
<a name="1638"><font size=-1>1638     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1639"><font size=-1>1639     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27454">argtok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>() &amp;&amp; !<a href="dictionary_A.html#27454">argtok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>()-&gt;<a href="dictionary_T.html#2855">isPointer</a>())</span>
<a name="1640"><font size=-1>1640     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1641"><font size=-1>1641     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_S.html#27455">strtoken</a> = <a href="dictionary_A.html#27454">argtok</a>-&gt;<a href="dictionary_T.html#2857">getValueTokenMinStrSize</a>();</span>
<a name="1642"><font size=-1>1642     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_S.html#27455">strtoken</a>)</span>
<a name="1643"><font size=-1>1643     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1644"><font size=-1>1644     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;Library::ArgumentChecks::MinSize&gt; *<a href="dictionary_M.html#27456">minsizes</a> = <a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1024">library</a>.<a href="dictionary_L.html#6084">argminsizes</a>(<a href="dictionary_T.html#27452">tok</a>, <a href="dictionary_A.html#27453">argnr</a>);</span>
<a name="1645"><font size=-1>1645     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_M.html#27456">minsizes</a>)</span>
<a name="1646"><font size=-1>1646     </font></a><span class="default">                    </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1647"><font size=-1>1647     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#27223">checkMinSizes</a>(*<a href="dictionary_M.html#27456">minsizes</a>, <a href="dictionary_T.html#27452">tok</a>, <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#8751">getStrSize</a>(<a href="dictionary_S.html#27455">strtoken</a>), <a href="dictionary_N.html#1132">nullptr</a>, <a href="dictionary_C.html#1875">_settings</a>))</span>
<a name="1648"><font size=-1>1648     </font></a><span class="default">                    <a href="dictionary_C.html#1838">bufferOverrunError</a>(<a href="dictionary_A.html#27454">argtok</a>);</span>
<a name="1649"><font size=-1>1649     </font></a><span class="default">            }</span>
<a name="1650"><font size=-1>1650     </font></a><span class="default">        }</span>
<a name="1651"><font size=-1>1651     </font></a><span class="default">    }</span>
<a name="1652"><font size=-1>1652     </font></a><span class="default">}</span>
<a name="1653"><font size=-1>1653     </font></a><span class="default"></span>
<a name="1654"><font size=-1>1654     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1655"><font size=-1>1655     </font></a><span class="comment">// Checking for buffer overflow caused by copying command line arguments</span>
<a name="1656"><font size=-1>1656     </font></a><span class="comment">// into fixed-sized buffers without checking to make sure that the command</span>
<a name="1657"><font size=-1>1657     </font></a><span class="comment">// line arguments will not overflow the buffer.</span>
<a name="1658"><font size=-1>1658     </font></a><span class="comment">//</span>
<a name="1659"><font size=-1>1659     </font></a><span class="comment">// int main(int argc, char* argv[])</span>
<a name="1660"><font size=-1>1660     </font></a><span class="comment">// {</span>
<a name="1661"><font size=-1>1661     </font></a><span class="comment">//   char prog[10];</span>
<a name="1662"><font size=-1>1662     </font></a><span class="comment">//   strcpy(prog, argv[0]);      &lt;-- Possible buffer overrun</span>
<a name="1663"><font size=-1>1663     </font></a><span class="comment">// }</span>
<a name="1664"><font size=-1>1664     </font></a><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1665"><font size=-1>1665     </font></a><span class="comment"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1794">checkInsecureCmdLineArgs</a>()</span>
<a name="1666"><font size=-1>1666     </font></a><span class="default">{</span>
<a name="1667"><font size=-1>1667     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#1883">SymbolDatabase</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27457">symbolDatabase</a> </span><span class="default">= <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>();</span>
<a name="1668"><font size=-1>1668     </font></a><span class="default"></span>
<a name="1669"><font size=-1>1669     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_F.html#27458">functions</a> = <a href="dictionary_S.html#27457">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>.<a href="dictionary_S.html#1203">size</a>();</span>
<a name="1670"><font size=-1>1670     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27459">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27459">i</a> &lt; <a href="dictionary_F.html#27458">functions</a>; ++<a href="dictionary_I.html#27459">i</a>) {</span>
<a name="1671"><font size=-1>1671     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_F.html#536">Function</a> </span><span class="default">* <a href="dictionary_F.html#27460">function</a> = <a href="dictionary_S.html#27457">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>[<a href="dictionary_I.html#27459">i</a>]-&gt;<a href="dictionary_F.html#8173">function</a>;</span>
<a name="1672"><font size=-1>1672     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_F.html#27460">function</a>) {</span>
<a name="1673"><font size=-1>1673     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* <a href="dictionary_T.html#27461">tok</a> = <a href="dictionary_F.html#27460">function</a>-&gt;<a href="dictionary_F.html#3870">token</a>;</span>
<a name="1674"><font size=-1>1674     </font></a><span class="default"></span>
<a name="1675"><font size=-1>1675     </font></a><span class="default">            </span><span class="comment">// Get the name of the argv variable</span>
<a name="1676"><font size=-1>1676     </font></a><span class="comment">            </span><span class="keyword">unsigned int <a href="dictionary_V.html#27462">varid</a> </span><span class="default">= </span><span class="number">0</span><span class="default">;</span>
<a name="1677"><font size=-1>1677     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27461">tok</a>, </span><span class="string">&quot;main ( int %var% , char * %var% [ ] ,|)&quot;</span><span class="default">)) {</span>
<a name="1678"><font size=-1>1678     </font></a><span class="default">                <a href="dictionary_V.html#27462">varid</a> = <a href="dictionary_T.html#27461">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">7</span><span class="default">)-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1679"><font size=-1>1679     </font></a><span class="default"></span>
<a name="1680"><font size=-1>1680     </font></a><span class="default">            } </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27461">tok</a>, </span><span class="string">&quot;main ( int %var% , char * * %var% ,|)&quot;</span><span class="default">)) {</span>
<a name="1681"><font size=-1>1681     </font></a><span class="default">                <a href="dictionary_V.html#27462">varid</a> = <a href="dictionary_T.html#27461">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">8</span><span class="default">)-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1682"><font size=-1>1682     </font></a><span class="default">            } </span><span class="keyword">else</span>
<a name="1683"><font size=-1>1683     </font></a><span class="keyword">                continue</span><span class="default">;</span>
<a name="1684"><font size=-1>1684     </font></a><span class="default"></span>
<a name="1685"><font size=-1>1685     </font></a><span class="default">            </span><span class="comment">// Jump to the opening curly brace</span>
<a name="1686"><font size=-1>1686     </font></a><span class="comment">            <a href="dictionary_T.html#27461">tok</a> </span><span class="default">= <a href="dictionary_S.html#27457">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>[<a href="dictionary_I.html#27459">i</a>]-&gt;<a href="dictionary_C.html#4991">classStart</a>;</span>
<a name="1687"><font size=-1>1687     </font></a><span class="default"></span>
<a name="1688"><font size=-1>1688     </font></a><span class="default">            </span><span class="comment">// Search within main() for possible buffer overruns involving argv</span>
<a name="1689"><font size=-1>1689     </font></a><span class="comment">            </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a></span><span class="default">* <a href="dictionary_E.html#27463">end</a> = <a href="dictionary_T.html#27461">tok</a>-&gt;<a href="dictionary_T.html#1482">link</a>(); <a href="dictionary_T.html#27461">tok</a> != <a href="dictionary_E.html#27463">end</a>; <a href="dictionary_T.html#27461">tok</a> = <a href="dictionary_T.html#27461">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1690"><font size=-1>1690     </font></a><span class="default">                </span><span class="comment">// If argv is modified or tested, its size may be being limited properly</span>
<a name="1691"><font size=-1>1691     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27461">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>() == <a href="dictionary_V.html#27462">varid</a>)</span>
<a name="1692"><font size=-1>1692     </font></a><span class="default">                    </span><span class="keyword">break</span><span class="default">;</span>
<a name="1693"><font size=-1>1693     </font></a><span class="default"></span>
<a name="1694"><font size=-1>1694     </font></a><span class="default">                </span><span class="comment">// Match common patterns that can result in a buffer overrun</span>
<a name="1695"><font size=-1>1695     </font></a><span class="comment">                // e.g. strcpy(buffer, argv[0])</span>
<a name="1696"><font size=-1>1696     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27461">tok</a>, </span><span class="string">&quot;strcpy|strcat ( %name% , * %varid%&quot;</span><span class="default">, <a href="dictionary_V.html#27462">varid</a>) ||</span>
<a name="1697"><font size=-1>1697     </font></a><span class="default">                    <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27461">tok</a>, </span><span class="string">&quot;strcpy|strcat ( %name% , %varid% [&quot;</span><span class="default">, <a href="dictionary_V.html#27462">varid</a>)) {</span>
<a name="1698"><font size=-1>1698     </font></a><span class="default">                    <a href="dictionary_C.html#1851">cmdLineArgsError</a>(<a href="dictionary_T.html#27461">tok</a>);</span>
<a name="1699"><font size=-1>1699     </font></a><span class="default">                    <a href="dictionary_T.html#27461">tok</a> = <a href="dictionary_T.html#27461">tok</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">);</span>
<a name="1700"><font size=-1>1700     </font></a><span class="default">                }</span>
<a name="1701"><font size=-1>1701     </font></a><span class="default">            }</span>
<a name="1702"><font size=-1>1702     </font></a><span class="default">        }</span>
<a name="1703"><font size=-1>1703     </font></a><span class="default">    }</span>
<a name="1704"><font size=-1>1704     </font></a><span class="default">}</span>
<a name="1705"><font size=-1>1705     </font></a><span class="default"></span><span class="comment">//---------------------------------------------------------------------------</span>
<a name="1706"><font size=-1>1706     </font></a><span class="comment"></span>
<a name="1707"><font size=-1>1707     </font></a><span class="comment"></span>
<a name="1708"><font size=-1>1708     </font></a><span class="comment"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1847">negativeIndexError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27464">tok</a>, <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_I.html#27465">index</a>)</span>
<a name="1709"><font size=-1>1709     </font></a><span class="default">{</span>
<a name="1710"><font size=-1>1710     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#142">ostringstream</a> <a href="dictionary_O.html#230">ostr</a>;</span>
<a name="1711"><font size=-1>1711     </font></a><span class="default">    <a href="dictionary_O.html#230">ostr</a> &lt;&lt; </span><span class="string">&quot;Array index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27465">index</a> &lt;&lt; </span><span class="string">&quot; is out of bounds.&quot;</span><span class="default">;</span>
<a name="1712"><font size=-1>1712     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27464">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;negativeIndex&quot;</span><span class="default">, <a href="dictionary_O.html#230">ostr</a>.<a href="dictionary_S.html#148">str</a>());</span>
<a name="1713"><font size=-1>1713     </font></a><span class="default">}</span>
<a name="1714"><font size=-1>1714     </font></a><span class="default"></span>
<a name="1715"><font size=-1>1715     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1848">negativeIndexError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27466">tok</a>, </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> &amp;<a href="dictionary_I.html#27467">index</a>)</span>
<a name="1716"><font size=-1>1716     </font></a><span class="default">{</span>
<a name="1717"><font size=-1>1717     </font></a><span class="default">    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#142">ostringstream</a> <a href="dictionary_O.html#230">ostr</a>;</span>
<a name="1718"><font size=-1>1718     </font></a><span class="default">    <a href="dictionary_O.html#230">ostr</a> &lt;&lt; </span><span class="string">&quot;Array index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27467">index</a>.<a href="dictionary_V.html#5807">intvalue</a> &lt;&lt; </span><span class="string">&quot; is out of bounds.&quot;</span><span class="default">;</span>
<a name="1719"><font size=-1>1719     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27467">index</a>.<a href="dictionary_V.html#5810">condition</a>)</span>
<a name="1720"><font size=-1>1720     </font></a><span class="default">        <a href="dictionary_O.html#230">ostr</a> &lt;&lt; </span><span class="string">&quot; Otherwise there is useless condition at line &quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27467">index</a>.<a href="dictionary_V.html#5810">condition</a>-&gt;<a href="dictionary_T.html#3883">linenr</a>() &lt;&lt; </span><span class="string">&quot;.&quot;</span><span class="default">;</span>
<a name="1721"><font size=-1>1721     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27466">tok</a>, <a href="dictionary_I.html#27467">index</a>.<a href="dictionary_V.html#5810">condition</a> ? <a href="dictionary_S.html#1381">Severity</a>::warning : <a href="dictionary_S.html#1381">Severity</a>::error, </span><span class="string">&quot;negativeIndex&quot;</span><span class="default">, <a href="dictionary_O.html#230">ostr</a>.<a href="dictionary_S.html#148">str</a>(), </span><span class="number">0U</span><span class="default">, <a href="dictionary_I.html#27467">index</a>.<a href="dictionary_V.html#5813">inconclusive</a>);</span>
<a name="1722"><font size=-1>1722     </font></a><span class="default">}</span>
<a name="1723"><font size=-1>1723     </font></a><span class="default"></span>
<a name="1724"><font size=-1>1724     </font></a><span class="default"><a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1795">ArrayInfo</a>::<a href="dictionary_C.html#1800">ArrayInfo</a>()</span>
<a name="1725"><font size=-1>1725     </font></a><span class="default">    : <a href="dictionary_C.html#1798">_element_size</a>(</span><span class="number">0</span><span class="default">), <a href="dictionary_C.html#1799">_declarationId</a>(</span><span class="number">0</span><span class="default">)</span>
<a name="1726"><font size=-1>1726     </font></a><span class="default">{</span>
<a name="1727"><font size=-1>1727     </font></a><span class="default">}</span>
<a name="1728"><font size=-1>1728     </font></a><span class="default"></span>
<a name="1729"><font size=-1>1729     </font></a><span class="default"><a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1795">ArrayInfo</a>::<a href="dictionary_C.html#1801">ArrayInfo</a>(</span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">*<a href="dictionary_V.html#27468">var</a>, </span><span class="keyword">const <a href="dictionary_T.html#504">Tokenizer</a> </span><span class="default">*<a href="dictionary_T.html#27469">tokenizer</a>, </span><span class="keyword">const <a href="dictionary_L.html#620">Library</a> </span><span class="default">*<a href="dictionary_L.html#27470">library</a>, </span><span class="keyword">const unsigned int <a href="dictionary_F.html#27471">forcedeclid</a></span><span class="default">)</span>
<a name="1730"><font size=-1>1730     </font></a><span class="default">    : <a href="dictionary_C.html#1797">_varname</a>(<a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#5045">name</a>()), <a href="dictionary_C.html#1799">_declarationId</a>((<a href="dictionary_F.html#27471">forcedeclid</a> == </span><span class="number">0U</span><span class="default">) ? <a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#4822">declarationId</a>() : <a href="dictionary_F.html#27471">forcedeclid</a>)</span>
<a name="1731"><font size=-1>1731     </font></a><span class="default">{</span>
<a name="1732"><font size=-1>1732     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27472">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27472">i</a> &lt; <a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#8129">dimensions</a>().<a href="dictionary_S.html#1203">size</a>(); <a href="dictionary_I.html#27472">i</a>++)</span>
<a name="1733"><font size=-1>1733     </font></a><span class="default">        <a href="dictionary_C.html#1796">_num</a>.<a href="dictionary_P.html#1100">push_back</a>(<a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#8130">dimension</a>(<a href="dictionary_I.html#27472">i</a>));</span>
<a name="1734"><font size=-1>1734     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#5008">typeEndToken</a>()-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;*&quot;</span><span class="default">)</span>
<a name="1735"><font size=-1>1735     </font></a><span class="default">        <a href="dictionary_C.html#1798">_element_size</a> = <a href="dictionary_T.html#27469">tokenizer</a>-&gt;<a href="dictionary_T.html#8527">sizeOfType</a>(<a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#5008">typeEndToken</a>());</span>
<a name="1736"><font size=-1>1736     </font></a><span class="default">    </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#2918">typeStartToken</a>()-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;struct&quot;</span><span class="default">)</span>
<a name="1737"><font size=-1>1737     </font></a><span class="default">        <a href="dictionary_C.html#1798">_element_size</a> = </span><span class="number">100</span><span class="default">;</span>
<a name="1738"><font size=-1>1738     </font></a><span class="default">    </span><span class="keyword">else </span><span class="default">{</span>
<a name="1739"><font size=-1>1739     </font></a><span class="default">        <a href="dictionary_C.html#1798">_element_size</a> = <a href="dictionary_T.html#27469">tokenizer</a>-&gt;<a href="dictionary_T.html#8527">sizeOfType</a>(<a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#5008">typeEndToken</a>());</span>
<a name="1740"><font size=-1>1740     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_C.html#1798">_element_size</a>) { </span><span class="comment">// try libary</span>
<a name="1741"><font size=-1>1741     </font></a><span class="comment">            </span><span class="keyword">const <a href="dictionary_L.html#620">Library</a></span><span class="default">::<a href="dictionary_L.html#1294">PodType</a>* <a href="dictionary_P.html#27473">podtype</a> = <a href="dictionary_L.html#27470">library</a>-&gt;<a href="dictionary_L.html#6110">podtype</a>(<a href="dictionary_V.html#27468">var</a>-&gt;<a href="dictionary_V.html#5008">typeEndToken</a>()-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="1742"><font size=-1>1742     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_P.html#27473">podtype</a>)</span>
<a name="1743"><font size=-1>1743     </font></a><span class="default">                <a href="dictionary_C.html#1798">_element_size</a> = <a href="dictionary_P.html#27473">podtype</a>-&gt;<a href="dictionary_L.html#1296">size</a>;</span>
<a name="1744"><font size=-1>1744     </font></a><span class="default">        }</span>
<a name="1745"><font size=-1>1745     </font></a><span class="default">    }</span>
<a name="1746"><font size=-1>1746     </font></a><span class="default">}</span>
<a name="1747"><font size=-1>1747     </font></a><span class="default"></span>
<a name="1748"><font size=-1>1748     </font></a><span class="default"></span><span class="comment">/**</span>
<a name="1749"><font size=-1>1749     </font></a><span class="comment"> * Create array info with specified data</span>
<a name="1750"><font size=-1>1750     </font></a><span class="comment"> * The intention is that this is only a temporary solution.. all</span>
<a name="1751"><font size=-1>1751     </font></a><span class="comment"> * checking should be based on ArrayInfo from the start and then</span>
<a name="1752"><font size=-1>1752     </font></a><span class="comment"> * this will not be needed as the declare can be used instead.</span>
<a name="1753"><font size=-1>1753     </font></a><span class="comment"> */</span>
<a name="1754"><font size=-1>1754     </font></a><span class="comment"><a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1795">ArrayInfo</a>::<a href="dictionary_C.html#1802">ArrayInfo</a>(</span><span class="keyword">unsigned int <a href="dictionary_I.html#27474">id</a></span><span class="default">, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_N.html#27475">name</a>, <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_S.html#27476">size1</a>, <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_N.html#27477">n</a>)</span>
<a name="1755"><font size=-1>1755     </font></a><span class="default">    : <a href="dictionary_C.html#1797">_varname</a>(<a href="dictionary_N.html#27475">name</a>), <a href="dictionary_C.html#1798">_element_size</a>(<a href="dictionary_S.html#27476">size1</a>), <a href="dictionary_C.html#1799">_declarationId</a>(<a href="dictionary_I.html#27474">id</a>)</span>
<a name="1756"><font size=-1>1756     </font></a><span class="default">{</span>
<a name="1757"><font size=-1>1757     </font></a><span class="default">    <a href="dictionary_C.html#1796">_num</a>.<a href="dictionary_P.html#1100">push_back</a>(<a href="dictionary_N.html#27477">n</a>);</span>
<a name="1758"><font size=-1>1758     </font></a><span class="default">}</span>
<a name="1759"><font size=-1>1759     </font></a><span class="default"></span>
<a name="1760"><font size=-1>1760     </font></a><span class="default"><a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1795">ArrayInfo</a> <a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1795">ArrayInfo</a>::<a href="dictionary_C.html#1803">limit</a>(<a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_V.html#27478">value</a>) </span><span class="keyword">const</span>
<a name="1761"><font size=-1>1761     </font></a><span class="keyword"></span><span class="default">{</span>
<a name="1762"><font size=-1>1762     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_U.html#27479">uvalue</a> = <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#6751">max</a>(<a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a>(</span><span class="number">0</span><span class="default">), <a href="dictionary_V.html#27478">value</a>);</span>
<a name="1763"><font size=-1>1763     </font></a><span class="default">    <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_N.html#27480">n</a> = </span><span class="number">1</span><span class="default">;</span>
<a name="1764"><font size=-1>1764     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27481">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27481">i</a> &lt; <a href="dictionary_C.html#1796">_num</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27481">i</a>)</span>
<a name="1765"><font size=-1>1765     </font></a><span class="default">        <a href="dictionary_N.html#27480">n</a> *= <a href="dictionary_C.html#1796">_num</a>[<a href="dictionary_I.html#27481">i</a>];</span>
<a name="1766"><font size=-1>1766     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_U.html#27479">uvalue</a> &gt; <a href="dictionary_N.html#27480">n</a>)</span>
<a name="1767"><font size=-1>1767     </font></a><span class="default">        <a href="dictionary_N.html#27480">n</a> = <a href="dictionary_U.html#27479">uvalue</a>;</span>
<a name="1768"><font size=-1>1768     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_C.html#1800">ArrayInfo</a></span><span class="default">(<a href="dictionary_C.html#1799">_declarationId</a>, <a href="dictionary_C.html#1797">_varname</a>, <a href="dictionary_C.html#1798">_element_size</a>, <a href="dictionary_N.html#27480">n</a> - <a href="dictionary_U.html#27479">uvalue</a>);</span>
<a name="1769"><font size=-1>1769     </font></a><span class="default">}</span>
<a name="1770"><font size=-1>1770     </font></a><span class="default"></span>
<a name="1771"><font size=-1>1771     </font></a><span class="default"><a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1795">ArrayInfo</a>::<a href="dictionary_C.html#1817">numberOfElements</a>() </span><span class="keyword">const</span>
<a name="1772"><font size=-1>1772     </font></a><span class="keyword"></span><span class="default">{</span>
<a name="1773"><font size=-1>1773     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_C.html#1796">_num</a>.<a href="dictionary_E.html#2016">empty</a>())</span>
<a name="1774"><font size=-1>1774     </font></a><span class="default">        </span><span class="keyword">return </span><span class="number">0</span><span class="default">;</span>
<a name="1775"><font size=-1>1775     </font></a><span class="default"></span>
<a name="1776"><font size=-1>1776     </font></a><span class="default">    </span><span class="comment">// total number of elements of array..</span>
<a name="1777"><font size=-1>1777     </font></a><span class="comment">    <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_R.html#27482">ret</a> = </span><span class="number">1</span><span class="default">;</span>
<a name="1778"><font size=-1>1778     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27483">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27483">i</a> &lt; <a href="dictionary_C.html#1796">_num</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27483">i</a>) {</span>
<a name="1779"><font size=-1>1779     </font></a><span class="default">        <a href="dictionary_R.html#27482">ret</a> *= <a href="dictionary_C.html#1796">_num</a>[<a href="dictionary_I.html#27483">i</a>];</span>
<a name="1780"><font size=-1>1780     </font></a><span class="default">    }</span>
<a name="1781"><font size=-1>1781     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_R.html#27482">ret</a></span><span class="default">;</span>
<a name="1782"><font size=-1>1782     </font></a><span class="default">}</span>
<a name="1783"><font size=-1>1783     </font></a><span class="default"></span>
<a name="1784"><font size=-1>1784     </font></a><span class="default"><a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1795">ArrayInfo</a>::<a href="dictionary_C.html#1818">totalIndex</a>(</span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1095">vector</a>&lt;ValueFlow::Value&gt; &amp;<a href="dictionary_I.html#27484">indexes</a>) </span><span class="keyword">const</span>
<a name="1785"><font size=-1>1785     </font></a><span class="keyword"></span><span class="default">{</span>
<a name="1786"><font size=-1>1786     </font></a><span class="default">    <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_I.html#27485">index</a> = </span><span class="number">0</span><span class="default">;</span>
<a name="1787"><font size=-1>1787     </font></a><span class="default">    <a href="dictionary_M.html#203">MathLib</a>::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_E.html#27486">elements</a> = </span><span class="number">1</span><span class="default">;</span>
<a name="1788"><font size=-1>1788     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27487">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27487">i</a> &lt; <a href="dictionary_C.html#1796">_num</a>.<a href="dictionary_S.html#1203">size</a>(); ++<a href="dictionary_I.html#27487">i</a>) {</span>
<a name="1789"><font size=-1>1789     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_R.html#27488">ri</a> = <a href="dictionary_C.html#1796">_num</a>.<a href="dictionary_S.html#1203">size</a>() - </span><span class="number">1U </span><span class="default">- <a href="dictionary_I.html#27487">i</a>;</span>
<a name="1790"><font size=-1>1790     </font></a><span class="default">        <a href="dictionary_I.html#27485">index</a> += <a href="dictionary_I.html#27484">indexes</a>[<a href="dictionary_R.html#27488">ri</a>].<a href="dictionary_I.html#6658">intvalue</a> * <a href="dictionary_E.html#27486">elements</a>;</span>
<a name="1791"><font size=-1>1791     </font></a><span class="default">        <a href="dictionary_E.html#27486">elements</a> *= <a href="dictionary_C.html#1796">_num</a>[<a href="dictionary_R.html#27488">ri</a>];</span>
<a name="1792"><font size=-1>1792     </font></a><span class="default">    }</span>
<a name="1793"><font size=-1>1793     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_I.html#27485">index</a></span><span class="default">;</span>
<a name="1794"><font size=-1>1794     </font></a><span class="default">}</span>
<a name="1795"><font size=-1>1795     </font></a><span class="default"></span>
<a name="1796"><font size=-1>1796     </font></a><span class="default"></span>
<a name="1797"><font size=-1>1797     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1787">arrayIndexThenCheck</a>()</span>
<a name="1798"><font size=-1>1798     </font></a><span class="default">{</span>
<a name="1799"><font size=-1>1799     </font></a><span class="default">    </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_C.html#1875">_settings</a>-&gt;<a href="dictionary_S.html#1876">isEnabled</a>(</span><span class="string">&quot;style&quot;</span><span class="default">))</span>
<a name="1800"><font size=-1>1800     </font></a><span class="default">        </span><span class="keyword">return</span><span class="default">;</span>
<a name="1801"><font size=-1>1801     </font></a><span class="default"></span>
<a name="1802"><font size=-1>1802     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#1883">SymbolDatabase</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27489">symbolDatabase</a> </span><span class="default">= <a href="dictionary_C.html#1879">_tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>();</span>
<a name="1803"><font size=-1>1803     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_F.html#27490">functions</a> = <a href="dictionary_S.html#27489">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>.<a href="dictionary_S.html#1203">size</a>();</span>
<a name="1804"><font size=-1>1804     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27491">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27491">i</a> &lt; <a href="dictionary_F.html#27490">functions</a>; ++<a href="dictionary_I.html#27491">i</a>) {</span>
<a name="1805"><font size=-1>1805     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_S.html#606">Scope</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27492">scope</a> </span><span class="default">= <a href="dictionary_S.html#27489">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>[<a href="dictionary_I.html#27491">i</a>];</span>
<a name="1806"><font size=-1>1806     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27493">tok</a> = <a href="dictionary_S.html#27492">scope</a>-&gt;<a href="dictionary_S.html#1889">classStart</a>; <a href="dictionary_T.html#27493">tok</a> &amp;&amp; <a href="dictionary_T.html#27493">tok</a> != <a href="dictionary_S.html#27492">scope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>; <a href="dictionary_T.html#27493">tok</a> = <a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1807"><font size=-1>1807     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27493">tok</a>, </span><span class="string">&quot;%name% [ %var% ]&quot;</span><span class="default">)) {</span>
<a name="1808"><font size=-1>1808     </font></a><span class="default">                <a href="dictionary_T.html#27493">tok</a> = <a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="1809"><font size=-1>1809     </font></a><span class="default"></span>
<a name="1810"><font size=-1>1810     </font></a><span class="default">                </span><span class="keyword">const unsigned int <a href="dictionary_I.html#27494">indexID</a> </span><span class="default">= <a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1481">varId</a>();</span>
<a name="1811"><font size=-1>1811     </font></a><span class="default">                </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a>&amp; <a href="dictionary_I.html#27495">indexName</a>(<a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="1812"><font size=-1>1812     </font></a><span class="default"></span>
<a name="1813"><font size=-1>1813     </font></a><span class="default">                </span><span class="comment">// skip array index..</span>
<a name="1814"><font size=-1>1814     </font></a><span class="comment">                <a href="dictionary_T.html#27493">tok</a> </span><span class="default">= <a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="1815"><font size=-1>1815     </font></a><span class="default">                </span><span class="keyword">while </span><span class="default">(<a href="dictionary_T.html#27493">tok</a> &amp;&amp; <a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;[&quot;</span><span class="default">)</span>
<a name="1816"><font size=-1>1816     </font></a><span class="default">                    <a href="dictionary_T.html#27493">tok</a> = <a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1482">link</a>()-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="1817"><font size=-1>1817     </font></a><span class="default"></span>
<a name="1818"><font size=-1>1818     </font></a><span class="default">                </span><span class="comment">// syntax error</span>
<a name="1819"><font size=-1>1819     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#27493">tok</a>)</span>
<a name="1820"><font size=-1>1820     </font></a><span class="default">                    </span><span class="keyword">return</span><span class="default">;</span>
<a name="1821"><font size=-1>1821     </font></a><span class="default"></span>
<a name="1822"><font size=-1>1822     </font></a><span class="default">                </span><span class="comment">// skip comparison</span>
<a name="1823"><font size=-1>1823     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#2894">tokType</a>() == <a href="dictionary_T.html#524">Token</a>::eComparisonOp)</span>
<a name="1824"><font size=-1>1824     </font></a><span class="default">                    <a href="dictionary_T.html#27493">tok</a> = <a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1437">tokAt</a>(</span><span class="number">2</span><span class="default">);</span>
<a name="1825"><font size=-1>1825     </font></a><span class="default"></span>
<a name="1826"><font size=-1>1826     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_T.html#27493">tok</a>)</span>
<a name="1827"><font size=-1>1827     </font></a><span class="default">                    </span><span class="keyword">break</span><span class="default">;</span>
<a name="1828"><font size=-1>1828     </font></a><span class="default">                </span><span class="comment">// skip close parentheses</span>
<a name="1829"><font size=-1>1829     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>() == </span><span class="string">&quot;)&quot;</span><span class="default">)</span>
<a name="1830"><font size=-1>1830     </font></a><span class="default">                    <a href="dictionary_T.html#27493">tok</a> = <a href="dictionary_T.html#27493">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>();</span>
<a name="1831"><font size=-1>1831     </font></a><span class="default"></span>
<a name="1832"><font size=-1>1832     </font></a><span class="default">                </span><span class="comment">// check if array index is ok</span>
<a name="1833"><font size=-1>1833     </font></a><span class="comment">                // statement can be closed in parentheses, so &quot;(| &quot; is using</span>
<a name="1834"><font size=-1>1834     </font></a><span class="comment">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27493">tok</a>, </span><span class="string">&quot;&amp;&amp; (| %varid% &lt;|&lt;=&quot;</span><span class="default">, <a href="dictionary_I.html#27494">indexID</a>))</span>
<a name="1835"><font size=-1>1835     </font></a><span class="default">                    <a href="dictionary_C.html#1853">arrayIndexThenCheckError</a>(<a href="dictionary_T.html#27493">tok</a>, <a href="dictionary_I.html#27495">indexName</a>);</span>
<a name="1836"><font size=-1>1836     </font></a><span class="default">                </span><span class="keyword">else if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27493">tok</a>, </span><span class="string">&quot;&amp;&amp; (| %any% &gt;|&gt;= %varid% !!+&quot;</span><span class="default">, <a href="dictionary_I.html#27494">indexID</a>))</span>
<a name="1837"><font size=-1>1837     </font></a><span class="default">                    <a href="dictionary_C.html#1853">arrayIndexThenCheckError</a>(<a href="dictionary_T.html#27493">tok</a>, <a href="dictionary_I.html#27495">indexName</a>);</span>
<a name="1838"><font size=-1>1838     </font></a><span class="default">            }</span>
<a name="1839"><font size=-1>1839     </font></a><span class="default">        }</span>
<a name="1840"><font size=-1>1840     </font></a><span class="default">    }</span>
<a name="1841"><font size=-1>1841     </font></a><span class="default">}</span>
<a name="1842"><font size=-1>1842     </font></a><span class="default"></span>
<a name="1843"><font size=-1>1843     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1853">arrayIndexThenCheckError</a>(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27496">tok</a>, </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#44">string</a> &amp;<a href="dictionary_I.html#27497">indexName</a>)</span>
<a name="1844"><font size=-1>1844     </font></a><span class="default">{</span>
<a name="1845"><font size=-1>1845     </font></a><span class="default">    <a href="dictionary_C.html#1865">reportError</a>(<a href="dictionary_T.html#27496">tok</a>, <a href="dictionary_S.html#1381">Severity</a>::style, </span><span class="string">&quot;arrayIndexThenCheck&quot;</span><span class="default">,</span>
<a name="1846"><font size=-1>1846     </font></a><span class="default">                </span><span class="string">&quot;Array index '&quot; </span><span class="default">+ <a href="dictionary_I.html#27497">indexName</a> + </span><span class="string">&quot;' is used before limits check.\n&quot;</span>
<a name="1847"><font size=-1>1847     </font></a><span class="string">                &quot;Defensive programming: The variable '&quot; </span><span class="default">+ <a href="dictionary_I.html#27497">indexName</a> + </span><span class="string">&quot;' is used as an array index before it &quot;</span>
<a name="1848"><font size=-1>1848     </font></a><span class="string">                &quot;is checked that is within limits. This can mean that the array might be accessed out of bounds. &quot;</span>
<a name="1849"><font size=-1>1849     </font></a><span class="string">                &quot;Reorder conditions such as '(a[i] &amp;&amp; i &lt; 10)' to '(i &lt; 10 &amp;&amp; a[i])'. That way the array will &quot;</span>
<a name="1850"><font size=-1>1850     </font></a><span class="string">                &quot;not be accessed if the index is out of limits.&quot;</span><span class="default">);</span>
<a name="1851"><font size=-1>1851     </font></a><span class="default">}</span>
<a name="1852"><font size=-1>1852     </font></a><span class="default"></span>
<a name="1853"><font size=-1>1853     </font></a><span class="default"><a href="dictionary_C.html#500">Check</a>::<a href="dictionary_C.html#1825">FileInfo</a>* <a href="dictionary_C.html#1775">CheckBufferOverrun</a>::<a href="dictionary_C.html#1832">getFileInfo</a>(</span><span class="keyword">const <a href="dictionary_T.html#504">Tokenizer</a> </span><span class="default">*<a href="dictionary_T.html#27498">tokenizer</a>, </span><span class="keyword">const <a href="dictionary_S.html#506">Settings</a> </span><span class="default">*<a href="dictionary_S.html#27499">settings</a>) </span><span class="keyword">const</span>
<a name="1854"><font size=-1>1854     </font></a><span class="keyword"></span><span class="default">{</span>
<a name="1855"><font size=-1>1855     </font></a><span class="default">    (</span><span class="keyword">void</span><span class="default">)<a href="dictionary_S.html#27499">settings</a>;</span>
<a name="1856"><font size=-1>1856     </font></a><span class="default"></span>
<a name="1857"><font size=-1>1857     </font></a><span class="default">    <a href="dictionary_C.html#1824">MyFileInfo</a> *<a href="dictionary_F.html#27500">fileInfo</a> = </span><span class="keyword">new </span><span class="default">MyFileInfo;</span>
<a name="1858"><font size=-1>1858     </font></a><span class="default"></span>
<a name="1859"><font size=-1>1859     </font></a><span class="default">    </span><span class="comment">// Array usage..</span>
<a name="1860"><font size=-1>1860     </font></a><span class="comment">    </span><span class="keyword">const <a href="dictionary_S.html#1883">SymbolDatabase</a></span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27501">symbolDatabase</a> </span><span class="default">= <a href="dictionary_T.html#27498">tokenizer</a>-&gt;<a href="dictionary_T.html#1884">getSymbolDatabase</a>();</span>
<a name="1861"><font size=-1>1861     </font></a><span class="default">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_F.html#27502">functions</a> = <a href="dictionary_S.html#27501">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>.<a href="dictionary_S.html#1203">size</a>();</span>
<a name="1862"><font size=-1>1862     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#225">size_t</a> <a href="dictionary_I.html#27503">i</a> = </span><span class="number">0</span><span class="default">; <a href="dictionary_I.html#27503">i</a> &lt; <a href="dictionary_F.html#27502">functions</a>; ++<a href="dictionary_I.html#27503">i</a>) {</span>
<a name="1863"><font size=-1>1863     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_S.html#606">Scope</a> </span><span class="default">* </span><span class="keyword">const <a href="dictionary_S.html#27504">scope</a> </span><span class="default">= <a href="dictionary_S.html#27501">symbolDatabase</a>-&gt;<a href="dictionary_S.html#1886">functionScopes</a>[<a href="dictionary_I.html#27503">i</a>];</span>
<a name="1864"><font size=-1>1864     </font></a><span class="default">        </span><span class="keyword">for </span><span class="default">(</span><span class="keyword">const <a href="dictionary_T.html#524">Token</a> </span><span class="default">*<a href="dictionary_T.html#27505">tok</a> = <a href="dictionary_S.html#27504">scope</a>-&gt;<a href="dictionary_S.html#1889">classStart</a>; <a href="dictionary_T.html#27505">tok</a> &amp;&amp; <a href="dictionary_T.html#27505">tok</a> != <a href="dictionary_S.html#27504">scope</a>-&gt;<a href="dictionary_S.html#1890">classEnd</a>; <a href="dictionary_T.html#27505">tok</a> = <a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()) {</span>
<a name="1865"><font size=-1>1865     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27505">tok</a>, </span><span class="string">&quot;%var% [&quot;</span><span class="default">)          &amp;&amp;</span>
<a name="1866"><font size=-1>1866     </font></a><span class="default">                <a href="dictionary_T.html#524">Token</a>::<a href="dictionary_T.html#1415">Match</a>(<a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1471">linkAt</a>(</span><span class="number">1</span><span class="default">), </span><span class="string">&quot;] !![&quot;</span><span class="default">) &amp;&amp;</span>
<a name="1867"><font size=-1>1867     </font></a><span class="default">                <a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>()                       &amp;&amp;</span>
<a name="1868"><font size=-1>1868     </font></a><span class="default">                <a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>()-&gt;<a href="dictionary_T.html#12089">isExtern</a>()           &amp;&amp;</span>
<a name="1869"><font size=-1>1869     </font></a><span class="default">                <a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1907">variable</a>()-&gt;<a href="dictionary_T.html#27506">isGlobal</a>()           &amp;&amp;</span>
<a name="1870"><font size=-1>1870     </font></a><span class="default">                <a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()) {</span>
<a name="1871"><font size=-1>1871     </font></a><span class="default">                </span><span class="keyword">const </span><span class="default">ValueFlow::<a href="dictionary_V.html#1850">Value</a> *<a href="dictionary_V.html#27507">value</a> = <a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1414">next</a>()-&gt;<a href="dictionary_T.html#1427">astOperand2</a>()-&gt;<a href="dictionary_T.html#22250">getMaxValue</a>(</span><span class="keyword">false</span><span class="default">);</span>
<a name="1872"><font size=-1>1872     </font></a><span class="default">                </span><span class="keyword">if </span><span class="default">(<a href="dictionary_V.html#27507">value</a> &amp;&amp; <a href="dictionary_V.html#27507">value</a>-&gt;<a href="dictionary_V.html#5807">intvalue</a> &gt; </span><span class="number">0</span><span class="default">) {</span>
<a name="1873"><font size=-1>1873     </font></a><span class="default">                    </span><span class="keyword">const <a href="dictionary_M.html#203">MathLib</a></span><span class="default">::<a href="dictionary_M.html#286">bigint</a> <a href="dictionary_A.html#27508">arrayIndex</a> = <a href="dictionary_V.html#27507">value</a>-&gt;<a href="dictionary_V.html#5807">intvalue</a>;</span>
<a name="1874"><font size=-1>1874     </font></a><span class="default">                    <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#113">map</a>&lt;std::string, </span><span class="keyword">struct </span><span class="default">MyFileInfo::ArrayUsage&gt;::<a href="dictionary_S.html#894">iterator</a> <a href="dictionary_I.html#27509">it</a> = <a href="dictionary_F.html#27500">fileInfo</a>-&gt;<a href="dictionary_C.html#1830">arrayUsage</a>.<a href="dictionary_S.html#900">find</a>(<a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>());</span>
<a name="1875"><font size=-1>1875     </font></a><span class="default">                    </span><span class="keyword">if </span><span class="default">(<a href="dictionary_I.html#27509">it</a> != <a href="dictionary_F.html#27500">fileInfo</a>-&gt;<a href="dictionary_C.html#1830">arrayUsage</a>.<a href="dictionary_S.html#124">end</a>() &amp;&amp; <a href="dictionary_I.html#27509">it</a>-&gt;<a href="dictionary_S.html#896">second</a>.<a href="dictionary_I.html#27510">index</a> &gt;= <a href="dictionary_A.html#27508">arrayIndex</a>)</span>
<a name="1876"><font size=-1>1876     </font></a><span class="default">                        </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1877"><font size=-1>1877     </font></a><span class="default">                    </span><span class="keyword">struct <a href="dictionary_C.html#1824">MyFileInfo</a></span><span class="default">::<a href="dictionary_C.html#1826">ArrayUsage</a> <a href="dictionary_A.html#27511">arrayUsage</a>;</span>
<a name="1878"><font size=-1>1878     </font></a><span class="default">                    <a href="dictionary_A.html#27511">arrayUsage</a>.<a href="dictionary_C.html#1827">index</a> = <a href="dictionary_A.html#27508">arrayIndex</a>;</span>
<a name="1879"><font size=-1>1879     </font></a><span class="default">                    <a href="dictionary_A.html#27511">arrayUsage</a>.<a href="dictionary_C.html#1828">fileName</a> = <a href="dictionary_T.html#27498">tokenizer</a>-&gt;<a href="dictionary_T.html#3885">list</a>.<a href="dictionary_T.html#1712">file</a>(<a href="dictionary_T.html#27505">tok</a>);</span>
<a name="1880"><font size=-1>1880     </font></a><span class="default">                    <a href="dictionary_A.html#27511">arrayUsage</a>.<a href="dictionary_C.html#1829">linenr</a> = <a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#3883">linenr</a>();</span>
<a name="1881"><font size=-1>1881     </font></a><span class="default">                    <a href="dictionary_F.html#27500">fileInfo</a>-&gt;<a href="dictionary_C.html#1830">arrayUsage</a>[<a href="dictionary_T.html#27505">tok</a>-&gt;<a href="dictionary_T.html#1416">str</a>()] = <a href="dictionary_A.html#27511">arrayUsage</a>;</span>
<a name="1882"><font size=-1>1882     </font></a><span class="default">                }</span>
<a name="1883"><font size=-1>1883     </font></a><span class="default">            }</span>
<a name="1884"><font size=-1>1884     </font></a><span class="default">        }</span>
<a name="1885"><font size=-1>1885     </font></a><span class="default">    }</span>
<a name="1886"><font size=-1>1886     </font></a><span class="default"></span>
<a name="1887"><font size=-1>1887     </font></a><span class="default">    </span><span class="comment">// Arrays..</span>
<a name="1888"><font size=-1>1888     </font></a><span class="comment">    </span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;Variable&gt; &amp;<a href="dictionary_V.html#27512">varlist</a> = <a href="dictionary_S.html#27501">symbolDatabase</a>-&gt;<a href="dictionary_S.html#6694">scopeList</a>.<a href="dictionary_S.html#6086">front</a>().<a href="dictionary_V.html#8167">varlist</a>;</span>
<a name="1889"><font size=-1>1889     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;Variable&gt;::<a href="dictionary_S.html#4610">const_iterator</a> <a href="dictionary_I.html#27513">it</a> = <a href="dictionary_V.html#27512">varlist</a>.<a href="dictionary_S.html#3264">begin</a>(); <a href="dictionary_I.html#27513">it</a> != <a href="dictionary_V.html#27512">varlist</a>.<a href="dictionary_S.html#3265">end</a>(); ++<a href="dictionary_I.html#27513">it</a>) {</span>
<a name="1890"><font size=-1>1890     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_V.html#533">Variable</a> </span><span class="default">&amp;<a href="dictionary_V.html#27514">var</a> = *<a href="dictionary_I.html#27513">it</a>;</span>
<a name="1891"><font size=-1>1891     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_V.html#27514">var</a>.<a href="dictionary_V.html#4896">isStatic</a>() &amp;&amp; <a href="dictionary_V.html#27514">var</a>.<a href="dictionary_V.html#2645">isArray</a>() &amp;&amp; <a href="dictionary_V.html#27514">var</a>.<a href="dictionary_V.html#8129">dimensions</a>().<a href="dictionary_S.html#1203">size</a>() == </span><span class="number">1U </span><span class="default">&amp;&amp; <a href="dictionary_V.html#27514">var</a>.<a href="dictionary_V.html#8130">dimension</a>(</span><span class="number">0U</span><span class="default">) &gt; </span><span class="number">0U</span><span class="default">)</span>
<a name="1892"><font size=-1>1892     </font></a><span class="default">            <a href="dictionary_F.html#27500">fileInfo</a>-&gt;<a href="dictionary_C.html#1831">arraySize</a>[<a href="dictionary_V.html#27514">var</a>.<a href="dictionary_V.html#5045">name</a>()] = <a href="dictionary_V.html#27514">var</a>.<a href="dictionary_V.html#8130">dimension</a>(</span><span class="number">0U</span><span class="default">);</span>
<a name="1893"><font size=-1>1893     </font></a><span class="default">    }</span>
<a name="1894"><font size=-1>1894     </font></a><span class="default"></span>
<a name="1895"><font size=-1>1895     </font></a><span class="default">    </span><span class="keyword">return <a href="dictionary_F.html#27500">fileInfo</a></span><span class="default">;</span>
<a name="1896"><font size=-1>1896     </font></a><span class="default">}</span>
<a name="1897"><font size=-1>1897     </font></a><span class="default"></span>
<a name="1898"><font size=-1>1898     </font></a><span class="default"></span><span class="keyword">void <a href="dictionary_C.html#1775">CheckBufferOverrun</a></span><span class="default">::<a href="dictionary_C.html#1834">analyseWholeProgram</a>(</span><span class="keyword">const <a href="dictionary_S.html#43">std</a></span><span class="default">::<a href="dictionary_S.html#1344">list</a>&lt;Check::FileInfo*&gt; &amp;<a href="dictionary_F.html#27515">fileInfo</a>, </span><span class="keyword">const <a href="dictionary_S.html#506">Settings</a></span><span class="default">&amp;, <a href="dictionary_E.html#31">ErrorLogger</a> &amp;<a href="dictionary_E.html#27517">errorLogger</a>)</span>
<a name="1899"><font size=-1>1899     </font></a><span class="default">{</span>
<a name="1900"><font size=-1>1900     </font></a><span class="default">    </span><span class="comment">// Merge all fileInfo</span>
<a name="1901"><font size=-1>1901     </font></a><span class="comment">    <a href="dictionary_C.html#1824">MyFileInfo</a> <a href="dictionary_A.html#27518">all</a></span><span class="default">;</span>
<a name="1902"><font size=-1>1902     </font></a><span class="default">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;Check::FileInfo*&gt;::<a href="dictionary_S.html#4610">const_iterator</a> <a href="dictionary_I.html#27519">it</a> = <a href="dictionary_F.html#27515">fileInfo</a>.<a href="dictionary_S.html#3264">begin</a>(); <a href="dictionary_I.html#27519">it</a> != <a href="dictionary_F.html#27515">fileInfo</a>.<a href="dictionary_S.html#3265">end</a>(); ++<a href="dictionary_I.html#27519">it</a>) {</span>
<a name="1903"><font size=-1>1903     </font></a><span class="default">        </span><span class="keyword">const <a href="dictionary_C.html#1824">MyFileInfo</a> </span><span class="default">*<a href="dictionary_F.html#27520">fi</a> = </span><span class="keyword">dynamic_cast</span><span class="default">&lt;<a href="dictionary_C.html#1824">MyFileInfo</a>*&gt;(*<a href="dictionary_I.html#27519">it</a>);</span>
<a name="1904"><font size=-1>1904     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(!<a href="dictionary_F.html#27520">fi</a>)</span>
<a name="1905"><font size=-1>1905     </font></a><span class="default">            </span><span class="keyword">continue</span><span class="default">;</span>
<a name="1906"><font size=-1>1906     </font></a><span class="default"></span>
<a name="1907"><font size=-1>1907     </font></a><span class="default">        </span><span class="comment">// merge array usage</span>
<a name="1908"><font size=-1>1908     </font></a><span class="comment">        </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#113">map</a>&lt;std::string, </span><span class="keyword">struct </span><span class="default">MyFileInfo::ArrayUsage&gt;::<a href="dictionary_S.html#1190">const_iterator</a> <a href="dictionary_I.html#27521">it2</a> = <a href="dictionary_F.html#27520">fi</a>-&gt;<a href="dictionary_C.html#1830">arrayUsage</a>.<a href="dictionary_S.html#121">begin</a>(); <a href="dictionary_I.html#27521">it2</a> != <a href="dictionary_F.html#27520">fi</a>-&gt;<a href="dictionary_C.html#1830">arrayUsage</a>.<a href="dictionary_S.html#124">end</a>(); ++<a href="dictionary_I.html#27521">it2</a>) {</span>
<a name="1909"><font size=-1>1909     </font></a><span class="default">            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#113">map</a>&lt;std::string, </span><span class="keyword">struct </span><span class="default">MyFileInfo::ArrayUsage&gt;::<a href="dictionary_S.html#1190">const_iterator</a> <a href="dictionary_A.html#27522">allit</a> = <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1830">arrayUsage</a>.<a href="dictionary_S.html#900">find</a>(<a href="dictionary_I.html#27521">it2</a>-&gt;<a href="dictionary_F.html#125">first</a>);</span>
<a name="1910"><font size=-1>1910     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27522">allit</a> == <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1830">arrayUsage</a>.<a href="dictionary_S.html#124">end</a>() || <a href="dictionary_I.html#27521">it2</a>-&gt;<a href="dictionary_S.html#896">second</a>.<a href="dictionary_I.html#27510">index</a> &gt; <a href="dictionary_A.html#27522">allit</a>-&gt;<a href="dictionary_S.html#896">second</a>.<a href="dictionary_I.html#27510">index</a>)</span>
<a name="1911"><font size=-1>1911     </font></a><span class="default">                <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1830">arrayUsage</a>[<a href="dictionary_I.html#27521">it2</a>-&gt;<a href="dictionary_F.html#125">first</a>] = <a href="dictionary_I.html#27521">it2</a>-&gt;<a href="dictionary_S.html#896">second</a>;</span>
<a name="1912"><font size=-1>1912     </font></a><span class="default">        }</span>
<a name="1913"><font size=-1>1913     </font></a><span class="default"></span>
<a name="1914"><font size=-1>1914     </font></a><span class="default">        </span><span class="comment">// merge array info</span>
<a name="1915"><font size=-1>1915     </font></a><span class="comment">        </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#113">map</a>&lt;std::string, MathLib::bigint&gt;::<a href="dictionary_S.html#1190">const_iterator</a> <a href="dictionary_I.html#27523">it2</a> = <a href="dictionary_F.html#27520">fi</a>-&gt;<a href="dictionary_C.html#1831">arraySize</a>.<a href="dictionary_S.html#121">begin</a>(); <a href="dictionary_I.html#27523">it2</a> != <a href="dictionary_F.html#27520">fi</a>-&gt;<a href="dictionary_C.html#1831">arraySize</a>.<a href="dictionary_S.html#124">end</a>(); ++<a href="dictionary_I.html#27523">it2</a>) {</span>
<a name="1916"><font size=-1>1916     </font></a><span class="default">            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#113">map</a>&lt;std::string, MathLib::bigint&gt;::<a href="dictionary_S.html#1190">const_iterator</a> <a href="dictionary_A.html#27524">allit</a> = <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1831">arraySize</a>.<a href="dictionary_S.html#900">find</a>(<a href="dictionary_I.html#27523">it2</a>-&gt;<a href="dictionary_F.html#125">first</a>);</span>
<a name="1917"><font size=-1>1917     </font></a><span class="default">            </span><span class="keyword">if </span><span class="default">(<a href="dictionary_A.html#27524">allit</a> == <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1831">arraySize</a>.<a href="dictionary_S.html#124">end</a>())</span>
<a name="1918"><font size=-1>1918     </font></a><span class="default">                <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1831">arraySize</a>[<a href="dictionary_I.html#27523">it2</a>-&gt;<a href="dictionary_F.html#125">first</a>] = <a href="dictionary_I.html#27523">it2</a>-&gt;<a href="dictionary_S.html#896">second</a>;</span>
<a name="1919"><font size=-1>1919     </font></a><span class="default">            </span><span class="keyword">else</span>
<a name="1920"><font size=-1>1920     </font></a><span class="keyword">                <a href="dictionary_A.html#27518">all</a></span><span class="default">.<a href="dictionary_C.html#1831">arraySize</a>[<a href="dictionary_I.html#27523">it2</a>-&gt;<a href="dictionary_F.html#125">first</a>] = -</span><span class="number">1</span><span class="default">;</span>
<a name="1921"><font size=-1>1921     </font></a><span class="default">        }</span>
<a name="1922"><font size=-1>1922     </font></a><span class="default">    }</span>
<a name="1923"><font size=-1>1923     </font></a><span class="default"></span>
<a name="1924"><font size=-1>1924     </font></a><span class="default">    </span><span class="comment">// Check buffer usage</span>
<a name="1925"><font size=-1>1925     </font></a><span class="comment">    </span><span class="keyword">for </span><span class="default">(<a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#113">map</a>&lt;std::string, </span><span class="keyword">struct </span><span class="default">MyFileInfo::ArrayUsage&gt;::<a href="dictionary_S.html#1190">const_iterator</a> <a href="dictionary_I.html#27525">it</a> = <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1830">arrayUsage</a>.<a href="dictionary_S.html#121">begin</a>(); <a href="dictionary_I.html#27525">it</a> != <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1830">arrayUsage</a>.<a href="dictionary_S.html#124">end</a>(); ++<a href="dictionary_I.html#27525">it</a>) {</span>
<a name="1926"><font size=-1>1926     </font></a><span class="default">        <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#113">map</a>&lt;std::string, MathLib::bigint&gt;::<a href="dictionary_S.html#1190">const_iterator</a> <a href="dictionary_S.html#27526">sz</a> = <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1831">arraySize</a>.<a href="dictionary_S.html#900">find</a>(<a href="dictionary_I.html#27525">it</a>-&gt;<a href="dictionary_F.html#125">first</a>);</span>
<a name="1927"><font size=-1>1927     </font></a><span class="default">        </span><span class="keyword">if </span><span class="default">(<a href="dictionary_S.html#27526">sz</a> != <a href="dictionary_A.html#27518">all</a>.<a href="dictionary_C.html#1831">arraySize</a>.<a href="dictionary_S.html#124">end</a>() &amp;&amp; <a href="dictionary_S.html#27526">sz</a>-&gt;<a href="dictionary_S.html#896">second</a> &gt; </span><span class="number">0 </span><span class="default">&amp;&amp; <a href="dictionary_S.html#27526">sz</a>-&gt;<a href="dictionary_S.html#896">second</a> &lt; <a href="dictionary_I.html#27525">it</a>-&gt;<a href="dictionary_S.html#896">second</a>.<a href="dictionary_I.html#27510">index</a>) {</span>
<a name="1928"><font size=-1>1928     </font></a><span class="default">            <a href="dictionary_E.html#31">ErrorLogger</a>::<a href="dictionary_E.html#47">ErrorMessage</a>::<a href="dictionary_E.html#2995">FileLocation</a> <a href="dictionary_F.html#27527">fileLoc</a>;</span>
<a name="1929"><font size=-1>1929     </font></a><span class="default">            <a href="dictionary_F.html#27527">fileLoc</a>.<a href="dictionary_E.html#3010">setfile</a>(<a href="dictionary_I.html#27525">it</a>-&gt;<a href="dictionary_S.html#896">second</a>.<a href="dictionary_F.html#27528">fileName</a>);</span>
<a name="1930"><font size=-1>1930     </font></a><span class="default">            <a href="dictionary_F.html#27527">fileLoc</a>.<a href="dictionary_E.html#3008">line</a> = <a href="dictionary_I.html#27525">it</a>-&gt;<a href="dictionary_S.html#896">second</a>.<a href="dictionary_L.html#27529">linenr</a>;</span>
<a name="1931"><font size=-1>1931     </font></a><span class="default"></span>
<a name="1932"><font size=-1>1932     </font></a><span class="default">            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#1344">list</a>&lt;ErrorLogger::ErrorMessage::FileLocation&gt; <a href="dictionary_L.html#27530">locationList</a>;</span>
<a name="1933"><font size=-1>1933     </font></a><span class="default">            <a href="dictionary_L.html#27530">locationList</a>.<a href="dictionary_S.html#1362">push_back</a>(<a href="dictionary_F.html#27527">fileLoc</a>);</span>
<a name="1934"><font size=-1>1934     </font></a><span class="default"></span>
<a name="1935"><font size=-1>1935     </font></a><span class="default">            <a href="dictionary_S.html#43">std</a>::<a href="dictionary_S.html#142">ostringstream</a> <a href="dictionary_O.html#230">ostr</a>;</span>
<a name="1936"><font size=-1>1936     </font></a><span class="default">            <a href="dictionary_O.html#230">ostr</a> &lt;&lt; </span><span class="string">&quot;Array &quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27525">it</a>-&gt;<a href="dictionary_F.html#125">first</a> &lt;&lt; </span><span class="string">'[' </span><span class="default">&lt;&lt; <a href="dictionary_S.html#27526">sz</a>-&gt;<a href="dictionary_S.html#896">second</a> &lt;&lt; </span><span class="string">&quot;] accessed at index &quot; </span><span class="default">&lt;&lt; <a href="dictionary_I.html#27525">it</a>-&gt;<a href="dictionary_S.html#896">second</a>.<a href="dictionary_I.html#27510">index</a> &lt;&lt; </span><span class="string">&quot; which is out of bounds&quot;</span><span class="default">;</span>
<a name="1937"><font size=-1>1937     </font></a><span class="default"></span>
<a name="1938"><font size=-1>1938     </font></a><span class="default">            </span><span class="keyword">const <a href="dictionary_E.html#31">ErrorLogger</a></span><span class="default">::<a href="dictionary_E.html#47">ErrorMessage</a> <a href="dictionary_E.html#27531">errmsg</a>(<a href="dictionary_L.html#27530">locationList</a>,</span>
<a name="1939"><font size=-1>1939     </font></a><span class="default">                                                   <a href="dictionary_S.html#1381">Severity</a>::error,</span>
<a name="1940"><font size=-1>1940     </font></a><span class="default">                                                   <a href="dictionary_O.html#230">ostr</a>.<a href="dictionary_S.html#148">str</a>(),</span>
<a name="1941"><font size=-1>1941     </font></a><span class="default">                                                   </span><span class="string">&quot;arrayIndexOutOfBounds&quot;</span><span class="default">,</span>
<a name="1942"><font size=-1>1942     </font></a><span class="default">                                                   </span><span class="keyword">false</span><span class="default">);</span>
<a name="1943"><font size=-1>1943     </font></a><span class="default">            <a href="dictionary_E.html#27517">errorLogger</a>.<a href="dictionary_E.html#46">reportErr</a>(<a href="dictionary_E.html#27531">errmsg</a>);</span>
<a name="1944"><font size=-1>1944     </font></a><span class="default">        }</span>
<a name="1945"><font size=-1>1945     </font></a><span class="default">    }</span>
<a name="1946"><font size=-1>1946     </font></a><span class="default">}</span>
<a name="1947"><font size=-1>1947     </font></a><span class="default"></span>
</pre></body></html>
