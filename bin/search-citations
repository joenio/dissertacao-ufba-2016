#!/usr/bin/perl
use Modern::Perl '2014';
use experimental 'signatures';
use Mojo::UserAgent;
use Mojo::URL;
use utf8;

# https://developer.ieee.org/

my $APIKEY = 'yx99dre536znna6qdhafdqns';
my $ua = Mojo::UserAgent->new;

sub search_articles_by_content($query) {
  my $url = Mojo::URL->new("http://ieeexploreapi.ieee.org/api/v1/search/articles");
  $url->query({querytext => $query, format => 'json', apikey => $APIKEY});
  return $url;
}

sub search_articles_by_doi($doi) {
  my $url = Mojo::URL->new("http://ieeexploreapi.ieee.org/api/v1/articles/doi/$doi");
  $url->query({format => 'json', apikey => $APIKEY});
  return $url;
}

my $url = search_articles_by_doi("10.1109/ASE.2004.1342733");
say $ua->get($url)->res->to_string;

exit;

for my $hit (@{$ua->get($url)->res->json->{hits}{hits}}) {
  say "$hit->{_source}{name} ($hit->{_source}{author})";
}
