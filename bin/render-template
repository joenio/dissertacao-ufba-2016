#!/usr/bin/perl
use utf8;
use open ':locale';
use Modern::Perl '2014';
use YAML qw( LoadFile );
use Mojo::Template;

if (@ARGV < 2) {
  warn "E: missing options!";
  say "Usage: $0 <dataset-summary-filename> <template-filename>";
  exit 1;
}
our $INPUT_FILENAME = shift @ARGV;
our $TEMPLATE_FILENAME = shift @ARGV;

die "input file not found: $INPUT_FILENAME, please run bin/summarize-softwares-data first." unless -e $INPUT_FILENAME;
die "template file not found: $TEMPLATE_FILENAME." unless -e $TEMPLATE_FILENAME;

my %yaml = LoadFile("$ENV{PWD}/$INPUT_FILENAME");
my $t = Mojo::Template->new(auto_escape => 1);
print $t->render_file("$ENV{PWD}/$TEMPLATE_FILENAME", %yaml);
